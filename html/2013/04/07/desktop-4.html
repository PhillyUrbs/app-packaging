<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <script type="text/javascript">var NREUMQ=NREUMQ||[];NREUMQ.push(["mark","firstbyte",new Date().getTime()]);</script>
<title>PalmSource - Desktop - 4 | ITNinja</title>
        <meta name="description" content="Deployment tips and related materials related to PalmSource Desktop 4">
        <meta name="keywords" content="PalmSource Desktop,PalmSource">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="yMY423DZduMGIsTKJnJbRzr_qC4FUxtEhXxtuGftSGw" />
        <link rel="shortcut icon" href="/bundles/itninjaweb/img/favicon.ico">
        <link rel="apple-touch-icon" href="/bundles/itninjaweb/img/apple-touch-icon.png">

        <link rel="stylesheet" type="text/css" media="screen" href="/css/4f9a382.css" />
        
        <link href="/css/df4eb8b.css" rel="stylesheet" type="text/css" />
        
            <link rel="stylesheet" type="text/css" media="screen" href="/css/8975654.css" />
        <!--[if lt IE 9]>
            <script src="/js/ede9468.js"></script>        <![endif]-->

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
        <script type="text/javascript">
            window.jQuery || document.write("<script src='/bundles/itninjaweb/js/jquery-1.6.1.min.js'>\x3C/script>");
            var TAG_SERVER = 'tags.itninja.com';
        </script>

        <!--[if IE]>
            <script src="/js/001a46f.js"></script>            <script>
                $(document).ready(function(){
                    $('input').placeholder();
                })
            </script>
        <![endif]-->

                    </head>
    <body>
                <header>
            <p id="kace-link">&nbsp;</p>
            <ul id="user-info">
    <li class="last"><a href="/register" class="register">register</a><a href="/login" class="button">Log in</a></li>
</ul>            <span id="logo"><a href="/"><img src="/bundles/itninjaweb/img/ITN_logo_no_AD.png" alt="ITNinja Home" width="221" height="53" /></a></span>
            <nav>
                                    <form method="get" action="/search#search-filter-by-keyword" id="nav-search"><input type="text" name="q" class="q" placeholder="search"/><input type="image" name="i" class="i" src="/bundles/itninjaweb/img/search_icon.png" alt="go" title="go" /><input type="hidden" name="cx" value="014503921158165719423:3hy89iql-j8" /><input type="hidden" name="t" value="search-filter-by-keyword" /></form>
                                    <ul>
                <li class="first">        <a href="/question">Ask</a>            <ul class="menu_level_1">
                <li class="first last">        <a href="/question/new">Ask A Question</a>        
    </li>


    </ul>

    </li>

        <li>        <a href="/research">Research</a>            <ul class="menu_level_1">
                <li class="first">        <a href="/software/browse?Popular=1">Software</a>        
    </li>

        <li>        <a href="/tips">Deployment Tips</a>        
    </li>

        <li>        <a href="/question">Q &amp; A</a>        
    </li>

        <li>        <a href="/blog">Blogs</a>        
    </li>

        <li class="last">        <a href="/link">Links</a>        
    </li>


    </ul>

    </li>

        <li>        <a href="/share">Share</a>            <ul class="menu_level_1">
                <li class="first">        <a href="/question/unanswered">Answer a Question</a>        
    </li>

        <li>        <a href="/blog/post/new">Write a Blog Post</a>        
    </li>

        <li>        <a href="/tips">Share a Deployment Tip</a>        
    </li>

        <li class="last">        <a href="/link/new">Share a Link</a>        
    </li>


    </ul>

    </li>

        <li>        <a href="/topics">Topics</a>        
    </li>

        <li class="last">        <a href="/about">About</a>            <ul class="menu_level_1">
                <li class="first">        <a href="/tour">Site Tour</a>        
    </li>

        <li>        <a href="/faq">FAQ</a>        
    </li>

        <li>        <a href="/faq#PointsFAQ">ITNinja Points</a>        
    </li>

        <li class="last">        <a href="/faq#ADFAQ">AppDeploy</a>        
    </li>


    </ul>

    </li>


    </ul>

            </nav>
            <div id="secondary-nav"></div>
        </header>
        <div id="global-content">
            <ul id="breadcrumbs">
                <li class="home"><a href="/">
                    <img src="/bundles/itninjaweb/img/Breadcrumb_cap.png"/></a></li>
                    <li><a href="/research">Research</a></li>
    <li><a href="/software/browse?Popular=1">Software</a></li>
    <li><a href="/software/palmsource/browse">PalmSource</a></li>
    <li>Desktop</li>
            </ul>
            <div id="stage">
    <div class="tag-header">
        <div class="title-wrap">
            <h1>PalmSource Desktop</h1>

            <div id="version-wrapper">

                <span class="version-name" id="version-changer">
                    Version: 4
                    <div id="version-list">
                        <div class="version-list-top"></div>
                        <ul id="version-list-items">
                                                            <li>
                                    <a href="/software/palmsource/desktop-4/4-367">
                                        4.x <span>(15 tips)</span>
                                    </a>
                                </li>
                                                    </ul>
                        <div class="version-list-bottom"></div>
                    </div>
                </span>

            </div>


        </div>
    </div>


    <div class="tr-meta">
        
Average Rating: <span id="average-rating">0</span>
<div class="stars-wrap">
        <div class="rating">
    <input name="Software4814" type="radio" class="star" disabled="disabled"  />
    <input name="Software4814" type="radio" class="star" disabled="disabled"  />
    <input name="Software4814" type="radio" class="star" disabled="disabled"  />
    <input name="Software4814" type="radio" class="star" disabled="disabled"  />
    <input name="Software4814" type="radio" class="star" disabled="disabled"  />
</div>    </div>

<br class="clear"/>

Views: 19 &nbsp|&nbsp
Created: 01/31/2007 &nbsp|&nbsp
Followers:1




<div class="follow-widget-right">
            <a class="btn-follow" rel="nofollow" href="https://www.itninja.com/login?/follow/version/6019?tb=L3NvZnR3YXJlL3BhbG1zb3VyY2UvZGVza3RvcC00LzQtMzY3">
            <span class="follow-title">Follow this Version </span>
            <span class="followers" title="followers"><div></div>1</span>
        </a>
    </div>    </div>

    <div class="additional-meta">
        Desktop has <a href="#inventory-records" id="scrollInv">2 inventory records</a>,
        <a href="#q-a" id="scrollQA">0 Questions</a>,
        <a href="#blogs" id="scrollBlog">0 Blogs</a>
        and <a href="#links" id="scrollLinks">0 links</a>. Please help add to this by sharing more!

    </div>


    <div class="software-section" id="deployment-tips">

        <h2 class="section-title"><a href="#" class="plus toggle minus"></a> Deployment Tips (15)</h2>
        
        <div class="inner-content" id="deploy-div">

            <div id="deployment-ratings-summary" class="inner">
            </div>

            <!-- end rating secion -->

            <div class="inner summary">

                                                        <h3>Deployment Tip Summary</h3>
                    <p><a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367" class="btn">Add a Summary</a></p>
                
                <div id="software-view-deployment-summary-form" class="hidden">
                    <h3>Deployment Tip Summary</h3>
                    <form action="/version/summary/new/6019" method="POST" novalidate>
    <div id="form"><input type="hidden" id="form__token" name="form[_token]" value="57d9c46abf59daa2491a66cb67ed0a77c88141df" /><div><label for="form_text" class=" required">Enter your tip</label><textarea id="form_text" name="form[text]" required="required"></textarea></div></div>

    <input type="hidden" name="redirectUrl" value="http://www.itninja.com/software/palmsource/desktop-4/4-367" />
    <input type="submit" value="Submit" id="submit1" class="btn"/>
    <span id="software-view-deployment-summary-cancel" class="btn" >Cancel</span>
</form>                </div>

                <div id="software-view-deployment-summary-text" class="hidden">

                    <h3>Deployment Tip Summary</h3>
                    <div id="software-view-deployment-summary-text-raw"></div>
                                                        </div>

            </div>
            <!--end summary -->

            <div class="inner">

                <div class="version-subsections">
                    
                    <div id="tabs">
                        <ul class="tabs clearfix">
                            <li><a href="#software-tag-view-tab-notes">Notes (12)</a></li>
                            <li><a href="#software-tag-view-tab-command-line">Command Line (2)</a></li>
                            <li><a href="#software-tag-view-tab-script">Script (0)</a></li>
                            <li><a href="#software-tag-view-tab-securityinfo">Security (1)</a></li>
                            <li><a href="#software-tag-view-tab-terminal">Terminal Services (0)</a></li>
                            <li><a href="#software-tag-view-tab-virtualization">Virtualization (0)</a></li>
                        </ul>
                        <div class="tabs-loading">
                            Please wait.
                        </div>
                        <div id="software-tag-view-tab-notes" class="tabs-hide">
                            <div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-591"></div>
    <div class="avg-rating">121</div>
     <div class="arrow_down" id="tip-591"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>Palm's MSI installer is horrible; you need to make the destination user a temporary local admin for the install and then no one else on a multi-user box can use the program.<br><br><br />However, if you're repackaging it for MSI, you can fix all this. Here's how:<br><br><br />* Have your repackaging tool create advertising info for you when you SetupCapture or convert the MSI. (If you convert the MSI, don't forget to install the ISSCRIPT.MSI first as a prerequisite!)<br><br><br />* Make a component called "CurrentUser" and put &lt;u&gt;all&lt;/u&gt; of the HKEY_CURRENT_USER Registry entries from all the other components into it. Make a hidden Feature to hold the new component, and put all other features under it (i.e. it's the top-level required feature). This will force the system to check the HKCU keypaths from any advertised entry point... Meaning that when a new user runs HotSync or Desktop for the first time, the Windoze Installer Service will self-heal his/her HKCU values.<br><br><br />* Set the permissions on the C:\Program Files\Palm (or whatever) directory so that all BUILTIN\Users can create new subdirectories and files.<br><br><br />Thus you can make a great MSI package that's smart and multi-user friendly.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/ewall" class="username" rel="nofollow">ewall</a>
            03/21/2003 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-593"></div>
    <div class="avg-rating">118</div>
     <div class="arrow_down" id="tip-593"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>silent install did not work on a fresh install.&nbsp; The applicaiton suceeds, but the palm&nbsp; .inf for the driver is not added.<br></p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/cocokola" class="username" rel="nofollow">cocokola</a>
            01/26/2004 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-594"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-594"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>There is also a "hardcore"-way of doing it:<br><br><br />1) Create a diff of the Palm-installation only (without the isscript.msi)<br><br />2) delete all the registry keys but some HKCU-keys containing the settings (for an exact list of keys or the complete Empirum-package just send me an email)<br><br><br />Now the package works fine with normal user-rights and without any prompts for MSI-selfhealing. But just for the first user installating the packages - others still get the "Error: invalid configuration" - message. Which was OK in this case.<br><br></p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/Hendrik" class="username" rel="nofollow">Hendrik</a>
            02/06/2004 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-595"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-595"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>The Palm Desktop package really is difficult to deal with. Some errors:<br><br><br />* Lack of key files is most components<br><br />* Mixed per user and per machine data in many components. Some even have data in HKCR, HKCU AND HKLM<br><br />* Application does not work without HKCU populated<br><br />* Drivers not signed (fixed in most recent release)<br><br />* MFC and system dll's installed using a component, NOT merge module<br><br />* Installscript engine not included in setup, so setup.exe will try to connect to the internet during installation to download the file!<br><br />* Recent version won't run with non admin priviledges<br><br />* The list goes on<br><br><br />Here is how I fixed it to run well on multi user systems:<br><br><br />* Dig up a version that includes the Installscript engine<br><br />* Move all pre user registry entries to a single component<br><br />* Set full write access to the palm folder under %programfiles%<br><br />* If you are installing an older version of the product, copy the newest, signed, drivers to the release image, and add the files to the USB driver components<br><br />* Deploy the setup to the system using the MSI file, and make sure a cached version of the database is accessible to repair HLCU entries on login<br><br />* Move all features undera&nbsp; common top level feature, add a HKCU feature with the per user data<br><br />* Add a HKCU flag component with a HKCU registry keypath to the top level feature.<br><br />* Make all shortcuts advertised<br><br />* Set ALLUSERS to 1 to force a per machine install<br></p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/Glytzhkof" class="username" rel="nofollow">Glytzhkof</a>
            08/02/2004 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-596"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-596"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>I packaged version 4.1.4 and came accross a number of issues when trying to get the application to work in a per machine installation basis.<br><br><br />I extracted the vendor MSI file from the setup.exe and applied a transform to the MSI file to resolve these issues<br><br><br />As the application does not contain any advertised shortcut in order to install the applications user specific data to more than one users profile then a self repair will have to be called. I suggest using a stubpath active setup registry key with the command line option /fup to call the repair.&nbsp; <br><br><br />The application does not install correctly when executing a silent installation. The reason for this is that the INSTALLDIR directory is not specifed correctly in the directory table. The packager who palm paid to put this MSI together is clearly not the sharpest tool in the box so in order to successfully install the application silently some customisation will have to be done. There is a "." in the default directory column where the value "palmOne" should be. This does not matter during a full UI installation as the Installdir is resolved againest the user input.<br><br><br />Edit the directory table and replace the "." with "palmOne". If you are planning on deploying the application in a per machine (ALLUSERS=1), then I suggest you replace any occurance of the formated text value "[INSTALLDIR]" in the registry table with the hard coded path value "C:\Program Files\palmOne\". The reason for this is that during a repair of the application (like I mensioned above)the INSTALLDIR value in the registry table is resolved againest the base MSI's installdir value and not the transforms value.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/lialync" class="username" rel="nofollow">lialync</a>
            01/05/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-597"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-597"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>Many people have problems with the vendor package and the best solution is still to repackage the installation. Customization of the vendor package does not work on every system and limits the possibilities.<br><br><br />I repackaged the application using Wise Package Studio 5.<br><br><br />If you open the vendor package of Palm Desktop, you should check the RegistryTable.<br><br />You see lots of regkeys under HKCU, which would probably fit better in HKCR (&Acirc;&#147;Classes&Acirc;&#148;, &Acirc;&#147;TypeLib&Acirc;&#148; and Shell Extensions).<br><br><br />As long as those keys are under HKCU a per-machine installations of the package will be very complicated and will not work on every system.<br><br><br />Capture the installation (installed &Acirc;&#147;ISScript.msi&Acirc;&#148; before the capturing) and open the .WSI &Acirc;&#150; file in the Wise Installer Editor.<br><br><br />Mark the HKCU &Acirc;&#150; root of the Snapshot on the &Acirc;&#147;Registry &Acirc;&#150; Page&Acirc;&#148; and export it to a .REG &Acirc;&#150; File.<br><br><br />Open the .REG &Acirc;&#150; File with &Acirc;&#147;Notepad&Acirc;&#148;. Replace the string &Acirc;&#147;HKEY_CURRENT_USER\Software\Classes\&Acirc;&#148; with &Acirc;&#147;HKEY_CLASSES_ROOT\&Acirc;&#148;, so all Classes are where they belong.<br><br><br />Replace the string &Acirc;&#147;HKEY_CURRENT_USER\Software\&Acirc;&#148; -&gt; vendor with &Acirc;&#147;HKEY_LOCAL_MACHINE\Software\&Acirc;&#148;, so that the application config is available to &Acirc;&#147;All Users&Acirc;&#148;.<br><br><br />After you&Acirc;&#146;ve done that, delete the &Acirc;&#147;HKEY_CURRENT_USER\Software\Classes\&Acirc;&#148; &Acirc;&#150; Folder in the captured installation and import the customized .REG &Acirc;&#150; File.<br><br><br />Wise should tell you that it found advertising information in the .REG &Acirc;&#150; File. You can decide whether Wise shall write this information in the corresponding Tables (Class, AppID &Acirc;&#133;).<br><br><br />You see on the &Acirc;&#147;File Associations&Acirc;&#148; &Acirc;&#150; Page that all Shell Extensions were recognized.<br><br><br />In order to make this package multi-user capable you have to give &Acirc;&#147;Everyone&Acirc;&#148; full access on the program folder, because the users / profiles are put in there.<br><br><br />You don&Acirc;&#146;t even have to care about the Shortcuts, because they are already &Acirc;&#147;Advertised&Acirc;&#148; and the &Acirc;&#147;HotSync Manager&Acirc;&#148; in the StartupFolder automatically initialises the installation of the user data as soon as another user logs in.<br><br><br />Because the Users / Profiles are put into the program folder every user can see and select all profiles created on that machine.<br><br><br />Apart from that the package did everything I wanted. Using this way it is possible to capture special configurations for this software (for example: standard vCal &Acirc;&#150; App check, integration of users / profiles, HotSync Manager Settings).<br></p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/C.Landskron" class="username" rel="nofollow">C.Landskron</a>
            03/11/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-599"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-599"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>As noted by eWall above, this is one of those exceptions to the "never repackage an .msi into another .msi" rule (see <a href="http://www.appdeploy.com/tips/detail.asp?id=60">http://www.appdeploy.com/tips/detail.asp?id=60</a>).&nbsp; The Palm Desktop does not appear to have any hard coded internal references, which is often one of the things that makes re-capturing an .msi nearly impossible.<br><br><br />If you have a fair amount of repackaging experience, you can "re-repackage" this into a new .msi that you can deploy via AD, and provide "per machine" functionality; this is not possible with the native .msi provided by Palm.<br><br><br />Observe the notes entered by eWall above, as well as the following:<br><br><br />1.&nbsp; Delete any registry keys containing the GUID that matches the GUID of the native .msi from Palm<br><br><br />2.&nbsp; Delete registry keys that reference the original feature structure.<br><br><br />3.&nbsp; Test the resulting new .msi thoroughly, and much more than you normally would.<br><br><br />Last, you may find you need to create a "token" file named "expreprt.exe" at C:\Program Files\Palm.&nbsp; Without it, some versions of Palm Desktop 4.x will error out looking for this this file when the following conditions are true:<br><br><br />1.&nbsp; an account other than the one that installed Palm Desktop executes the program<br><br><br />2.&nbsp; that same account does not have admin rights<br><br><br />The error is:&nbsp; "invalid configuration. terminating the palm desktop"&nbsp; Adding the value to your installation suppresses the error, and does not affect functionality.<br><br><br />The error has something to do with values entered at HKCU\Software\U.S. Robotics during the install during the original install, which self healing has difficulty addressing.<br><br><br><br />Craig --&lt;&gt;.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/craig16229" class="username" rel="nofollow">craig16229</a>
            05/23/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-600"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-600"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>I somehow managed to do an unattended install without repackaging. The problem I ran into was that merely running an installation package under administrative rights while logged in didn't work (Palm installer seems do a kind of switch user action???). <br><br><br />To make the trick work I used SMS2003 to deploy a package under "administrative" rights (as SYSTEM) which in turn kicks off another package and logs the user off. This logoff is checked by a little routine that loops as long as it fails to load the ntuser.dat of the user. Once the ntuser.dat loads succesfully (Which means the user is logged off), it is unloaded again and installation of the Palm Desktop is started. <br><br><br />The user logs on again and all that needs to be done is import a bunch of registry keys into HKEY_CURRENT_USER et voila, Palm Desktop is installed.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/de_bas" class="username" rel="nofollow">de_bas</a>
            06/03/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-601"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-601"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>I ran the setup.exe to extract the ISScript engine and Palm Desktop.msi. I then installed the application on a test machine and exported the registry keys from \HKCU\Software\U.S. Robotics. I then created a transform, set ALLUSERS=1, corrected the INSTALLDIR error, imported the Registry key for HKCU, gave USERS full rights to the INSTALLDIR and changed the HOTSYNC.EXE shortcut to appear in Startup for all users. Set the app up to repair once for each user to repopulate the HKCU hive and it seems to work for any member of USERS on the box. </p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/xythex" class="username" rel="nofollow">xythex</a>
            07/08/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-602"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-602"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>I managed to repackage and also Merge it with the DIFX (<a href="http://www.microsoft.com/whdc/driver/install/DIFxtls.mspx">http://www.microsoft.com/whdc/driver/install/DIFxtls.mspx</a>) Merge Module. Recaptured with WISE as previously mentioned moving all the HKCU\Software\Classes keys over to HKCR and also removed all the InstalShield components. <br><br><br />I then created a new MSI for the drivers using the DIFx MSM and installed it within the main package as a nested install. Only tricky thing I had to do to get DIFX to install the drivers was to include USBPORT.DLL and PALMDEVC.DLL under SYS32. Using DIFX installs the drivers without the device connected so that the user can simply use the device right after reboot. I did attempt to put it all in the one package but for some strange reason, the drivers failed on install. <br><br><br />Non-Admin users need to write to files under %ProgramFiles%\PalmOne so I performed a SETACL on the INSTALLDIR.<br><br><br />Just a couple more tweaks you might want to include to make it more "friendlier" to the user.<br><br><br />The following registry key redirects HotSync to write the user's data to their personal folder:-<br><br><br />[HKEY_CURRENT_USER\Software\U.S. Robotics\Pilot Desktop\Core]<br><br />"Path"="My Documents\PalmOne"<br><br><br><br />This key disabled file association checking:- <br><br><br />[HKEY_CURRENT_USER\Software\U.S. Robotics\Pilot Desktop\Preferences]<br><br />"CheckFileTypes"=dword:00000000<br><br><br />Very enjoyable package (Once you got it working).. Good Luck!<br><br><br />- Tu</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/tupham" class="username" rel="nofollow">tupham</a>
            12/06/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-603"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-603"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>SVS will solve the entire packing problem.&nbsp; No more self healing.&nbsp; Just remember after the application has been package it is now a layer MSI's are no longer needed.&nbsp; Strip the layer of all MSI and installshield residue, this will stop all self healing.&nbsp; We are running palm in a power user evironment.&nbsp; If you want more information please contact me.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/fishslayer" class="username" rel="nofollow">fishslayer</a>
            12/22/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-5765"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-5765"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>Many people have problems with the vendor package and the best solution is still to repackage the installation. Customization of the vendor package does not work on every system and limits the possibilities.<br><br><br />I repackaged the application using Wise Package Studio 5.<br><br><br />If you open the vendor package of Palm Desktop, you should check the RegistryTable.<br><br />You see lots of regkeys under HKCU, which would probably fit better in HKCR (?Classes?, ?TypeLib? and Shell Extensions).<br><br><br />As long as those keys are under HKCU a per-machine installations of the package will be very complicated and will not work on every system.<br><br><br />Capture the installation (installed ?ISScript.msi? before the capturing) and open the .WSI ? file in the Wise Installer Editor.<br><br><br />Mark the HKCU ? root of the Snapshot on the ?Registry ? Page? and export it to a .REG ? File.<br><br><br />Open the .REG ? File with ?Notepad?. Replace the string ?HKEY_CURRENT_USER\Software\Classes\? with ?HKEY_CLASSES_ROOT\?, so all Classes are where they belong.<br><br><br />Replace the string ?HKEY_CURRENT_USER\Software\? -&gt; vendor with ?HKEY_LOCAL_MACHINE\Software\?, so that the application config is available to ?All Users?.<br><br><br />After you?ve done that, delete the ?HKEY_CURRENT_USER\Software\Classes\? ? Folder in the captured installation and import the customized .REG ? File.<br><br><br />Wise should tell you that it found advertising information in the .REG ? File. You can decide whether Wise shall write this information in the corresponding Tables (Class, AppID <br><br><br />).<br><br><br />You see on the ?File Associations? ? Page that all Shell Extensions were recognized.<br><br><br />In order to make this package multi-user capable you have to give ?Everyone? full access on the program folder, because the users / profiles are put in there.<br><br><br />You don?t even have to care about the Shortcuts, because they are already ?Advertised? and the ?HotSync Manager? in the StartupFolder automatically initialises the installation of the user data as soon as another user logs in.<br><br><br />Because the Users / Profiles are put into the program folder every user can see and select all profiles created on that machine.<br><br />Apart from that the package did everything I wanted. Using this way it is possible to capture special configurations for this software (for example: standard vCal ? App check, integration of users / profiles, HotSync Manager Settings).</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/C.Landskron" class="username" rel="nofollow">C.Landskron</a>
            03/11/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
                        </div>
                        <div id="software-tag-view-tab-command-line" class="tabs-hide">
                            <div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-592"></div>
    <div class="avg-rating">115</div>
     <div class="arrow_down" id="tip-592"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>SETUP.EXE /s /v"/QB- ALLUSERS=1"<br><br><br />Try this to install Palm Desktop 4.1 for all users.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/maltic" class="username" rel="nofollow">maltic</a>
            07/08/2003 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-590"></div>
    <div class="avg-rating">2</div>
     <div class="arrow_down" id="tip-590"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>Silent setup:<br><br><br />setup.exe /S /V"INSTALLDIR=TARGETDIR /QN"</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/gbjmmp01" class="username" rel="nofollow">gbjmmp01</a>
            03/03/2003 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
                        </div>
                        <div id="software-tag-view-tab-script" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>

                        </div>
                        <div id="software-tag-view-tab-securityinfo" class="tabs-hide">
                            <div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-598"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-598"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>FileMon reports access denied on the following:<br><br><br />C:\Program Files\Palm\Instapp.exe<br><br />C:\Program Files\Palm\%username%\datebook<br><br />C:\Program Files\Palm\%username%\address<br><br />C:\Program Files\Palm\%username%\todo<br><br />C:\Program Files\Palm\%username%\memopad<br><br><br />It may be easier to just open permissions on the entire C:\Program Files\Palm\ to the native local "users" group.<br><br><br />---------------<br><br><br />RegMon reports "Access Denied" on the following:<br><br><br />HKLM\Software\MicroQuill\SmartHeap<br><br />HKLM\System\CurrentControlSet\Control\MediaProperties\PrivateProperties\Joystick\Winmm<br><br><br />---------------<br><br><br />Last, you may find you need to create a "token" file named "expreprt.exe" at C:\Program Files\Palm.&nbsp; Without it, some versions of Palm Desktop 4.x will error out looking for this this file when the following conditions are true:<br><br><br />1.&nbsp; an account other than the one that installed Palm Desktop executes the program<br><br><br />2.&nbsp; that same account does not have admin rights<br><br><br />The error is:&nbsp; "invalid configuration. terminating the palm desktop"&nbsp; Adding the value to your installation suppresses the error, and does not affect functionality.<br><br><br />The error has something to do with values entered at HKCU\Software\U.S. Robotics during the install during the original install, which self healing has difficulty addressing.<br><br><br />---------------<br><br><br />Craig --&lt;&gt;.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/craig16229" class="username" rel="nofollow">craig16229</a>
            05/23/2005 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fpalmsource%2Fdesktop-4%2F4-367">log in</a> to comment

    </div>
</div>
                        </div>
                        <div id="software-tag-view-tab-terminal" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>
                        </div>
                        <div id="software-tag-view-tab-virtualization" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>
                        </div>

                    </div>


                    
                </div>

                <div id="deploy-bottom">

                    
                </div>

            </div>

        </div>

    </div>
    <!-- end Deployment Tips -->

    <div class="software-section" id="inventory-records">

        <h2 class="section-title"><a href="#" class="plus toggle"></a> Inventory Records (2)</h2>
        <p>View inventory records anonymously contributed by opt-in users of the
            <a href="http://www.kace.com/demo/index.php?tab=flash-demo&utm_medium=ITNinja&utm_source=Software+Tag&ad_group=%20Package+KB+v2&campaign_id=701400000009kH1">
                K1000 Systems Management Appliance</a>.
        </p>

        <div class="inner-content">

            <div class="inner">

                <div id="software-view-version-revision-list">
                    <div class="title">Versions</div>
                                        <div><a class="selected" href="/software/version/revision/6019/11947">4.2.2</a></div>
                                        <div><a  href="/software/version/revision/6019/11948">4.2.1</a></div>
                                    </div>
                <div id="software-view-version-revision-details">
                                                <h2>Desktop</h2>
            <div><h3>Version</h3><span>4.2.2</span></div>
                                                        <div><h3>Uninstall String</h3>/Applications/Palm/Palm Desktop</div>                                                                                </div>
                <br class="clear"/>
            </div>

        </div>

    </div>
    <!-- end inventory records secion -->

    <div class="software-section" id="q-a">
        <div class="add-links">
               <a href="/question/new/palmsource-desktop-4" class="add-tip">Ask a new question</a>
        </div>
        <h2 class="section-title"><a href="#" class="plus toggle"></a> Questions & Answers (0)</h2>
        <p>Questions & Answers related to PalmSource Desktop</p>
        <div class="inner-content">

            <div class="inner">

                                
            </div>

        </div>
    </div>
    <!-- end Q & A secion -->

    <div class="software-section" id="blogs">
        <div class="add-links">
            <a href="/blog/post/new/palmsource-desktop-4" class="add-tip">Write a blog post</a>
        </div>
        <h2 class="section-title"><a href="#" class="plus toggle"></a> Blogs (0)</h2>
        <p>Blog posts related to PalmSource Desktop</p>
        <div class="inner-content">

            <div class="inner">

                                
            </div>

        </div>
    </div>
    <!-- end Blogs secion -->

    <div class="software-section" id="links">
        <div class="add-links">
            <a href="/link/new/palmsource-desktop-4" class="add-tip">Share a link</a>
        </div>
        <h2 class="section-title"><a href="#" class="plus toggle"></a> Links (0)</h2>
        <p>Links related to PalmSource Desktop</p>
        <div class="inner-content">

            <div class="inner">

                                
            </div>

        </div>
    </div>
    <!-- end links secion -->
    











</div>
            <div class="clear">&nbsp;</div>
        </div>
        <footer>
                        <div id="footer-nav">
                <div>
                    <strong>Home Pages</strong>
                    <ul>
                        <li><a href="/software">Software</a></li>
                        <li><a href="/tips">Deployment Tips</a></li>
                        <li><a href="/question">Questions</a></li>
                        <li><a href="/blog">Blog Posts</a></li>
                        <li><a href="/link">Shared Links</a></li>
                    </ul>
                </div>
                <div>
                   <strong>FAQ &amp; Support</strong>
                   <ul>
                       <li><a href="/faq">Site FAQ</a></li>
                       <!--<li><a href="/faq/beta">Beta FAQ</a></li>-->
                       <li><a href="/faq#PointsFAQ">Ninja Points FAQ</a></li>
                       <li><a href="/faq#ADFAQ">AppDeploy FAQ</a></li>
                       <li><a href="/kace">Dell KACE Support</a></li>
                   </ul>
               </div>
                <div>
                    <strong>About</strong>
                    <ul>
                        <li><a href="/about">ITNinja</a></li>
                        <li><a href="/about">Welcome Video</a></li>
                        <li><a href="/tour">Tour</a></li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </div>
                <div class="share">
                    <strong>Share/Contribute</strong>
                    <ul class="share-list">
                        <li><a href="http://www.facebook.com/pages/ITNinja/128951133849867"><img src="/bundles/itninjaweb/img/facebook.png" alt="Facebook"></a></li>
                        <li><a href="http://twitter.com/ITNinjaSite"><img src="/bundles/itninjaweb/img/twitter.png" alt="Twitter"></a></li>
                                            </ul>
                </div>
            </div>
        <br clear="all"/>
        <br clear="all"/>
            <div id="footer-links">
                <p>&copy; Dell Inc. All rights reserved.</p>
                <ul>
                    <li><a href="/legal">Legal</a></li>
                    <li><a href="/about" class="last">About</a></li>
                </ul>
                <p id="footer-logos">
                    <a href="http://www.kace.com/about/index.php?utm_medium=ITNinja&utm_source=Page+Footer&ad_group=ITNinja&campaign_id=701400000009kH1"><img src="/bundles/itninjaweb/img/DellKace_logo.png" alt="Dell | Kace" /></a>
                </p>
                <div id="version"><span id="revision">0cb8058</span><span id="build-date">Tue Nov 20 11:20:29 EST 2012</span>
ninjaweb02<span id="server">www.itninja.com</span></div>
            </div>
        </footer>
        <!--[if lte IE 7 ]>
            <script src="/bundles/itninjaweb/js/plugins/jquery.pngFix.pack.js"></script>
        <![endif]-->
        <script src="/js/c7062e8.js"></script>
        
        
        <script src="/js/0c271c0.js"></script>
<script>
// has to be in here for the asset parameters to get rendered by twig
    $(function(){

        $('.toggle').click(function(e){
            e.preventDefault();
            $(this).toggleClass('minus');
            var content = $(this).parents('.software-section').children('.inner-content');

            if (!$(content).is(':animated')){
                $(content).toggle('fast');
            }

        });

        $('#scrollQA').click(function(){
            $('html,body').animate({scrollTop: $('#q-a').offset().top},'slow');
        });
        $('#scrollBlog').click(function(){
            $('html,body').animate({scrollTop: $('#blogs').offset().top},'slow');
        });
        $('#scrollInv').click(function(){
            $('html,body').animate({scrollTop: $('#inventory-records').offset().top},'slow');
        });
        $('#scrollLinks').click(function(){
            $('html,body').animate({scrollTop: $('#links').offset().top},'slow');
        });
        $('.top').click(function(){
            $('html,body').animate({scrollTop: $('#global-content').offset().top},'slow');
        });

        var list = $('#version-list');

        $('#version-changer').live("click", function(){

            if (list.hasClass('show')){

            } else {
                $("body").addClass('menu-open');
                list.addClass('show');
            }
        });
        $("body.menu-open").live("click", function(){
            list.removeClass('show');
            $("body").removeClass('menu-open');
        });

        $('#software-view-version-revision-list a').click( function(evt) {
            $("#software-view-version-revision-list a").removeClass('selected');
            $(this).addClass('selected');
            evt.preventDefault();
            $.get($(this).attr('href'), function(data) {
                $("#software-view-version-revision-details").html(data);
            });
        });


        $.get("/software/version/deployment_ratings/6019", function(data) {
              $("#deployment-ratings-summary").html(data);
              ratings.init();
        });



});
</script>
            <!--[if lt IE 9]>
            <script src="/js/211a076.js"></script>        <![endif]-->
                    <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-26553848-1']);
                _gaq.push(['_trackPageview']);

                (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();
            </script>
                            <script type="text/javascript">
              var uvOptions = {};
              (function() {
                var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
                uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/1cft4y4FWQ7YXJ6BaxBYQ.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
              })();
            </script>
            <script type="text/javascript">if(!NREUMQ.f){NREUMQ.f=function(){NREUMQ.push(["load",new Date().getTime()]);var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="https://d1ros97qkrwjf5.cloudfront.net/42/eum/rum.js";document.body.appendChild(e);if(NREUMQ.a)NREUMQ.a();};NREUMQ.a=window.onload;window.onload=NREUMQ.f;};NREUMQ.push(["nrf2","beacon-1.newrelic.com","fa2fb87fc4",520511,"b1BUNhNQC0dUWkANC1YaYxAIHgRERRdEDBQ=",0,283,new Date().getTime()]);</script>
</body>
</html>