<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <script type="text/javascript">var NREUMQ=NREUMQ||[];NREUMQ.push(["mark","firstbyte",new Date().getTime()]);</script>
<title>Macrovision - InstallScript Engine - 8 | ITNinja</title>
        <meta name="description" content="Deployment tips and related materials related to Macrovision InstallScript Engine 8">
        <meta name="keywords" content="Macrovision InstallScript Engine,Macrovision">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="yMY423DZduMGIsTKJnJbRzr_qC4FUxtEhXxtuGftSGw" />
        <link rel="shortcut icon" href="/bundles/itninjaweb/img/favicon.ico">
        <link rel="apple-touch-icon" href="/bundles/itninjaweb/img/apple-touch-icon.png">

        <link rel="stylesheet" type="text/css" media="screen" href="/css/4f9a382.css" />
        
        <link href="/css/df4eb8b.css" rel="stylesheet" type="text/css" />
        
            <link rel="stylesheet" type="text/css" media="screen" href="/css/8975654.css" />
        <!--[if lt IE 9]>
            <script src="/js/ede9468.js"></script>        <![endif]-->

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
        <script type="text/javascript">
            window.jQuery || document.write("<script src='/bundles/itninjaweb/js/jquery-1.6.1.min.js'>\x3C/script>");
            var TAG_SERVER = 'tags.itninja.com';
        </script>

        <!--[if IE]>
            <script src="/js/001a46f.js"></script>            <script>
                $(document).ready(function(){
                    $('input').placeholder();
                })
            </script>
        <![endif]-->

                    </head>
    <body>
                <header>
            <p id="kace-link">&nbsp;</p>
            <ul id="user-info">
    <li class="last"><a href="/register" class="register">register</a><a href="/login" class="button">Log in</a></li>
</ul>            <span id="logo"><a href="/"><img src="/bundles/itninjaweb/img/ITN_logo_no_AD.png" alt="ITNinja Home" width="221" height="53" /></a></span>
            <nav>
                                    <form method="get" action="/search#search-filter-by-keyword" id="nav-search"><input type="text" name="q" class="q" placeholder="search"/><input type="image" name="i" class="i" src="/bundles/itninjaweb/img/search_icon.png" alt="go" title="go" /><input type="hidden" name="cx" value="014503921158165719423:3hy89iql-j8" /><input type="hidden" name="t" value="search-filter-by-keyword" /></form>
                                    <ul>
                <li class="first">        <a href="/question">Ask</a>            <ul class="menu_level_1">
                <li class="first last">        <a href="/question/new">Ask A Question</a>        
    </li>


    </ul>

    </li>

        <li>        <a href="/research">Research</a>            <ul class="menu_level_1">
                <li class="first">        <a href="/software/browse?Popular=1">Software</a>        
    </li>

        <li>        <a href="/tips">Deployment Tips</a>        
    </li>

        <li>        <a href="/question">Q &amp; A</a>        
    </li>

        <li>        <a href="/blog">Blogs</a>        
    </li>

        <li class="last">        <a href="/link">Links</a>        
    </li>


    </ul>

    </li>

        <li>        <a href="/share">Share</a>            <ul class="menu_level_1">
                <li class="first">        <a href="/question/unanswered">Answer a Question</a>        
    </li>

        <li>        <a href="/blog/post/new">Write a Blog Post</a>        
    </li>

        <li>        <a href="/tips">Share a Deployment Tip</a>        
    </li>

        <li class="last">        <a href="/link/new">Share a Link</a>        
    </li>


    </ul>

    </li>

        <li>        <a href="/topics">Topics</a>        
    </li>

        <li class="last">        <a href="/about">About</a>            <ul class="menu_level_1">
                <li class="first">        <a href="/tour">Site Tour</a>        
    </li>

        <li>        <a href="/faq">FAQ</a>        
    </li>

        <li>        <a href="/faq#PointsFAQ">ITNinja Points</a>        
    </li>

        <li class="last">        <a href="/faq#ADFAQ">AppDeploy</a>        
    </li>


    </ul>

    </li>


    </ul>

            </nav>
            <div id="secondary-nav"></div>
        </header>
        <div id="global-content">
            <ul id="breadcrumbs">
                <li class="home"><a href="/">
                    <img src="/bundles/itninjaweb/img/Breadcrumb_cap.png"/></a></li>
                    <li><a href="/research">Research</a></li>
    <li><a href="/software/browse?Popular=1">Software</a></li>
    <li><a href="/software/macrovision/browse">Macrovision</a></li>
    <li>InstallScript Engine</li>
            </ul>
            <div id="stage">
    <div class="tag-header">
        <div class="title-wrap">
            <h1>Macrovision InstallScript Engine</h1>

            <div id="version-wrapper">

                <span class="version-name" id="version-changer">
                    Version: 8
                    <div id="version-list">
                        <div class="version-list-top"></div>
                        <ul id="version-list-items">
                                                            <li>
                                    <a href="/software/macrovision/installscript-engine/8-1162">
                                        8.x <span>(9 tips)</span>
                                    </a>
                                </li>
                                                    </ul>
                        <div class="version-list-bottom"></div>
                    </div>
                </span>

            </div>


        </div>
    </div>


    <div class="tr-meta">
        
Average Rating: <span id="average-rating">0</span>
<div class="stars-wrap">
        <div class="rating">
    <input name="Software31531" type="radio" class="star" disabled="disabled"  />
    <input name="Software31531" type="radio" class="star" disabled="disabled"  />
    <input name="Software31531" type="radio" class="star" disabled="disabled"  />
    <input name="Software31531" type="radio" class="star" disabled="disabled"  />
    <input name="Software31531" type="radio" class="star" disabled="disabled"  />
</div>    </div>

<br class="clear"/>

Views: 49 &nbsp|&nbsp
Created: 05/19/2006 &nbsp|&nbsp
Followers:1




<div class="follow-widget-right">
            <a class="btn-follow" rel="nofollow" href="https://www.itninja.com/login?/follow/version/39554?tb=L3NvZnR3YXJlL21hY3JvdmlzaW9uL2luc3RhbGxzY3JpcHQtZW5naW5lLzgtMTE2Mg==">
            <span class="follow-title">Follow this Version </span>
            <span class="followers" title="followers"><div></div>1</span>
        </a>
    </div>    </div>

    <div class="additional-meta">
        InstallScript Engine has <a href="#inventory-records" id="scrollInv">1 inventory records</a>,
        <a href="#q-a" id="scrollQA">0 Questions</a>,
        <a href="#blogs" id="scrollBlog">0 Blogs</a>
        and <a href="#links" id="scrollLinks">2 links</a>. Please help add to this by sharing more!

    </div>


    <div class="software-section" id="deployment-tips">

        <h2 class="section-title"><a href="#" class="plus toggle minus"></a> Deployment Tips (9)</h2>
        
        <div class="inner-content" id="deploy-div">

            <div id="deployment-ratings-summary" class="inner">
            </div>

            <!-- end rating secion -->

            <div class="inner summary">

                                                        <h3>Deployment Tip Summary</h3>
                    <p><a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162" class="btn">Add a Summary</a></p>
                
                <div id="software-view-deployment-summary-form" class="hidden">
                    <h3>Deployment Tip Summary</h3>
                    <form action="/version/summary/new/39554" method="POST" novalidate>
    <div id="form"><input type="hidden" id="form__token" name="form[_token]" value="4dfb1a1d378f11209e4a23fef9be046133ece93b" /><div><label for="form_text" class=" required">Enter your tip</label><textarea id="form_text" name="form[text]" required="required"></textarea></div></div>

    <input type="hidden" name="redirectUrl" value="http://www.itninja.com/software/macrovision/installscript-engine/8-1162" />
    <input type="submit" value="Submit" id="submit1" class="btn"/>
    <span id="software-view-deployment-summary-cancel" class="btn" >Cancel</span>
</form>                </div>

                <div id="software-view-deployment-summary-text" class="hidden">

                    <h3>Deployment Tip Summary</h3>
                    <div id="software-view-deployment-summary-text-raw"></div>
                                                        </div>

            </div>
            <!--end summary -->

            <div class="inner">

                <div class="version-subsections">
                    
                    <div id="tabs">
                        <ul class="tabs clearfix">
                            <li><a href="#software-tag-view-tab-notes">Notes (9)</a></li>
                            <li><a href="#software-tag-view-tab-command-line">Command Line (0)</a></li>
                            <li><a href="#software-tag-view-tab-script">Script (0)</a></li>
                            <li><a href="#software-tag-view-tab-securityinfo">Security (0)</a></li>
                            <li><a href="#software-tag-view-tab-terminal">Terminal Services (0)</a></li>
                            <li><a href="#software-tag-view-tab-virtualization">Virtualization (0)</a></li>
                        </ul>
                        <div class="tabs-loading">
                            Please wait.
                        </div>
                        <div id="software-tag-view-tab-notes" class="tabs-hide">
                            <div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3099"></div>
    <div class="avg-rating">125</div>
     <div class="arrow_down" id="tip-3099"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>Here is a simple solution to deploying and using ISscript (any version to date) that has worked for us.&nbsp; Firstly I will explain what I understand to be the problem so that you can understand the solution better.&nbsp; Please note this will be more difficult for installations that have embedded versions of isscript rather than a sepearate isscript msi but the principal is the same.<br><br><br />The problem is down to DCOM.&nbsp; The installscript engine is used for any installation that contains installscript (like wscript/cscript is needed to run a vbscript).&nbsp; <br><br />If you were to run DCOMCNFG.EXE on your PC, you will most likely see some entries for InstallShield DCOM configuration items. This is a major part of ISScript.&nbsp; If you select the properties you will notice that an 'out-of-the-box" installation of Isscript sets the identity to interactive user.&nbsp; What this means is that Isscript will run with the credentials of the logged on user which is not normally good enough in a deployment situation.&nbsp; Instead what we want is for Isscript to run as the launching user.&nbsp; In otherwords we need to run Isscript using the elevated user that group policy, sms or other deployment method uses such as the system account.<br><br><br />This all explains why Isscript installs correctly but when attempting to use it, it does not work.<br><br><br />The most popular solution found in other posts would be to delete the run as interactive user key in the isscript msi.&nbsp; By deleting the key you are installing the DCOM object as the launching user. The default for a DCOM object is launching user and you set that by NOT having a run as key.&nbsp; This is all very good but in the real world, this would not work.&nbsp; The reason being is that although installshield versions overwrite each other, the DCOM objects don't so you may be too late in getting your modified version to the PC and a manual installation or other previously attempted deployed version has already done its damage and your modified package will not fix it.<br><br><br />Some other solutions i have found have been:<br><br><br />Install and modify all version onto a PC - Isscript does not co-exist with other versions. New versions overwrite older ones and older versions overwrite newer ones (Except for DCOM objects).<br><br><br />Big long list of changes to registry keys etc in the isscript MSI - Now i have explained the problem, hopefully you can see a complex solution like this is very unlikely to work and is more likely to break Isscript than to do any good.<br><br><br />********************<br><br />Finally my solution&nbsp; <br><br />********************<br><br><br />This has to be done for every Isscript package<br><br><br />1. Deploy Isscript.msi (untouched) on to the target machine<br><br />2. Run the script shown below.&nbsp; The script looks for all required Installscript DCOM objects (all Isscript versions) using WMI, reports on the AppID and deletes the run as registry key for that AppID.&nbsp; No modification is required to the script for your version of Isscript or environment.<br><br />3. deploy your product that requires Isscript<br><br><br />*********************************************************<br><br />Script - Copy from the line directly below these stars to the bottom of this post<br><br />*********************************************************<br><br><br />Dim WMIService, WshShell, DComApps, DComApp<br><br><br />'Create WMI object<br><br />Set WMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2") <br><br />'Create shell object<br><br />Set WshShell = CreateObject("WScript.Shell") <br><br><br />'Query all DCOM object on the machine that are Installshield related and set to run as interactive user<br><br />Set DComApps = WMIService.ExecQuery("Select * from Win32_DComApplicationSetting where Caption Like '%InstallShield%' and RunAsUser='Interactive User'") <br><br><br />'Delete the registry key that set the run as for the DCOM application (DCOM guid is used from the above query to locate the registry)<br><br />For Each DComApp In DComApps <br><br />WshShell.RegDelete "HKEY_CLASSES_ROOT\AppID\" &amp; DComApp.AppID &amp; "\RunAs" <br><br />Next<br><br><br />'Query all DCOM object on the machine that are Installshield related and set to run as interactive user<br><br />Set DComApps = WMIService.ExecQuery("Select * from Win32_DComApplicationSetting where Caption Like '%IDriverT%' and RunAsUser='Interactive User'") <br><br><br />'Delete the registry key that set the run as for the DCOM application (DCOM guid is used from the above query to locate the registry)<br><br />For Each DComApp In DComApps <br><br />WshShell.RegDelete "HKEY_CLASSES_ROOT\AppID\" &amp; DComApp.AppID &amp; "\RunAs" <br><br />Next<br></p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/ColinBragg" class="username" rel="nofollow">ColinBragg</a>
            05/21/2007 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3095"></div>
    <div class="avg-rating">119</div>
     <div class="arrow_down" id="tip-3095"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>I simply used WinInstallLE version to generate new package and product codes for all versions of installscript. <br><br><br />Deployed via GP no problems.<br><br><br />Also, at least 2 (7 and 8) have updates, which I don't believe can be downloaded seperately, they are extracted and updated during the setup process. My example was MYOB. So I ran setup, got all the updated versions (ie, the files in ...driver\7\Intel 32 directory) I need and put them into an 'update_isscript.msi' and deployed via GP.<br><br><br />So far, every application using Isscript works since every version is installed. I did this by a seperate group policy and enforcing it, so it takes preceedance before the applications attempt installation.<br><br><br />-SP</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/snapzilla" class="username" rel="nofollow">snapzilla</a>
            05/31/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3094"></div>
    <div class="avg-rating">118</div>
     <div class="arrow_down" id="tip-3094"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>We recently ran into this situation at our work and in order to deploy InstallShield Scripts 8-11 I made a new MSI named ISScript (Version #) Installer.msi I added a text file to the file deployment to ensure that the isscript was installed (also if the MSI is empty you will run into errors). <br><br><br />I then went to custom actions, add a new nested MSI with the media on source location.&nbsp; I added the original isscript to Install on Execute after Product Finalize.&nbsp; This will allow you to deploy all the ISScript versions over AD and also remove them.<br><br><br />For 7 since there is a short file name error I did a big nono in the community and just repackaged it using a before and after snapshot. <br><br><br />This allowed us to deploy all of our applications that use ISScripts 7 to 11 over AD.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/dean5101" class="username" rel="nofollow">dean5101</a>
            05/19/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3093"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-3093"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>This comes in the format ISScript8.msi and needs to be installed before deploying some MSI installers in Group Policy.<br><br><br />It's important to use the latest version available. Look at the date of the digital signature to find out what version you have. The latest I could find is the 09 April 2003 and it is available from:<br><br><a href="http://support.installshield.com/kb/view.asp?articleid=Q108527">http://support.installshield.com/kb/view.asp?articleid=Q108527</a><br><br><br />(There is a later version of the file available at InstallShield Q109906, but it actually downgrades one of the files inside, so I wouldn't advise using it)<br><br><br />INSTALLING THROUGH GROUP POLICY<br><br />This installer never actually registers itself properly with Windows Installer and is not really designed for use with Group Policy<br><br><br />If you install it with GP directly, standalone installers that use ISScript will fail with the following error:<br><br><br />1608: Unable to create InstallDriver instance. <br><br />Return code: -2147221164<br><br><br />Also, all of the versions of ISScript (7,8,9,10,11) use the same Product Code which means that more than one version won't install properly in GP<br><br><br />The fix is to create a wrapper which runs the MSI file as a 'concurrent' or 'nested' installation.<br><br />If you want more versions of ISScript installed, you'll need to create a new wrapper for each one.<br><br />NB You can't just copy an old one as you need to have a new Product ID.<br><br><br />See the following for more information:<br><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9841">http://www.appdeploy.com/messageboards/tm.asp?m=9841</a><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9872">http://www.appdeploy.com/messageboards/tm.asp?m=9872</a><br><a href="http://community.installshield.com/showthread.php?t=154647">http://community.installshield.com/showthread.php?t=154647</a><br><br><br />TO CREATE THE WRAPPER<br><br />Copy ISScript8.msi to a folder<br><br />Use WIWW 0.0.0.1 (<a href="http://www.sywan.nl/download/">http://www.sywan.nl/download/</a>)<br><br />&Acirc;&nbsp;Create a new MSI, 'ISScript8 Wrapper.msi', in the same folder<br><br />&Acirc;&nbsp;Add Install Command:<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Property: SourceDir<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Program to run: (Type in) ISScript8.msi<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Parameters: ALLUSERS="[ALLUSERS]"<br><br />&Acirc;&nbsp;&Acirc;&nbsp;DON'T reboot at the end of installation<br><br />&Acirc;&nbsp;Uninstall Command:<br><br />&Acirc;&nbsp;&Acirc;&nbsp;None<br><br />&Acirc;&nbsp;Search for Files:<br><br />&Acirc;&nbsp;&Acirc;&nbsp;None<br><br />&Acirc;&nbsp;Product Details:<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Language: English (United States)<br><br />&Acirc;&nbsp;&Acirc;&nbsp;LEAVE IN Add/Remove Programs (for testing)<br><br />Edit with Orca:<br><br />&Acirc;&nbsp;CustomAction table:<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Drop 'WIWW_InstallCommand1'<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Change 'WIWW_InstallParam1' so that the 'Type' is '23' and the 'Source' is 'ISScript8.msi'<br><br />&Acirc;&nbsp;&Acirc;&nbsp;&Acirc;&nbsp;(The 'Target' should already be 'ALLUSERS="[ALLUSERS]"')<br><br />&Acirc;&nbsp;InstallExecuteSequence table:<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Drop 'WIWW_InstallCommand1'<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Change the 'Condition' for 'WIWW_InstallParam1' to 'NOT REMOVE' (instead of 'Not Installed')<br><br />&Acirc;&nbsp;&Acirc;&nbsp;Change the 'Condition' for 'ResolveSource' to 'NOT REMOVE' (instead of 'Not Installed')<br><br />&Acirc;&nbsp;&Acirc;&nbsp;&Acirc;&nbsp;(This is so that you can do a Group Policy 'Redeploy' if you need to)</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/Minkus" class="username" rel="nofollow">Minkus</a>
            06/07/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3097"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-3097"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>v8.1.0.304<br><br><br />After trawling the various app packaging websites I've seen some good points relating to the install of ISscript &amp; lots of workarounds...<br><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9841&amp;mpage=1&amp;key=Atach%2Cinstallscript%2Cengine">Atach installscript engine to one msi via GPO</a><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9872">Follow up Isscript.msi question</a><br><a href="http://www.appdeploy.com/faq/detail-pf.asp?id=76">Bob Kelly's post at AppDeploy</a><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=599&amp;mpage=1&amp;key=ISCleanUpFatalExit">Error when deploying with AD</a><br><a href="http://doctordeploy.com/viewtopic.php?t=93&amp;sid=577ae88fce2a9453ee39146e7cf127c0">Orakel's post on DoctorDeploy</a><br><a href="http://community.installshield.com/showthread.php?t=149462&amp;page=3&amp;pp=5">Unattended installation: "Failed to Initialize script support" problems</a><br><a href="http://community.installshield.com/showthread.php?t=154647">Possible isscript error fix</a><br><br><br />...but I haven't seen anyone provide a comprehensive solution to the actual problem, so please allow me to provide a far better solution (IMHO).<br><br><br />This solution is based on <a href="http://support.installshield.com/kb/files/Q108322/ISScript8.zip">ISScript v8.1.0.304</a> but I guess it could be applied to any version of ISscript.msi.<br><br><br />1. Can't use a transform<br><br />It is not possible to create a transform for the original Installshield MSI as is normal practice when modifying software packages which are supplied in the MSI format by third parties. It was necessary to change the package Code for the product to stop any conflicts between the different versions of InstallScript which have all been created with the same package code. If Orca attempts <br><br />to modify the Package Code within a transform the option is greyed out. The reason this is not possible is because the Package Code is part of the summary information stream. The Windows Installer SDK states:<br><br />&Acirc;&#147;A transform can modify information that is in any persistent table in the installer database. A transform can also add or remove persistent tables in the installer database. Transforms cannot modify any part of an installation package that is not in a database table, such as information in the summary information stream, information in substorages, information in nested installations, or files in embedded cabinets&Acirc;&#148;.<br><br><br />It was therefore necessary to modify the original MSI. Open the Installshield ISScript MSI in Orca &amp; save as &Acirc;&#147;ISScript_v8.1.0.304.Msi&Acirc;&#148;. Create a new Package Code by viewing the Summary Information &amp; generating a new GUID using the &Acirc;&#147;New GUID&Acirc;&#148; button to the right of the existing GUID<br><br><br />2. Missing &Acirc;&#147;ISscript.msi&Acirc;&#148; actions<br><br />When an install is performed with Installshield&Acirc;&#146;s original MSI, &Acirc;&#147;ISscript8.msi&Acirc;&#148;, it does not appear in Add Remove Programs as the property &Acirc;&#147;ARPSYSTEMCOMPONENT&Acirc;&#148; has been set with a value of &Acirc;&#147;1&Acirc;&#148;. Removing this property will not result in an MSI which installs correctly. The SDK states:<br><br />&Acirc;&#147;Note:&nbsp;  This only affects the display in the ARP. The Windows Installer is still capable of repairing, installing-on-demand, and uninstalling applications through a command line or the programming interface&Acirc;&#148;. <br><br />&amp; &Acirc;&#147;To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage an application, leave the registration actions in the sequence tables, and set the ARPSYSTEMCOMPONENT Property in the Property Table to 1 (one). The application does not appear in the Add or Remove Programs feature, but you can use the Windows Installer to install-on-demand, uninstall, repair, and reinstall the application&Acirc;&#148;.<br><br><br />If the ARPSYSTEMCOMPONENT is removed the application still won&Acirc;&#146;t appear in Add/Remove Programs. The clue was in the previous SDK statement: &Acirc;&#147;leave the registration actions in the sequence tables &Acirc;&#147;.<br><br><br />As the SDK states:<br><br />&Acirc;&#147;Registration is used by the installer for advertisement and by the Add or Remove Programs feature in Control Panel. If an application is not registered, it cannot be advertised, and is not listed in the Add or Remove Programs feature in Control Panel. You can omit registering an application by removing the RegisterProduct Action, RegisterUser Action, PublishProduct Action, and PublishFeatures Action from the InstallExecuteSequence Table and AdvtExecuteSequence Table. All of these actions must be removed, or some trace of the application may remain in the registry. Removing all of these actions prevents the application from being listed in the Add or Remove Programs feature in Control Panel, and prevents the advertisement of the application. Removing all of these actions also prevents the application from being registered with the Windows Installer configuration data. <br><br><br />This means that you cannot remove, repair, or reinstall the application by using the Windows Installer Command-Line Options, or the Windows Installer application programming interface (API)&Acirc;&#148;.<br><br><br />To ensure that the InstallScript MSI registers itself, add the following rows to the InstallExecuteSequence table.<br><br><br />Action		Condition	Sequence<br><br />PublishFeatures	N/A		6300<br><br />PublishProduct	N/A		6400<br><br />RegisterProduct	N/A		6100<br><br />RegisterUser	N/A		6000<br><br><br />Adding these 4 rows will prevent any ICE82 errors occurring during MSI validation.<br><br><br />If the InstallExecuteSequence table of &Acirc;&#147;ISscript8.msi&Acirc;&#148; is compared to the standard Wise Windows template it is apparent that there are still more rows in the Wise template. Some of the rows are unimportant but some are vital to ensure InstallScript is installed &amp; removed correctly. Add the following rows too:<br><br><br />Action			Condition	Sequence<br><br />ProcessComponents	N/A		1600<br><br />UnpublishFeatures	N/A		1800<br><br />UnregisterComPlus	N/A		2100<br><br><br />If it is necessary to advertise components the following rows would be added. <br><br><br />Action			Condition	Sequence<br><br />PublishComponents	N/A		6200<br><br />UnpublishComponents	N/A		1700<br><br><br />3. Missing &Acirc;&#147;ISscript.msi&Acirc;&#148; ComponentIDs<br><br />Even with the important missing actions added the &Acirc;&#147;ISscript.msi&Acirc;&#148; install will not register its components correctly. This can be proved by using the SDK tool &Acirc;&#147;MSISPY&Acirc;&#148; to view the installed components for ISScript. MSISPy shows that the app is installed locally but lists no components. The reason this occurs is because the Component table has values missing from the ComponentID column for each component. Without the componentIDs the MSI will not be correctly registered with the Windows Installer configuration data. The SDK states:<br><br />&Acirc;&#147;ComponentId A string GUID unique to this component, version, and language. If this column is null the installer does not register the component and the component cannot be removed or repaired by the installer. This might be intentionally done if the component is only needed during the installation, such as a custom action that cleans up temporary files or removes an old product. It may also be useful when copying data files to a user's computer that do not need to be registered&Acirc;&#148;.<br><br><br />Create a unique ComponentID for each component using the &Acirc;&#147;Paste New GUID&Acirc;&#148; button.<br><br><br />4. Ensuring uninstall removes all files &amp; registry entries<br><br />With the previous steps included in the MSI it should now install correctly &amp; register all components. It will however still have problems during uninstall. Although no error messages will occur during uninstall the MSI will not be removed from the target PC. <br><br><br />All files will be left behind. To remedy this it is necessary to add the following rows to the RemoveFile Table.<br><br><br />Filekey			Component	FileName			DirProperty	InstallMode<br><br />F1322_ISRT.dll		ISRT.dll	ISRT.dll			INTEL_32	2<br><br />F1324_ISRES.dll		_ISRES.dll	_ISRES~1.DLL|_ISRES1033.dll	INTEL_32	2<br><br />F1319_IDriver.exe	iDriver.exe	iDriver.exe			INTEL_32	2<br><br />F1321_IUser7.dll	iUser.dll	iUser.dll			INTEL_32	2<br><br />F1320_IScript7.dll	iscript.dll	iscript.dll			INTEL_32	2<br><br />F1323_objps7.dll	objectps.dll	objectps.dll			INTEL_32	2<br><br><br />To delete the registry entries on uninstall do not make the mistake of using the RemoveRegistry table as this table is for registry entries which should be deleted when the product is installed. Instead add the following entries to the Registry table.<br><br><br />Registry	Root	Key							Name	Value	Component<br><br />registryDel	2	SOFTWARE\InstallShield\Driver\8				*		RegDel<br><br />registryDel1	0	AppId\IDriver.EXE					*		RegDel<br><br />registryDel10	0	CLSID\{FFD7B771-8ECA-45DE-A944-7B013C6C2DF5}		*		RegDel<br><br />registryDel11	0	Interface\{02C0495A-3F58-4701-9913-7E855178A5D9}	*		RegDel<br><br />registryDel12	0	Interface\{04FAC07A-AD76-4AB8-B993-B597AFC3D947}	*		RegDel<br><br />registryDel13	0	Interface\{093FB88F-A6A3-4999-897F-56F40B4CFCAD}	*		RegDel<br><br />registryDel14	0	Interface\{0E60DA5C-4175-4BD1-89C5-577032A931A0}	*		RegDel<br><br />registryDel15	0	Interface\{124CCD5E-38F2-4DD6-9F47-BF175CE82B41}	*		RegDel<br><br />registryDel16	0	Interface\{1631C530-502B-4BDA-A564-83AF569AF7A9}	*		RegDel<br><br />registryDel17	0	Interface\{1634D100-7F17-4DEE-B79B-6B1AA35BF057}	*		RegDel<br><br />registryDel18	0	Interface\{18889DE5-3E21-4675-8520-64702DB349C1}	*		RegDel<br><br />registryDel19	0	Interface\{1E512A8C-7375-4F79-9260-11B1F476F3A8}	*		RegDel<br><br />registryDel2	0	AppId\IDriver2.exe					*		RegDel<br><br />registryDel20	0	Interface\{257154A2-C292-49AB-9003-D317971F2FF1}	*		RegDel<br><br />registryDel21	0	Interface\{2582B888-6E3A-40D7-BDC8-C0D82A6FD91F}	*		RegDel<br><br />registryDel22	0	Interface\{2CA491F2-DB7D-4A35-88B2-A00961598BB5}	*		RegDel<br><br />registryDel23	0	Interface\{2D939419-6930-40B0-8D36-729D1631D705}	*		RegDel<br><br />registryDel24	0	Interface\{31B499B0-B759-44E2-8A98-5D8CE56CE20F}	*		RegDel<br><br />registryDel25	0	Interface\{33618277-58AF-4F80-A6DD-2716F6146F9A}	*		RegDel<br><br />registryDel26	0	Interface\{34A2F43F-B821-4D14-91EE-39B015B8E66E}	*		RegDel<br><br />registryDel27	0	Interface\{352F743D-092B-4FC5-BABF-BCF5443EBCEA}	*		RegDel<br><br />registryDel28	0	Interface\{3F5F1DF3-D966-46B7-8A49-40D9043064DD}	*		RegDel<br><br />registryDel29	0	Interface\{49C1B167-C294-4C76-91C0-88EBF91E88EE}	*		RegDel<br><br />registryDel3	0	AppId\{1BB3D82F-9803-4d29-B232-1F2F14E52A2E}		*		RegDel<br><br />registryDel30	0	Interface\{4BD7C536-BFD8-41FF-826E-D8CED3178B5B}	*		RegDel<br><br />registryDel31	0	Interface\{4D67F0D9-B58C-4E7A-ADF7-CBE625EE76FB}	*		RegDel<br><br />registryDel32	0	Interface\{5037E6EF-3F8A-4155-B930-6C570449975C}	*		RegDel<br><br />registryDel33	0	Interface\{54915582-84C5-4026-97A0-398A87854CDA}	*		RegDel<br><br />registryDel34	0	Interface\{55E72919-0516-4EFB-AD27-E841798BC170}	*		RegDel<br><br />registryDel35	0	Interface\{573AEDC3-2F32-48F6-8F74-20F004C9D7CB}	*		RegDel<br><br />registryDel36	0	Interface\{5A6D100E-6A54-4EBC-AC92-5904C5C13559}	*		RegDel<br><br />registryDel37	0	Interface\{5FC196B5-34D2-4D23-B59E-4FA93C229564}	*		RegDel<br><br />registryDel38	0	Interface\{663256A7-466C-4023-BD46-4DD6DF8B2F90}	*		RegDel<br><br />registryDel39	0	Interface\{6AF3C35B-B523-4F33-8FCF-19AE3C66FB2F}	*		RegDel<br><br />registryDel4	0	AppId\{C2B96968-8E30-4BA4-A8F9-F40D09D1EA7E}		*		RegDel<br><br />registryDel40	0	Interface\{6E7D9436-492E-4290-A935-7D1A6B0D8BEA}	*		RegDel<br><br />registryDel41	0	Interface\{71CCE912-60B3-4863-9818-315A4B289768}	*		RegDel<br><br />registryDel42	0	Interface\{72B62824-6273-458C-BA83-C90061D3F764}	*		RegDel<br><br />registryDel43	0	Interface\{74C46962-AC20-460E-B824-F8B9A67EB2F2}	*		RegDel<br><br />registryDel44	0	Interface\{7B3B6B6D-9FC7-4CFA-8020-C3AD61B27F55}	*		RegDel<br><br />registryDel45	0	Interface\{8142F6EE-E39A-45F1-962D-9B1BE8630ED1}	*		RegDel<br><br />registryDel46	0	Interface\{84A21E2C-89EE-43EE-B8A7-867AAC3D821D}	*		RegDel<br><br />registryDel47	0	Interface\{8866B471-D0AE-49DC-A18A-47208A74B7D0}	*		RegDel<br><br />registryDel48	0	Interface\{88BBB500-CD36-4B16-A44C-1C97FD37DD3D}	*		RegDel<br><br />registryDel49	0	Interface\{8A77E8D8-AFAF-4FED-A41C-DD40295D606F}	*		RegDel<br><br />registryDel5	0	CLSID\{697DEABA-809C-49FC-ADD1-E9902D88360D}		*		RegDel<br><br />registryDel50	0	Interface\{923DF001-BD30-431A-A889-43D11CF08904}	*		RegDel<br><br />registryDel51	0	Interface\{940E8700-5855-41E9-AD93-EA0B3C6D44A6}	*		RegDel<br><br />registryDel52	0	Interface\{9923E8CC-7323-43FA-B6E3-27371227F89D}	*		RegDel<br><br />registryDel53	0	Interface\{9D85DD57-CCA3-4D7E-AA05-5BC205C2882B}	*		RegDel<br><br />registryDel54	0	Interface\{A1726C4F-5238-4907-B312-A7D3369E084E}	*		RegDel<br><br />registryDel55	0	Interface\{A2B0FEA2-C453-41F7-9E00-EF1F198DDA68}	*		RegDel<br><br />registryDel56	0	Interface\{A4FAB52E-45B1-4A62-A85F-9E20567F5CC6}	*		RegDel<br><br />registryDel57	0	Interface\{A919CEE5-F305-4FF6-B0B3-561C37AEEF7A}	*		RegDel<br><br />registryDel58	0	Interface\{AE8C683F-EC6D-49CD-9B74-A68F8828DEF6}	*		RegDel<br><br />registryDel59	0	Interface\{B27F4061-C6CD-42C4-881E-4D1597D0150F}	*		RegDel<br><br />registryDel6	0	CLSID\{8B1670C8-DC4A-4ED4-974B-81737A23826B}		*		RegDel<br><br />registryDel60	0	Interface\{BAB1BAB2-AD26-42EE-B4FE-B62A7AE96F62}	*		RegDel<br><br />registryDel61	0	Interface\{BD696316-7B37-4850-9D8E-253F47C715AC}	*		RegDel<br><br />registryDel62	0	Interface\{BE0B3F76-166A-4DA5-A97C-318595E3D15C}	*		RegDel<br><br />registryDel63	0	Interface\{C18F0E02-E02F-4402-A8D7-70CABCC01738}	*		RegDel<br><br />registryDel64	0	Interface\{C6A51663-014C-4038-A996-5B98A89B15C4}	*		RegDel<br><br />registryDel65	0	Interface\{C8B06ECF-F4F6-4FDE-AF52-DDC2DC42EC78}	*		RegDel<br><br />registryDel66	0	Interface\{C8B91CC3-8EB9-45DD-974A-76914C156A06}	*		RegDel<br><br />registryDel67	0	Interface\{C8CA19E8-1060-4EA3-86AF-EEE81AD5883A}	*		RegDel<br><br />registryDel68	0	Interface\{C9D3A246-13AD-4CD6-8C3F-ED2BFE13CA72}	*		RegDel<br><br />registryDel69	0	Interface\{CBF70AF9-A780-4527-93FA-0E98699D1415}	*		RegDel<br><br />registryDel7	0	CLSID\{A1726C4F-5238-4907-B312-A7D3369E084E}		*		RegDel<br><br />registryDel70	0	Interface\{CE8C94E9-4ABB-4E72-9D7D-E875AF9E2D72}	*		RegDel<br><br />registryDel71	0	Interface\{CEAAAD86-7088-4CE6-9557-3848C0C585BE}	*		RegDel<br><br />registryDel72	0	Interface\{CEAFB994-EE86-4046-8084-E697AC15B9F6}	*		RegDel<br><br />registryDel73	0	Interface\{D58FBBF8-3EC3-477C-8706-5C6C9AC8B3D4}	*		RegDel<br><br />registryDel74	0	Interface\{D7BB4AED-6D19-4AD5-812C-04CAF2046C90}	*		RegDel<br><br />registryDel75	0	Interface\{DB3E9637-17D2-4E12-8F5C-A9D94E8703C2}	*		RegDel<br><br />registryDel76	0	Interface\{DB7318BB-3098-4AA2-831F-E77AF345D2F3}	*		RegDel<br><br />registryDel77	0	Interface\{E5A1C1F1-4493-41D6-BB44-1C050E702381}	*		RegDel<br><br />registryDel78	0	Interface\{E62D50CB-76B2-4A7C-BBD0-BB2390C26156}	*		RegDel<br><br />registryDel79	0	Interface\{E928AA96-E054-4F71-B3D0-D1F5CE950348}	*		RegDel<br><br />registryDel8	0	CLSID\{B84EDC85-8F87-4D92-A7DF-67AB94F2C528}		*		RegDel<br><br />registryDel80	0	Interface\{E98B3980-F10F-4CB0-9A93-A64CA8883004}	*		RegDel<br><br />registryDel81	0	Interface\{ECEF9E1E-33C3-4AC5-B898-D446A94E6AB4}	*		RegDel<br><br />registryDel82	0	Interface\{F092021C-6233-447A-8BAB-D15C370B162B}	*		RegDel<br><br />registryDel83	0	Interface\{F123F912-E792-4509-82AB-C2A2BF46CEFC}	*		RegDel<br><br />registryDel84	0	Interface\{F3555F81-C076-4394-89F0-A0DA656CF932}	*		RegDel<br><br />registryDel85	0	Interface\{F9AD61BA-AEC0-4217-8311-C0A2ABC3FE7E}	*		RegDel<br><br />registryDel86	0	Interface\{FB6C5D96-A3D2-4DAA-A518-A7164916B005}	*		RegDel<br><br />registryDel87	0	Interface\{FBFBB5AE-3CE2-482B-9CDB-DA67F7078007}	*		RegDel<br><br />registryDel88	0	IPW.ScriptEngine					*		RegDel<br><br />registryDel89	0	IPW.ScriptEngine.1					*		RegDel<br><br />registryDel9	0	CLSID\{FC5F5A61-B28C-4E1C-9528-40B4B40A897B}		*		RegDel<br><br />registryDel90	0	IPW.User						*		RegDel<br><br />registryDel91	0	IPW.User.1						*		RegDel<br><br />registryDel92	0	ISInstallDriver.InstallDriver				*		RegDel<br><br />registryDel93	0	ISInstallDriver.InstallDriver.1				*		RegDel<br><br />registryDel94	0	ISInstallDriver.StringTable				*		RegDel<br><br />registryDel95	0	ISInstallDriver.StringTable.8				*		RegDel<br><br />registryDel96	0	TypeLib\{6F8CDC9E-DB60-4935-A7ED-A7BE8EB2941B}\1.0	*		RegDel<br><br />registryDel97	0	TypeLib\{9795D310-2B39-4E89-B714-C363293FCC6C}\1.0	*		RegDel<br><br />registryDel98	0	TypeLib\{D84D8FFE-80F8-4925-9D20-B5368E07F443}\1.0	*		RegDel<br><br><br />The important column is &Acirc;&#147;Name&Acirc;&#148; containing the value &Acirc;&#147; * &Acirc;&#148;&nbsp; which the Windows Installer SDK explains as follows:<br><br />&Acirc;&#147;The key is to be created, if absent, when the component is installed. Additionally, the key is to be deleted, if present, with all of its values and subkeys, when the component is uninstalled&Acirc;&#148;.<br><br><br />This will ensure that all registry entries are removed on uninstall. Add the following entries to create the &Acirc;&#147;RegDel&Acirc;&#148; component &amp; assign it to a feature.<br><br />Component Table:<br><br><br />Component	ComponentID				Directory	Attributes	Condition	KeyPath<br><br />RegDel		{99F9127C-3ACC-46F5-87B5-9C174EC8B308}	INTEL_32	4		N/A		registryDel<br><br><br />FeatureComponents Table:<br><br />Feature		Component<br><br />ISScript	RegDel<br><br><br />Add the following entry to the InstallExecuteSequence table to remove the duplicate file &Acirc;&#147;IDriver2.exe&Acirc;&#148;.<br><br><br />Action			Condition	Sequence<br><br />RemoveDuplicateFiles	N/A		3400<br><br><br />5. Enabling unattended deployment via SMS (or any similar deployment tool)<br><br />With all the changes that have now been made, the InstallScript MSI will now install &amp; remove cleanly. There is however one further change which needs to be made. If an attempt is made to install an MSI which relies on InstallScript via SMS errors will be encountered. The MSI log usually contains an error such as Error 1603 (A fatal error occurred during installation). The errors are permissions related &amp; occur because the InstallScript DCOM agent launches as the &Acirc;&#147;Interactive User&Acirc;&#148; by default. Thus any of the InstallScript Custom Action commands will launch as 'Interactive User'.<br><br><br />The solution is found under the following registry key:<br><br />HKEY_CLASSES_ROOT\AppID\{1BB3D82F-9803-4d29-B232-1F2F14E52A2E}<br><br><br />By default the registry value 'RunAs' is set to 'Interactive User'. To make the DCOM agent launch as our desired user, &Acirc;&#147;Launching User&Acirc;&#148;, (i.e. the SMS account, which has admin privileges) just delete the 'RunAs' value.<br><br />To do this in our Installscript MSI the following Custom Action was created.<br><br><br />Add the following row to the binary table:<br><br><br />Name				Data<br><br />CallISScript_User_Permissions	[Binary Data]<br><br><br />Navigate to &Acirc;&#147;ISScript_User_Permissions.vbs&Acirc;&#148; (written by Ryan Gray/Chris Kuhl: <a href="http://doctordeploy.com/viewtopic.php?t=93&amp;sid=577ae88fce2a9453ee39146e7cf127c0)">http://doctordeploy.com/viewtopic.php?t=93&amp;sid=577ae88fce2a9453ee39146e7cf127c0</a>) &amp; import the data (vbscript) as binary.<br><br><br />Add the following row to the Custom Action Table.<br><br><br />Action				Type	Source				Target<br><br />ISScript_User_Permissions	6	CallISScript_User_Permissions	N/A<br><br><br />Add the following row to the InstallExecuteSequence table.<br><br><br />Action				Condition	Sequence<br><br />ISScript_User_Permissions	NOT REMOVE	6700<br><br><br />I also modified the ProductCode property and made some company specific changes to the MSI, but that's about it. We now have an MSI which will correctly install ISscript v8.1.0.304 &amp; will uninstall it copletely.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/mosschops" class="username" rel="nofollow">mosschops</a>
            08/05/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-6048"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-6048"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>This comes in the format ISScript8.msi and needs to be installed before deploying some MSI installers in Group Policy.<br><br><br />It's important to use the latest version available. Look at the date of the digital signature to find out what version you have. The latest I could find is the 09 April 2003 and it is available from:<br><br><a href="http://support.installshield.com/kb/view.asp?articleid=Q108527">http://support.installshield.com/kb/view.asp?articleid=Q108527</a><br><br><br />(There is a later version of the file available at InstallShield Q109906, but it actually downgrades one of the files inside, so I wouldn't advise using it)<br><br><br />INSTALLING THROUGH GROUP POLICY<br><br />This installer never actually registers itself properly with Windows Installer and is not really designed for use with Group Policy<br><br><br />If you install it with GP directly, standalone installers that use ISScript will fail with the following error:<br><br><br />1608: Unable to create InstallDriver instance. <br><br />Return code: -2147221164<br><br><br />Also, all of the versions of ISScript (7,8,9,10,11) use the same Product Code which means that more than one version won't install properly in GP<br><br><br />The fix is to create a wrapper which runs the MSI file as a 'concurrent' or 'nested' installation.<br><br />If you want more versions of ISScript installed, you'll need to create a new wrapper for each one.<br><br />NB You can't just copy an old one as you need to have a new Product ID.<br><br><br />See the following for more information:<br><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9841">http://www.appdeploy.com/messageboards/tm.asp?m=9841</a><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9872">http://www.appdeploy.com/messageboards/tm.asp?m=9872</a><br><a href="http://community.installshield.com/showthread.php?t=154647">http://community.installshield.com/showthread.php?t=154647</a><br><br><br />TO CREATE THE WRAPPER<br><br />Copy ISScript8.msi to a folder<br><br />Use WIWW 0.0.0.1 (<a href="http://www.sywan.nl/download/">http://www.sywan.nl/download/</a>)<br><br />&nbsp;Create a new MSI, 'ISScript8 Wrapper.msi', in the same folder<br><br />&nbsp;Add Install Command:<br><br />&nbsp;&nbsp;Property: SourceDir<br><br />&nbsp;&nbsp;Program to run: (Type in) ISScript8.msi<br><br />&nbsp;&nbsp;Parameters: ALLUSERS="[ALLUSERS]"<br><br />&nbsp;&nbsp;DON'T reboot at the end of installation<br><br />&nbsp;Uninstall Command:<br><br />&nbsp;&nbsp;None<br><br />&nbsp;Search for Files:<br><br />&nbsp;&nbsp;None<br><br />&nbsp;Product Details:<br><br />&nbsp;&nbsp;Language: English (United States)<br><br />&nbsp;&nbsp;LEAVE IN Add/Remove Programs (for testing)<br><br />Edit with Orca:<br><br />&nbsp;CustomAction table:<br><br />&nbsp;&nbsp;Drop 'WIWW_InstallCommand1'<br><br />&nbsp;&nbsp;Change 'WIWW_InstallParam1' so that the 'Type' is '23' and the 'Source' is 'ISScript8.msi'<br><br />&nbsp;&nbsp;&nbsp;(The 'Target' should already be 'ALLUSERS="[ALLUSERS]"')<br><br />&nbsp;InstallExecuteSequence table:<br><br />&nbsp;&nbsp;Drop 'WIWW_InstallCommand1'<br><br />&nbsp;&nbsp;Change the 'Condition' for 'WIWW_InstallParam1' to 'NOT REMOVE' (instead of 'Not Installed')<br><br />&nbsp;&nbsp;Change the 'Condition' for 'ResolveSource' to 'NOT REMOVE' (instead of 'Not Installed')<br><br />&nbsp;&nbsp;&nbsp;(This is so that you can do a Group Policy 'Redeploy' if you need to)</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/Minkus" class="username" rel="nofollow">Minkus</a>
            06/07/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-6049"></div>
    <div class="avg-rating">117</div>
     <div class="arrow_down" id="tip-6049"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>v8.1.0.304<br><br><br />After trawling the various app packaging websites I've seen some good points relating to the install of ISscript &amp; lots of workarounds...<br><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9841&amp;mpage=1&amp;key=Atach%2Cinstallscript%2Cengine">Atach installscript engine to one msi via GPO</a><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=9872">Follow up Isscript.msi question</a><br><a href="http://www.appdeploy.com/faq/detail-pf.asp?id=76">Bob Kelly's post at AppDeploy</a><br><a href="http://www.appdeploy.com/messageboards/tm.asp?m=599&amp;mpage=1&amp;key=ISCleanUpFatalExit">Error when deploying with AD</a><br><a href="http://doctordeploy.com/viewtopic.php?t=93&amp;sid=577ae88fce2a9453ee39146e7cf127c0">Orakel's post on DoctorDeploy</a><br><a href="http://community.installshield.com/showthread.php?t=149462&amp;page=3&amp;pp=5">Unattended installation: "Failed to Initialize script support" problems</a><br><a href="http://community.installshield.com/showthread.php?t=154647">Possible isscript error fix</a><br><br><br />...but I haven't seen anyone provide a comprehensive solution to the actual problem, so please allow me to provide a far better solution (IMHO).<br><br><br />This solution is based on <a href="http://support.installshield.com/kb/files/Q108322/ISScript8.zip">ISScript v8.1.0.304</a> but I guess it could be applied to any version of ISscript.msi.<br><br><br />1. Can't use a transform<br><br />It is not possible to create a transform for the original Installshield MSI as is normal practice when modifying software packages which are supplied in the MSI format by third parties. It was necessary to change the package Code for the product to stop any conflicts between the different versions of InstallScript which have all been created with the same package code. If Orca attempts <br><br />to modify the Package Code within a transform the option is greyed out. The reason this is not possible is because the Package Code is part of the summary information stream. The Windows Installer SDK states:<br><br />?A transform can modify information that is in any persistent table in the installer database. A transform can also add or remove persistent tables in the installer database. Transforms cannot modify any part of an installation package that is not in a database table, such as information in the summary information stream, information in substorages, information in nested installations, or files in embedded cabinets?.<br><br><br />It was therefore necessary to modify the original MSI. Open the Installshield ISScript MSI in Orca &amp; save as ?ISScript_v8.1.0.304.Msi?. Create a new Package Code by viewing the Summary Information &amp; generating a new GUID using the ?New GUID? button to the right of the existing GUID<br><br><br />2. Missing ?ISscript.msi? actions<br><br />When an install is performed with Installshield?s original MSI, ?ISscript8.msi?, it does not appear in Add Remove Programs as the property ?ARPSYSTEMCOMPONENT? has been set with a value of ?1?. Removing this property will not result in an MSI which installs correctly. The SDK states:<br><br />?Note:&nbsp;  This only affects the display in the ARP. The Windows Installer is still capable of repairing, installing-on-demand, and uninstalling applications through a command line or the programming interface?. <br><br />&amp; ?To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage an application, leave the registration actions in the sequence tables, and set the ARPSYSTEMCOMPONENT Property in the Property Table to 1 (one). The application does not appear in the Add or Remove Programs feature, but you can use the Windows Installer to install-on-demand, uninstall, repair, and reinstall the application?.<br><br><br />If the ARPSYSTEMCOMPONENT is removed the application still won?t appear in Add/Remove Programs. The clue was in the previous SDK statement: ?leave the registration actions in the sequence tables ?.<br><br><br />As the SDK states:<br><br />?Registration is used by the installer for advertisement and by the Add or Remove Programs feature in Control Panel. If an application is not registered, it cannot be advertised, and is not listed in the Add or Remove Programs feature in Control Panel. You can omit registering an application by removing the RegisterProduct Action, RegisterUser Action, PublishProduct Action, and PublishFeatures Action from the InstallExecuteSequence Table and AdvtExecuteSequence Table. All of these actions must be removed, or some trace of the application may remain in the registry. Removing all of these actions prevents the application from being listed in the Add or Remove Programs feature in Control Panel, and prevents the advertisement of the application. Removing all of these actions also prevents the application from being registered with the Windows Installer configuration data. <br><br><br />This means that you cannot remove, repair, or reinstall the application by using the Windows Installer Command-Line Options, or the Windows Installer application programming interface (API)?.<br><br><br />To ensure that the InstallScript MSI registers itself, add the following rows to the InstallExecuteSequence table.<br><br><br />Action		Condition	Sequence<br><br />PublishFeatures	N/A		6300<br><br />PublishProduct	N/A		6400<br><br />RegisterProduct	N/A		6100<br><br />RegisterUser	N/A		6000<br><br><br />Adding these 4 rows will prevent any ICE82 errors occurring during MSI validation.<br><br><br />If the InstallExecuteSequence table of ?ISscript8.msi? is compared to the standard Wise Windows template it is apparent that there are still more rows in the Wise template. Some of the rows are unimportant but some are vital to ensure InstallScript is installed &amp; removed correctly. Add the following rows too:<br><br><br />Action			Condition	Sequence<br><br />ProcessComponents	N/A		1600<br><br />UnpublishFeatures	N/A		1800<br><br />UnregisterComPlus	N/A		2100<br><br><br />If it is necessary to advertise components the following rows would be added. <br><br><br />Action			Condition	Sequence<br><br />PublishComponents	N/A		6200<br><br />UnpublishComponents	N/A		1700<br><br><br />3. Missing ?ISscript.msi? ComponentIDs<br><br />Even with the important missing actions added the ?ISscript.msi? install will not register its components correctly. This can be proved by using the SDK tool ?MSISPY? to view the installed components for ISScript. MSISPy shows that the app is installed locally but lists no components. The reason this occurs is because the Component table has values missing from the ComponentID column for each component. Without the componentIDs the MSI will not be correctly registered with the Windows Installer configuration data. The SDK states:<br><br />?ComponentId A string GUID unique to this component, version, and language. If this column is null the installer does not register the component and the component cannot be removed or repaired by the installer. This might be intentionally done if the component is only needed during the installation, such as a custom action that cleans up temporary files or removes an old product. It may also be useful when copying data files to a user's computer that do not need to be registered?.<br><br><br />Create a unique ComponentID for each component using the ?Paste New GUID? button.<br><br><br />4. Ensuring uninstall removes all files &amp; registry entries<br><br />With the previous steps included in the MSI it should now install correctly &amp; register all components. It will however still have problems during uninstall. Although no error messages will occur during uninstall the MSI will not be removed from the target PC. <br><br><br />All files will be left behind. To remedy this it is necessary to add the following rows to the RemoveFile Table.<br><br><br />Filekey			Component	FileName			DirProperty	InstallMode<br><br />F1322_ISRT.dll		ISRT.dll	ISRT.dll			INTEL_32	2<br><br />F1324_ISRES.dll		_ISRES.dll	_ISRES~1.DLL|_ISRES1033.dll	INTEL_32	2<br><br />F1319_IDriver.exe	iDriver.exe	iDriver.exe			INTEL_32	2<br><br />F1321_IUser7.dll	iUser.dll	iUser.dll			INTEL_32	2<br><br />F1320_IScript7.dll	iscript.dll	iscript.dll			INTEL_32	2<br><br />F1323_objps7.dll	objectps.dll	objectps.dll			INTEL_32	2<br><br><br />To delete the registry entries on uninstall do not make the mistake of using the RemoveRegistry table as this table is for registry entries which should be deleted when the product is installed. Instead add the following entries to the Registry table.<br><br><br />Registry	Root	Key							Name	Value	Component<br><br />registryDel	2	SOFTWARE\InstallShield\Driver\8				*		RegDel<br><br />registryDel1	0	AppId\IDriver.EXE					*		RegDel<br><br />registryDel10	0	CLSID\{FFD7B771-8ECA-45DE-A944-7B013C6C2DF5}		*		RegDel<br><br />registryDel11	0	Interface\{02C0495A-3F58-4701-9913-7E855178A5D9}	*		RegDel<br><br />registryDel12	0	Interface\{04FAC07A-AD76-4AB8-B993-B597AFC3D947}	*		RegDel<br><br />registryDel13	0	Interface\{093FB88F-A6A3-4999-897F-56F40B4CFCAD}	*		RegDel<br><br />registryDel14	0	Interface\{0E60DA5C-4175-4BD1-89C5-577032A931A0}	*		RegDel<br><br />registryDel15	0	Interface\{124CCD5E-38F2-4DD6-9F47-BF175CE82B41}	*		RegDel<br><br />registryDel16	0	Interface\{1631C530-502B-4BDA-A564-83AF569AF7A9}	*		RegDel<br><br />registryDel17	0	Interface\{1634D100-7F17-4DEE-B79B-6B1AA35BF057}	*		RegDel<br><br />registryDel18	0	Interface\{18889DE5-3E21-4675-8520-64702DB349C1}	*		RegDel<br><br />registryDel19	0	Interface\{1E512A8C-7375-4F79-9260-11B1F476F3A8}	*		RegDel<br><br />registryDel2	0	AppId\IDriver2.exe					*		RegDel<br><br />registryDel20	0	Interface\{257154A2-C292-49AB-9003-D317971F2FF1}	*		RegDel<br><br />registryDel21	0	Interface\{2582B888-6E3A-40D7-BDC8-C0D82A6FD91F}	*		RegDel<br><br />registryDel22	0	Interface\{2CA491F2-DB7D-4A35-88B2-A00961598BB5}	*		RegDel<br><br />registryDel23	0	Interface\{2D939419-6930-40B0-8D36-729D1631D705}	*		RegDel<br><br />registryDel24	0	Interface\{31B499B0-B759-44E2-8A98-5D8CE56CE20F}	*		RegDel<br><br />registryDel25	0	Interface\{33618277-58AF-4F80-A6DD-2716F6146F9A}	*		RegDel<br><br />registryDel26	0	Interface\{34A2F43F-B821-4D14-91EE-39B015B8E66E}	*		RegDel<br><br />registryDel27	0	Interface\{352F743D-092B-4FC5-BABF-BCF5443EBCEA}	*		RegDel<br><br />registryDel28	0	Interface\{3F5F1DF3-D966-46B7-8A49-40D9043064DD}	*		RegDel<br><br />registryDel29	0	Interface\{49C1B167-C294-4C76-91C0-88EBF91E88EE}	*		RegDel<br><br />registryDel3	0	AppId\{1BB3D82F-9803-4d29-B232-1F2F14E52A2E}		*		RegDel<br><br />registryDel30	0	Interface\{4BD7C536-BFD8-41FF-826E-D8CED3178B5B}	*		RegDel<br><br />registryDel31	0	Interface\{4D67F0D9-B58C-4E7A-ADF7-CBE625EE76FB}	*		RegDel<br><br />registryDel32	0	Interface\{5037E6EF-3F8A-4155-B930-6C570449975C}	*		RegDel<br><br />registryDel33	0	Interface\{54915582-84C5-4026-97A0-398A87854CDA}	*		RegDel<br><br />registryDel34	0	Interface\{55E72919-0516-4EFB-AD27-E841798BC170}	*		RegDel<br><br />registryDel35	0	Interface\{573AEDC3-2F32-48F6-8F74-20F004C9D7CB}	*		RegDel<br><br />registryDel36	0	Interface\{5A6D100E-6A54-4EBC-AC92-5904C5C13559}	*		RegDel<br><br />registryDel37	0	Interface\{5FC196B5-34D2-4D23-B59E-4FA93C229564}	*		RegDel<br><br />registryDel38	0	Interface\{663256A7-466C-4023-BD46-4DD6DF8B2F90}	*		RegDel<br><br />registryDel39	0	Interface\{6AF3C35B-B523-4F33-8FCF-19AE3C66FB2F}	*		RegDel<br><br />registryDel4	0	AppId\{C2B96968-8E30-4BA4-A8F9-F40D09D1EA7E}		*		RegDel<br><br />registryDel40	0	Interface\{6E7D9436-492E-4290-A935-7D1A6B0D8BEA}	*		RegDel<br><br />registryDel41	0	Interface\{71CCE912-60B3-4863-9818-315A4B289768}	*		RegDel<br><br />registryDel42	0	Interface\{72B62824-6273-458C-BA83-C90061D3F764}	*		RegDel<br><br />registryDel43	0	Interface\{74C46962-AC20-460E-B824-F8B9A67EB2F2}	*		RegDel<br><br />registryDel44	0	Interface\{7B3B6B6D-9FC7-4CFA-8020-C3AD61B27F55}	*		RegDel<br><br />registryDel45	0	Interface\{8142F6EE-E39A-45F1-962D-9B1BE8630ED1}	*		RegDel<br><br />registryDel46	0	Interface\{84A21E2C-89EE-43EE-B8A7-867AAC3D821D}	*		RegDel<br><br />registryDel47	0	Interface\{8866B471-D0AE-49DC-A18A-47208A74B7D0}	*		RegDel<br><br />registryDel48	0	Interface\{88BBB500-CD36-4B16-A44C-1C97FD37DD3D}	*		RegDel<br><br />registryDel49	0	Interface\{8A77E8D8-AFAF-4FED-A41C-DD40295D606F}	*		RegDel<br><br />registryDel5	0	CLSID\{697DEABA-809C-49FC-ADD1-E9902D88360D}		*		RegDel<br><br />registryDel50	0	Interface\{923DF001-BD30-431A-A889-43D11CF08904}	*		RegDel<br><br />registryDel51	0	Interface\{940E8700-5855-41E9-AD93-EA0B3C6D44A6}	*		RegDel<br><br />registryDel52	0	Interface\{9923E8CC-7323-43FA-B6E3-27371227F89D}	*		RegDel<br><br />registryDel53	0	Interface\{9D85DD57-CCA3-4D7E-AA05-5BC205C2882B}	*		RegDel<br><br />registryDel54	0	Interface\{A1726C4F-5238-4907-B312-A7D3369E084E}	*		RegDel<br><br />registryDel55	0	Interface\{A2B0FEA2-C453-41F7-9E00-EF1F198DDA68}	*		RegDel<br><br />registryDel56	0	Interface\{A4FAB52E-45B1-4A62-A85F-9E20567F5CC6}	*		RegDel<br><br />registryDel57	0	Interface\{A919CEE5-F305-4FF6-B0B3-561C37AEEF7A}	*		RegDel<br><br />registryDel58	0	Interface\{AE8C683F-EC6D-49CD-9B74-A68F8828DEF6}	*		RegDel<br><br />registryDel59	0	Interface\{B27F4061-C6CD-42C4-881E-4D1597D0150F}	*		RegDel<br><br />registryDel6	0	CLSID\{8B1670C8-DC4A-4ED4-974B-81737A23826B}		*		RegDel<br><br />registryDel60	0	Interface\{BAB1BAB2-AD26-42EE-B4FE-B62A7AE96F62}	*		RegDel<br><br />registryDel61	0	Interface\{BD696316-7B37-4850-9D8E-253F47C715AC}	*		RegDel<br><br />registryDel62	0	Interface\{BE0B3F76-166A-4DA5-A97C-318595E3D15C}	*		RegDel<br><br />registryDel63	0	Interface\{C18F0E02-E02F-4402-A8D7-70CABCC01738}	*		RegDel<br><br />registryDel64	0	Interface\{C6A51663-014C-4038-A996-5B98A89B15C4}	*		RegDel<br><br />registryDel65	0	Interface\{C8B06ECF-F4F6-4FDE-AF52-DDC2DC42EC78}	*		RegDel<br><br />registryDel66	0	Interface\{C8B91CC3-8EB9-45DD-974A-76914C156A06}	*		RegDel<br><br />registryDel67	0	Interface\{C8CA19E8-1060-4EA3-86AF-EEE81AD5883A}	*		RegDel<br><br />registryDel68	0	Interface\{C9D3A246-13AD-4CD6-8C3F-ED2BFE13CA72}	*		RegDel<br><br />registryDel69	0	Interface\{CBF70AF9-A780-4527-93FA-0E98699D1415}	*		RegDel<br><br />registryDel7	0	CLSID\{A1726C4F-5238-4907-B312-A7D3369E084E}		*		RegDel<br><br />registryDel70	0	Interface\{CE8C94E9-4ABB-4E72-9D7D-E875AF9E2D72}	*		RegDel<br><br />registryDel71	0	Interface\{CEAAAD86-7088-4CE6-9557-3848C0C585BE}	*		RegDel<br><br />registryDel72	0	Interface\{CEAFB994-EE86-4046-8084-E697AC15B9F6}	*		RegDel<br><br />registryDel73	0	Interface\{D58FBBF8-3EC3-477C-8706-5C6C9AC8B3D4}	*		RegDel<br><br />registryDel74	0	Interface\{D7BB4AED-6D19-4AD5-812C-04CAF2046C90}	*		RegDel<br><br />registryDel75	0	Interface\{DB3E9637-17D2-4E12-8F5C-A9D94E8703C2}	*		RegDel<br><br />registryDel76	0	Interface\{DB7318BB-3098-4AA2-831F-E77AF345D2F3}	*		RegDel<br><br />registryDel77	0	Interface\{E5A1C1F1-4493-41D6-BB44-1C050E702381}	*		RegDel<br><br />registryDel78	0	Interface\{E62D50CB-76B2-4A7C-BBD0-BB2390C26156}	*		RegDel<br><br />registryDel79	0	Interface\{E928AA96-E054-4F71-B3D0-D1F5CE950348}	*		RegDel<br><br />registryDel8	0	CLSID\{B84EDC85-8F87-4D92-A7DF-67AB94F2C528}		*		RegDel<br><br />registryDel80	0	Interface\{E98B3980-F10F-4CB0-9A93-A64CA8883004}	*		RegDel<br><br />registryDel81	0	Interface\{ECEF9E1E-33C3-4AC5-B898-D446A94E6AB4}	*		RegDel<br><br />registryDel82	0	Interface\{F092021C-6233-447A-8BAB-D15C370B162B}	*		RegDel<br><br />registryDel83	0	Interface\{F123F912-E792-4509-82AB-C2A2BF46CEFC}	*		RegDel<br><br />registryDel84	0	Interface\{F3555F81-C076-4394-89F0-A0DA656CF932}	*		RegDel<br><br />registryDel85	0	Interface\{F9AD61BA-AEC0-4217-8311-C0A2ABC3FE7E}	*		RegDel<br><br />registryDel86	0	Interface\{FB6C5D96-A3D2-4DAA-A518-A7164916B005}	*		RegDel<br><br />registryDel87	0	Interface\{FBFBB5AE-3CE2-482B-9CDB-DA67F7078007}	*		RegDel<br><br />registryDel88	0	IPW.ScriptEngine					*		RegDel<br><br />registryDel89	0	IPW.ScriptEngine.1					*		RegDel<br><br />registryDel9	0	CLSID\{FC5F5A61-B28C-4E1C-9528-40B4B40A897B}		*		RegDel<br><br />registryDel90	0	IPW.User						*		RegDel<br><br />registryDel91	0	IPW.User.1						*		RegDel<br><br />registryDel92	0	ISInstallDriver.InstallDriver				*		RegDel<br><br />registryDel93	0	ISInstallDriver.InstallDriver.1				*		RegDel<br><br />registryDel94	0	ISInstallDriver.StringTable				*		RegDel<br><br />registryDel95	0	ISInstallDriver.StringTable.8				*		RegDel<br><br />registryDel96	0	TypeLib\{6F8CDC9E-DB60-4935-A7ED-A7BE8EB2941B}\1.0	*		RegDel<br><br />registryDel97	0	TypeLib\{9795D310-2B39-4E89-B714-C363293FCC6C}\1.0	*		RegDel<br><br />registryDel98	0	TypeLib\{D84D8FFE-80F8-4925-9D20-B5368E07F443}\1.0	*		RegDel<br><br><br />The important column is ?Name? containing the value ? * ?&nbsp; which the Windows Installer SDK explains as follows:<br><br />?The key is to be created, if absent, when the component is installed. Additionally, the key is to be deleted, if present, with all of its values and subkeys, when the component is uninstalled?.<br><br><br />This will ensure that all registry entries are removed on uninstall. Add the following entries to create the ?RegDel? component &amp; assign it to a feature.<br><br />Component Table:<br><br><br />Component	ComponentID				Directory	Attributes	Condition	KeyPath<br><br />RegDel		{99F9127C-3ACC-46F5-87B5-9C174EC8B308}	INTEL_32	4		N/A		registryDel<br><br><br />FeatureComponents Table:<br><br />Feature		Component<br><br />ISScript	RegDel<br><br><br />Add the following entry to the InstallExecuteSequence table to remove the duplicate file ?IDriver2.exe?.<br><br><br />Action			Condition	Sequence<br><br />RemoveDuplicateFiles	N/A		3400<br><br><br />5. Enabling unattended deployment via SMS (or any similar deployment tool)<br><br />With all the changes that have now been made, the InstallScript MSI will now install &amp; remove cleanly. There is however one further change which needs to be made. If an attempt is made to install an MSI which relies on InstallScript via SMS errors will be encountered. The MSI log usually contains an error such as Error 1603 (A fatal error occurred during installation). The errors are permissions related &amp; occur because the InstallScript DCOM agent launches as the ?Interactive User? by default. Thus any of the InstallScript Custom Action commands will launch as 'Interactive User'.<br><br><br />The solution is found under the following registry key:<br><br />HKEY_CLASSES_ROOT\AppID\{1BB3D82F-9803-4d29-B232-1F2F14E52A2E}<br><br><br />By default the registry value 'RunAs' is set to 'Interactive User'. To make the DCOM agent launch as our desired user, ?Launching User?, (i.e. the SMS account, which has admin privileges) just delete the 'RunAs' value.<br><br />To do this in our Installscript MSI the following Custom Action was created.<br><br><br />Add the following row to the binary table:<br><br><br />Name				Data<br><br />CallISScript_User_Permissions	[Binary Data]<br><br><br />Navigate to ?ISScript_User_Permissions.vbs? (written by Ryan Gray/Chris Kuhl: <a href="http://doctordeploy.com/viewtopic.php?t=93&amp;sid=577ae88fce2a9453ee39146e7cf127c0)">http://doctordeploy.com/viewtopic.php?t=93&amp;sid=577ae88fce2a9453ee39146e7cf127c0</a>) &amp; import the data (vbscript) as binary.<br><br><br />Add the following row to the Custom Action Table.<br><br><br />Action				Type	Source				Target<br><br />ISScript_User_Permissions	6	CallISScript_User_Permissions	N/A<br><br><br />Add the following row to the InstallExecuteSequence table.<br><br><br />Action				Condition	Sequence<br><br />ISScript_User_Permissions	NOT REMOVE	6700<br><br><br />I also modified the ProductCode property and made some company specific changes to the MSI, but that's about it. We now have an MSI which will correctly install ISscript v8.1.0.304 &amp; will uninstall it copletely.</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/mosschops" class="username" rel="nofollow">mosschops</a>
            08/05/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3098"></div>
    <div class="avg-rating">116</div>
     <div class="arrow_down" id="tip-3098"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <a href="http://forum.installsite.net/index.php?s=3832d00f1d44d1d51652b1dfd5b9e2ea&amp;showtopic=15254">I've just read a news item on InstallSite by Stefan Krueger &amp; thought it was relevant to this post</a><br><br><a href="http://blogs.msdn.com/windows_installer_team/archive/2006/05/12/595950.aspx">the Windows Installer team advise against nested installs</a><br><br><br><br><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/mosschops" class="username" rel="nofollow">mosschops</a>
            08/07/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
<div class="tip">
    <div class="tip-part">
        <div class="tip-rating">

                

    
<div class="incrementalRating">
     <div class="arrow_up" id="tip-3096"></div>
    <div class="avg-rating">3</div>
     <div class="arrow_down" id="tip-3096"></div>
</div>            </div>
        <div class="tip-info">
    <div class="the-tip">
                    <p>Just something to add to this...&nbsp; We tried to package ISScript9 using the same instructions, and all went well. But for some reason our XP computers weren't installing the software until they rebooted 3 times.&nbsp; Errors were shown in the event log on the 1st and 2nd reboots.&nbsp; It is because XP enables "Fast Logon Optimization" on a domain.&nbsp; I won't go into how and why, but I will tell you that 2000 clients and 2003 servers do not enable this, and thus install on the first reboot.&nbsp; If you wish to learn about more about fast logon optimization, and how to disable it through group policy, you can check the following microsoft site:<br><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/policy/policy/logon_optimization.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/policy/policy/logon_optimization.asp</a><br><br><br />After disabling this on our domain, even the XP computers installed ISScript9 without any problems.&nbsp; Good luck!</p><br />
        
        <div class="byline">
            <span class="commentslabel collapsed-comments">Show Comments</span> |
            <a href="/user/scottjwoodford" class="username" rel="nofollow">scottjwoodford</a>
            07/08/2006 |
                                </div>
    </div>

</div>
    </div>
    <br clear="all"/>
    <div class="deployment-tips-comments">

        <ul class="comments">
</ul>
            Please <a href="https://www.itninja.com/login?http%3A%2F%2Fwww.itninja.com%2Fsoftware%2Fmacrovision%2Finstallscript-engine%2F8-1162">log in</a> to comment

    </div>
</div>
                        </div>
                        <div id="software-tag-view-tab-command-line" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>
                        </div>
                        <div id="software-tag-view-tab-script" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>

                        </div>
                        <div id="software-tag-view-tab-securityinfo" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>
                        </div>
                        <div id="software-tag-view-tab-terminal" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>
                        </div>
                        <div id="software-tag-view-tab-virtualization" class="tabs-hide">
                            <div class="tip">
    <p>No deployment tips yet. Be the first to add one!</p>
</div>
                        </div>

                    </div>


                    
                </div>

                <div id="deploy-bottom">

                    
                </div>

            </div>

        </div>

    </div>
    <!-- end Deployment Tips -->

    <div class="software-section" id="inventory-records">

        <h2 class="section-title"><a href="#" class="plus toggle"></a> Inventory Records (1)</h2>
        <p>View inventory records anonymously contributed by opt-in users of the
            <a href="http://www.kace.com/demo/index.php?tab=flash-demo&utm_medium=ITNinja&utm_source=Software+Tag&ad_group=%20Package+KB+v2&campaign_id=701400000009kH1">
                K1000 Systems Management Appliance</a>.
        </p>

        <div class="inner-content">

            <div class="inner">

                <div id="software-view-version-revision-list">
                    <div class="title">Versions</div>
                                        <div><a class="selected" href="/software/version/revision/39554/83390">8</a></div>
                                    </div>
                <div id="software-view-version-revision-details">
                                                <h2>InstallScript Engine</h2>
            <div><h3>Version</h3><span>8</span></div>
                                                                                                                                        </div>
                <br class="clear"/>
            </div>

        </div>

    </div>
    <!-- end inventory records secion -->

    <div class="software-section" id="q-a">
        <div class="add-links">
               <a href="/question/new/macrovision-installscript-engine-8" class="add-tip">Ask a new question</a>
        </div>
        <h2 class="section-title"><a href="#" class="plus toggle"></a> Questions & Answers (0)</h2>
        <p>Questions & Answers related to Macrovision InstallScript Engine</p>
        <div class="inner-content">

            <div class="inner">

                                
            </div>

        </div>
    </div>
    <!-- end Q & A secion -->

    <div class="software-section" id="blogs">
        <div class="add-links">
            <a href="/blog/post/new/macrovision-installscript-engine-8" class="add-tip">Write a blog post</a>
        </div>
        <h2 class="section-title"><a href="#" class="plus toggle"></a> Blogs (0)</h2>
        <p>Blog posts related to Macrovision InstallScript Engine</p>
        <div class="inner-content">

            <div class="inner">

                                
            </div>

        </div>
    </div>
    <!-- end Blogs secion -->

    <div class="software-section" id="links">
        <div class="add-links">
            <a href="/link/new/macrovision-installscript-engine-8" class="add-tip">Share a link</a>
        </div>
        <h2 class="section-title"><a href="#" class="plus toggle"></a> Links (2)</h2>
        <p>Links related to Macrovision InstallScript Engine</p>
        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">
    <div class="content-icon">
        <div class="link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">
        <h2 class="content-title">

            <a href="/link/flexera-software-knowledge-base">
                Flexera Software - Knowledge Base
            </a>

        </h2>

        <div class="content-lower-light">

            <div class="content-rating-light"><div class="rating">
    <input name="flexera-software-knowledge-base" type="radio" class="star" disabled="disabled"  />
    <input name="flexera-software-knowledge-base" type="radio" class="star" disabled="disabled"  />
    <input name="flexera-software-knowledge-base" type="radio" class="star" disabled="disabled"  />
    <input name="flexera-software-knowledge-base" type="radio" class="star" disabled="disabled"  />
    <input name="flexera-software-knowledge-base" type="radio" class="star" disabled="disabled"  />
</div></div>
            <div class="op-light">
                By:
                <a href="/user/Minkus" rel="nofollow">Minkus</a>
                6 years ago
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-icon">
        <div class="link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">
        <h2 class="content-title">

            <a href="/link/installshield-installations">
                InstallShield Installations
            </a>

        </h2>

        <div class="content-lower-light">

            <div class="content-rating-light"><div class="rating">
    <input name="installshield-installations" type="radio" class="star" disabled="disabled"  />
    <input name="installshield-installations" type="radio" class="star" disabled="disabled"  />
    <input name="installshield-installations" type="radio" class="star" disabled="disabled"  />
    <input name="installshield-installations" type="radio" class="star" disabled="disabled"  />
    <input name="installshield-installations" type="radio" class="star" disabled="disabled"  />
</div></div>
            <div class="op-light">
                By:
                <a href="/user/C_Denninger" rel="nofollow">C_Denninger</a>
                6 years ago
            </div>

        </div>

    </div>

</div>                                
            </div>

        </div>
    </div>
    <!-- end links secion -->
    











</div>
            <div class="clear">&nbsp;</div>
        </div>
        <footer>
                        <div id="footer-nav">
                <div>
                    <strong>Home Pages</strong>
                    <ul>
                        <li><a href="/software">Software</a></li>
                        <li><a href="/tips">Deployment Tips</a></li>
                        <li><a href="/question">Questions</a></li>
                        <li><a href="/blog">Blog Posts</a></li>
                        <li><a href="/link">Shared Links</a></li>
                    </ul>
                </div>
                <div>
                   <strong>FAQ &amp; Support</strong>
                   <ul>
                       <li><a href="/faq">Site FAQ</a></li>
                       <!--<li><a href="/faq/beta">Beta FAQ</a></li>-->
                       <li><a href="/faq#PointsFAQ">Ninja Points FAQ</a></li>
                       <li><a href="/faq#ADFAQ">AppDeploy FAQ</a></li>
                       <li><a href="/kace">Dell KACE Support</a></li>
                   </ul>
               </div>
                <div>
                    <strong>About</strong>
                    <ul>
                        <li><a href="/about">ITNinja</a></li>
                        <li><a href="/about">Welcome Video</a></li>
                        <li><a href="/tour">Tour</a></li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </div>
                <div class="share">
                    <strong>Share/Contribute</strong>
                    <ul class="share-list">
                        <li><a href="http://www.facebook.com/pages/ITNinja/128951133849867"><img src="/bundles/itninjaweb/img/facebook.png" alt="Facebook"></a></li>
                        <li><a href="http://twitter.com/ITNinjaSite"><img src="/bundles/itninjaweb/img/twitter.png" alt="Twitter"></a></li>
                                            </ul>
                </div>
            </div>
        <br clear="all"/>
        <br clear="all"/>
            <div id="footer-links">
                <p>&copy; Dell Inc. All rights reserved.</p>
                <ul>
                    <li><a href="/legal">Legal</a></li>
                    <li><a href="/about" class="last">About</a></li>
                </ul>
                <p id="footer-logos">
                    <a href="http://www.kace.com/about/index.php?utm_medium=ITNinja&utm_source=Page+Footer&ad_group=ITNinja&campaign_id=701400000009kH1"><img src="/bundles/itninjaweb/img/DellKace_logo.png" alt="Dell | Kace" /></a>
                </p>
                <div id="version"><span id="revision">0cb8058</span><span id="build-date">Tue Nov 20 11:20:29 EST 2012</span>
ninjaweb02<span id="server">www.itninja.com</span></div>
            </div>
        </footer>
        <!--[if lte IE 7 ]>
            <script src="/bundles/itninjaweb/js/plugins/jquery.pngFix.pack.js"></script>
        <![endif]-->
        <script src="/js/c7062e8.js"></script>
        
        
        <script src="/js/0c271c0.js"></script>
<script>
// has to be in here for the asset parameters to get rendered by twig
    $(function(){

        $('.toggle').click(function(e){
            e.preventDefault();
            $(this).toggleClass('minus');
            var content = $(this).parents('.software-section').children('.inner-content');

            if (!$(content).is(':animated')){
                $(content).toggle('fast');
            }

        });

        $('#scrollQA').click(function(){
            $('html,body').animate({scrollTop: $('#q-a').offset().top},'slow');
        });
        $('#scrollBlog').click(function(){
            $('html,body').animate({scrollTop: $('#blogs').offset().top},'slow');
        });
        $('#scrollInv').click(function(){
            $('html,body').animate({scrollTop: $('#inventory-records').offset().top},'slow');
        });
        $('#scrollLinks').click(function(){
            $('html,body').animate({scrollTop: $('#links').offset().top},'slow');
        });
        $('.top').click(function(){
            $('html,body').animate({scrollTop: $('#global-content').offset().top},'slow');
        });

        var list = $('#version-list');

        $('#version-changer').live("click", function(){

            if (list.hasClass('show')){

            } else {
                $("body").addClass('menu-open');
                list.addClass('show');
            }
        });
        $("body.menu-open").live("click", function(){
            list.removeClass('show');
            $("body").removeClass('menu-open');
        });

        $('#software-view-version-revision-list a').click( function(evt) {
            $("#software-view-version-revision-list a").removeClass('selected');
            $(this).addClass('selected');
            evt.preventDefault();
            $.get($(this).attr('href'), function(data) {
                $("#software-view-version-revision-details").html(data);
            });
        });


        $.get("/software/version/deployment_ratings/39554", function(data) {
              $("#deployment-ratings-summary").html(data);
              ratings.init();
        });



});
</script>
            <!--[if lt IE 9]>
            <script src="/js/211a076.js"></script>        <![endif]-->
                    <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-26553848-1']);
                _gaq.push(['_trackPageview']);

                (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();
            </script>
                            <script type="text/javascript">
              var uvOptions = {};
              (function() {
                var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
                uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/1cft4y4FWQ7YXJ6BaxBYQ.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
              })();
            </script>
            <script type="text/javascript">if(!NREUMQ.f){NREUMQ.f=function(){NREUMQ.push(["load",new Date().getTime()]);var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="https://d1ros97qkrwjf5.cloudfront.net/42/eum/rum.js";document.body.appendChild(e);if(NREUMQ.a)NREUMQ.a();};NREUMQ.a=window.onload;window.onload=NREUMQ.f;};NREUMQ.push(["nrf2","beacon-1.newrelic.com","fa2fb87fc4",520511,"b1BUNhNQC0dUWkANC1YaYxAIHgRERRdEDBQ=",0,191,new Date().getTime()]);</script>
</body>
</html>