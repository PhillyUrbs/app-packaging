<!doctype html>
<html>
    <head>
        <meta charset="utf-8"><script type='text/javascript'>window.mod_pagespeed_start = Number(new Date());</script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script>
        <title>IT Pro Tips for Microsoft Azure P2S VPN Client (Non Admin) 1 | ITNinja</title>
        <meta name="description" content="Deployment tips, questions, blogs and other technical materials related to Microsoft Azure P2S VPN Client (Non Admin) 1">
        <meta name="keywords" content="Microsoft,Microsoft Azure P2S VPN Client (Non Admin),Azure P2S VPN Client (Non Admin) 1">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="yMY423DZduMGIsTKJnJbRzr_qC4FUxtEhXxtuGftSGw"/>
        <link rel="shortcut icon" href="/bundles/itninjaweb/img/favicon.ico">
        <link rel="apple-touch-icon" href="/bundles/itninjaweb/img/xapple-touch-icon.png.pagespeed.ic.AvVF0T_Kij.png">
	<link rel="canonical" href="http://www.itninja.com/software/microsoft/azure-p2s-vpn-client-non-admin/1-16669/windows"/>


        <!--
         * Quest Software Inc. PROPRIETARY INFORMATION
         *
         * This software is confidential.  Quest Software Inc., or one of its subsidiaries, has
         * supplied this software to you under the terms of a license agreement,
         * nondisclosure agreement or both.  You may not copy, disclose, or use this
         * software except in accordance with those terms.
         *
         * Copyright 2017 Quest Software Inc..  All Rights Reserved.
         *
         * Quest Software Inc. MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF
         * THE SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
         * IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
         * OR NON-INFRINGEMENT. Quest Software Inc. SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY
         * LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR
         * ITS DERIVATIVES.
         *
        -->

        <link href="/bs-compiled.css" rel="stylesheet/less" type="text/css"/>
        
        <link href="/A.bs-compiled.css.pagespeed.cf.mChbqPpX7S.css" rel="stylesheet" type="text/css"/>

        <link rel="stylesheet" type="text/css" media="screen" href="/css/A.a6a67e0.css.pagespeed.cf.q1DtoCGvd5.css"/>
        
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" media="screen" href="/css/A.f4e8db9.css.pagespeed.cf._oV2MhGLD1.css"/>
        <!--[if lt IE 9]>
            <script src="/js/ede9468.js"></script>        <![endif]-->

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script>
        <script type="text/javascript">var Itninja={};Itninja.isIe8=false;window.jQuery||document.write("<script src='/bundles/itninjaweb/js/jquery-1.10.2.min.js'>\x3C/script>");var TAG_SERVER='tags.itninja.com',TAG_AUTO_SUGGEST_ENABLE='1'==='1'?true:false,TAG_SHOW_ADD_NEW=false,TAG_USER_ID=0;if(!$.support.leadingWhitespace){$(function(){showNotificationBar('Incompatible Browser Detected. We recommend switching to another browser while using this site. <a href="/browser-incompatible" rel="nofollow">Click here for more details</a>');});}</script>
                    </head>
    <body>
        <div class="container">

            <p id="kace-link">&nbsp;</p>

            <div id="top" class="content-row">
                <div class="md-12">
                    <div id="logo"><a href="/">
                        <img src="/bundles/itninjaweb/img/221x75xITN_logo_no_AD.png.pagespeed.ic.ygkSqJQslZ.png" alt="ITNinja Home" width="221" height="75"/></a>
                                            </div>

                    <nav class="navbar navbar-link" role="navigation" id="top-nav">

    <div>
        <ul class="nav navbar-nav navbar-right">

                        <li><a href="/login" class="button">Log in</a></li>
            <li class="last"><a href="/register" class="register"><strong>Sign up!</strong></a></li>
            
        </ul>
    </div>
</nav>
                </div>
            </div>
            <div class="content-row">
                <div class="md-12">
                    <nav class="navbar navbar-inverse" role="navigation" id="main-nav">

    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-nav-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
    </div>


    <div class="collapse navbar-collapse" id="main-nav-collapse">

        <ul class="nav navbar-nav navbar-left">
        <li class="active first">    <a href="/software">Software Tips</a>        
</li>

    <li>    <a href="/question">Questions</a>        
</li>

    <li>    <a href="/blog">Blogs</a>        
</li>

    <li>    <a href="/link">Links</a>        
</li>

    <li class="last">    <a href="/community">Communities</a>        
</li>


</ul>


        <div class="navbar-search pull-right">
        <form class="navbar-form navbar-right" role="search" action="/search" id="nav-search">

            <div class="input-group">

                <input type="text" name="q" placeholder="search" class="form-control"/>
                <span class="input-group-btn">
                    <button class="btn btn-itn" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                </span>

            </div>

        </form>
        </div>
    </div>
</nav>
                 </div>
            </div>


                            <ul id="breadcrumbs" class="breadcrumb">
                    <li class="home"><a href="/">
                        <img src="/bundles/itninjaweb/img/xBreadcrumb_cap.png.pagespeed.ic.PYZOZjr0P5.png"/></a></li>
                        <li><a href="/software/browse?Popular=1">Software</a></li>
    <li><a href="/software/microsoft/browse">Microsoft</a></li>
    <li><a href="/software/microsoft/azure-p2s-vpn-client-non-admin/versions">Azure P2S VPN Client (Non Admin)</a></li>
    <li>1</li>
                </ul>
            
            <div id="widget-notice" class="flash-wrap">
            </div>

            
<div class="itn-content">

    <div class="content-row">

        <div id="software-version-view-meta" class="md-8">
                <h2>Microsoft Azure P2S VPN Client (Non Admin)</h2>

                <div id="version-wrapper">

                    <span class="version-name" id="version-changer">
                        Version: 1
                        <div id="version-list">
                            <div class="version-list-top"></div>
                            <ul id="version-list-items" class="version-list">
                                                                    <li>
                                        <a href="/software/microsoft/azure-p2s-vpn-client-non-admin/1-16669">
                                            1.x <span>(1 tips) </span>
                                        </a>
                                    </li>
                                                            </ul>
                        </div>
                    </span>

                    
                </div>

            </div>

        


    <section id="widget-signup" class="signup-widget">

    <h4>Don't be a Stranger!</h4>

    <p>Sign up today to participate,
        stay informed, earn points and establish a reputation for yourself!</p>

    <a class="btn-follow btn" rel="nofollow" href="/register?/follow/version/64574/JTJGc29mdHdhcmUlMkZtaWNyb3NvZnQlMkZhenVyZS1wMnMtdnBuLWNsaWVudC1ub24tYWRtaW4lMkYxLTE2NjY5JTJGd2luZG93cw==">
        <span> Sign up!</span>
    </a>
    or
    <a class="" rel="nofollow" href="/login?/follow/version/64574/JTJGc29mdHdhcmUlMkZtaWNyb3NvZnQlMkZhenVyZS1wMnMtdnBuLWNsaWVudC1ub24tYWRtaW4lMkYxLTE2NjY5JTJGd2luZG93cw==">
        login
    </a>
</section>



            <div class="tr-meta" title="Average rating 0 based on 0 votes">
                
<div id="widget-software-byline" class="pull-right">
    Views: 1.5k &nbsp|&nbsp
    Created: 09/01/2016
    
            by: <a href="/user/bongobot" rel="nofollow">bongobot</a>

    
</div><br>

<div id="widget-software-byline-stars" class="stars-wrap">

    <div id="scale-rating" class="rating">
    <input name="Version64574" type="radio" class="star" disabled="disabled"/>
    <input name="Version64574" type="radio" class="star" disabled="disabled"/>
    <input name="Version64574" type="radio" class="star" disabled="disabled"/>
    <input name="Version64574" type="radio" class="star" disabled="disabled"/>
    <input name="Version64574" type="radio" class="star" disabled="disabled"/>
</div></div>
<div id="widget-software-byline-rating" class="pull-right"> Average Rating: <span id="average-rating">0</span></div>
            </div>


        <!--end header-->

    </div>


    <div class="content-row">

            </div>


        

    <div class="content-row">

        <div class="md-12">
            

<div id="widget-tags" class="tags-wrap">
    </div>
            
        </div>


        <div id="software-version-view-add-version-meta-additional" class="additional-meta md-12">
            <div class="additional-meta-content callout-box">
                <span class="glyphicon glyphicon-info-sign"></span>
                Azure P2S VPN Client (Non Admin) has <a href="#inventory-records" id="scrollInv">1 inventory records</a>,
                <a href="#q-a" id="scrollQA">0 Questions</a>,
                <a href="#blogs" id="scrollBlog">0 Blogs</a>
                and <a href="#links" id="scrollLinks">0 links</a>. Please help add to this by sharing more!
            </div>
        </div>

    </div>


    <div id="deployment-tips" class="software-section">

        <div class="callout-box2">
            <h3>
                <a href="#" class="plus toggle minus"></a> Deployment Tips (1)
                            </h3>



        </div>


                <div class="inner-content" id="deploy-div">

            <div id="deployment-ratings-summary" class="inner">

                    <div class="meta">
                        <strong>Most Common Setup Type</strong>
                        <div>
                            Legacy Setup with command line support
                        </div>
                    </div>
                    <div class="meta meta-middle">
                        <strong>Average Package Difficulty Rating</strong>
                        <img src="/bundles/itninjaweb/img/difficulty/xorange.png.pagespeed.ic.19QBfoEcc5.png" class="img-responsive"/>
                        <div class="rating-text">
                            Rated <strong>4 / 5 (Somewhat Difficult)</strong>
                            based on <strong>1</strong> ratings
                        </div>
                    </div>
                    <div class="meta">
                        <strong>Most Commonly Reported Deployment Method</strong>
                        <div>
                            Repackaged (to a proprietary Format)
                        </div>
                    </div>

            </div>

            <!-- end rating section -->
            
                                                        

            <div id="software-view-deployment-summary-form">
                
<form name="tip_summary" role="form" method="post" action="/version/summary/new/64574" novalidate="novalidate">

<div class="form-group"><label for="tip_summary_text" class="required">Enter your tip</label><textarea id="tip_summary_text" name="tip_summary[text]" required="required" class="form-control"></textarea></div>
<div class="input-group">
<button type="button" id="tip_summary_submit" name="tip_summary[submit]" class="btn btn-itn" class="btn btn-itn">Submit</button>
<span class="or-cancel">
           or
       <a class="tip_summary_cancel">cancel</a>
       </span>
   </div>
<input type="hidden" id="tip_summary__token" name="tip_summary[_token]" value="d210d9c5b758d76e0947db0ecb1d924112f48a29" class="form-control"/>

</form>

            </div>


            <ul class="nav nav-tabs" id="tips">

                    <li>
                        <a href="/software/microsoft/azure-p2s-vpn-client-non-admin/1-16669#tips">
                            All Tips
                        </a>
                    </li>
                                           <li class="active"><a href="/software/microsoft/azure-p2s-vpn-client-non-admin/1-16669/windows#tips">
                               Windows Tips
                            </a>
                       </li>
                                    </ul>

            </ul>

                    <div id="software-version-tips" class="inner">

                
    <div>
        
    
        <div class="tip" id="tip_8419" name="tip_8419">

            <div class="md-1">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-8419"></div> -->
   <div id="tip-8419" class="thumbs_up" style="text-align: center; width: 28px" ;><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-up"></span></button></div>
    <div class="avg-rating">0</div>
   <div id="tip-8419" class="thumbs_down" style="text-align: center; width:28px; margin-top: 28px;" ;><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-down"></span></button></div>
   <!--<div class="arrow_down" id="tip-8419"></div> -->
</div>
            </div>

            <div class="md-11">
    <div class="the-tip">
        <div class="tip-type-heading">Script</div>

            <span id="tip-text">
            <p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;">1.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">     </span></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"><span>      The Azure P2S (Point to Site) VPN Client Traditionally installs per user and requires administrative rights to install. This means that in order to use the P2S VPN users must have local admin rights on their workstations, which is not possible in most enterprise environments. This guide provides a method for deploying the Azure P2S VPN client without the need for User local admin rights, it is installed with admin rights on the computer and is able to be used by all users on the workstation (assuming they have a valid user certificate as per standard Azure P2S configuration). This solution works with SCCM and other deployment mechanisms and is perfectly suitible for clients connecting into a DR environment in Azure Site recovery. I was not able to find another solution to this at the time of posting so i hope this will be of some help. <br/></span></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"><span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">Th</span></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"><span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';"><br/></span></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"><span style="text-indent:-18pt;font-size:7pt;line-height:normal;font-family:'Times New Roman';">         </span><span style="text-indent:-18pt;line-height:1.42857;">1. Download VPN client from Azure</span><br/></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"></p><p></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"><img src="/uploads/images/133152/294xNxxLIczn.jpeg.pagespeed.ic.XJS7FzO1qZ.jpg" style="width:294px;" alt="xLIczn.jpeg"/><br/></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">2.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">2. </span><span style="text-indent:-18pt;line-height:1.42857;">Extract the package using the following command {guid}.exe
/T:{Path to Extract Folder} /C</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"><span style="text-indent:-18pt;line-height:1.42857;"><img src="/uploads/images/133152/500xNxzRYcHJ.jpeg.pagespeed.ic.9fYs5y2Tyg.jpg" style="width:500px;" alt="zRYcHJ.jpeg"/><br/></span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">3.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">3. </span><span style="text-indent:-18pt;line-height:1.42857;">Find the {guid}.pbk file -&gt; right click -&gt;
edit in notepad</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">4.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">4. </span><span style="text-indent:-18pt;line-height:1.42857;">Go through the PBK file until you find an entry
called “PhoneNumber=”, the string after this is the URL your VPN will connect
to. Record this URL for later use</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"><span style="text-indent:-18pt;line-height:1.42857;">       <img src="/uploads/images/133152/XtnNGm.png" style="width:500px;" alt="XtnNGm.png"/><br/></span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">5.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">      </span><span style="line-height:1.42857;">5.</span><span style="text-indent:-18pt;font-size:7pt;line-height:normal;font-family:'Times New Roman';"> </span><span style="text-indent:-18pt;line-height:1.42857;">In the extracted folder locate the {guid}.cer
certificate file and copy it to a new folder where the package will be built.</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">6.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">6.</span><span style="text-indent:-18pt;line-height:1.42857;">Now you need to get the thumbprint of the
certificate file. Double click on the {guid}.cer file  to bring up the certificate properties and Navigate
to the details tab</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"><span style="text-indent:-18pt;line-height:1.42857;">       <img src="/uploads/images/133152/4zxZEM.jpeg" style="width:292px;" alt="4zxZEM.jpeg"/><br/></span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"><span style="text-indent:-18pt;line-height:1.42857;"><br/></span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">7.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">7. </span><span style="text-indent:-18pt;line-height:1.42857;">In the “Show” drop down box select “Properties
Only” and highlight the Thumbprint item        .</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">8.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">8. </span><span style="text-indent:-18pt;line-height:1.42857;">Select the thumbrint in the bottom section and copy and paste
the string to notepad</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"><span style="text-indent:-18pt;line-height:1.42857;">        <img src="/uploads/images/133152/CnCRAd.jpeg" style="width:290px;" alt="CnCRAd.jpeg"/><br/></span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;">9.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">       </span><span style="line-height:1.42857;">9. </span><span style="text-indent:-18pt;line-height:1.42857;">In notepad remove all the spaces from the
thumbprint string and record the modified string for future use</span></p><p class="MsoListParagraphCxSpMiddle" style="text-indent:-18pt;"></p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p> <img src="/uploads/images/133152/qbnRgr.jpeg" style="width:500px;" alt="qbnRgr.jpeg"/></p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-18pt;">1   <span style="line-height:1.42857;">10.</span><span style="text-indent:-18pt;font-size:7pt;line-height:normal;font-family:'Times New Roman';">   </span><span style="text-indent:-18pt;line-height:1.42857;">Create a new Powershell script  in the same packaging folder as the
certificate and copy and paste the below code into the script:</span></p><p class="MsoListParagraphCxSpLast" style="text-indent:-18pt;"></p><p></p>

<p class="MsoNormal" style="margin-left:18pt;"></p><p> </p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">#Define These Properties</span><span style="font-size:9pt;font-family:'Lucida Console';"></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$certificatefile</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span>"&lt;name of
certificate file here&gt;"</span> </span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$vpnurl</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span>"&lt;vpn url from pbk PhoneNumber&gt;"</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$Thumbprint</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span>"&lt;Certificate
Thumbprint without spaces&gt;"</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$connectionName</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span>"&lt;display
Name for your VPN connection&gt;"</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';"></span></p><p> </p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';"></span></p><p> </p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$dir</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span style="color:#0000FF;">Split-Path</span> (<span>$MyInvocation</span><span>.</span>MyCommand<span>.</span>Path)</span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$connections</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span style="color:#0000FF;">Get-VpnConnection</span>
<span style="color:#000080;">-AllUserConnection</span> </span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">$connectionexists</span><span style="font-size:9pt;font-family:'Lucida Console';"> <span>=</span> <span>$false</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">if</span><span style="font-size:9pt;font-family:'Lucida Console';"> (<span>!</span>(<span style="color:#0000FF;">Test-Path</span> <span>"Cert:\LocalMachine\root\</span><span>$thumbprint</span><span>"</span>))
{ </span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';"> <span style="color:#0000FF;">Start-Process</span> <span>"certutil.exe"</span> <span style="color:#000080;">-ArgumentList</span>
<span>"-addstore root `"</span><span>$dir</span><span>\</span><span>$certificateFile</span><span>`""</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">}</span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">foreach</span><span style="font-size:9pt;font-family:'Lucida Console';"> (<span>$connection</span>
<span>in</span> <span>$connections</span>)
{ </span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">    <span>if</span> (<span>$connection</span><span>.</span>Name
<span>-eq</span> <span>$connectionName</span>)
{ </span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">        <span>$connectionexists</span>
<span>=</span> <span>$true</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">    }</span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">}
</span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">if</span><span style="font-size:9pt;font-family:'Lucida Console';"> (<span>$connectionexists</span>
<span>-eq</span> <span>$false</span>)
{ </span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">    <span>$EAP</span> <span>=</span> <span style="color:#0000FF;">New-EapConfiguration</span>
<span style="color:#000080;">-verifyServerIdentity</span> <span style="color:#000080;">-UserCertificate</span>
<span style="color:#000080;">-Tls</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">    <span style="color:#0000FF;">Add-VpnConnection</span>
<span style="color:#000080;">-Name</span> <span>$connectionName</span>
<span style="color:#000080;">-ServerAddress</span> <span>$vpnurl</span>
<span style="color:#000080;">-TunnelType</span> <span>SSTP</span>
<span style="color:#000080;">-EncryptionLevel</span> <span>Required</span>
<span style="color:#000080;">-AuthenticationMethod</span> <span>Eap</span>
<span style="color:#000080;">-EapConfigXmlStream</span> <span>$EAP</span><span>.</span>EapConfigXmlStream <span style="color:#000080;">-SplitTunneling</span>
<span style="color:#000080;">-AllUserConnection</span> <span style="color:#000080;">-Force</span>
<span style="color:#000080;">-PassThru</span></span></p><p></p>

<p class="MsoNormal" style="margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9pt;font-family:'Lucida Console';">}  </span></p><p></p>

<p class="MsoNormal" style="margin-left:18pt;"></p><p> </p>

<p class="MsoNormal" style="margin-left:18pt;"></p><p> </p>

<p class="MsoNormal" style="margin-left:18pt;"></p><p> </p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;">11.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">  </span><span style="line-height:1.42857;">11. </span><span style="text-indent:-18pt;line-height:1.42857;">In the section “Define These Properties” Replace
the strings with the relevant information</span></p><p class="MsoListParagraphCxSpFirst" style="text-indent:-18pt;"><span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';"></span></p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="margin-left:72pt;text-indent:-18pt;">a.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">      
</span>$certificatefile – The name of the .cer file
copied into the packaging folder </p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="margin-left:72pt;text-indent:-18pt;">b.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">     
</span>$vpnurl – the url copied out of the pbk file
with the property name PhoneNumber (Does not include the “PhoneNumber=” component,
just the following URL)</p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="margin-left:72pt;text-indent:-18pt;">c.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">      
</span>$thumbprint – The thumbprint string with no
spaces previously manipulated in notepad. </p><p></p>

<p class="MsoListParagraphCxSpMiddle" style="margin-left:72pt;text-indent:-18pt;">d.<span style="font-size:7pt;line-height:normal;font-family:'Times New Roman';">     
</span>$connectionName – A name for the connection.
This will be displayed to the user under network connections</p><p></p><p class="MsoListParagraphCxSpMiddle" style="margin-left:72pt;text-indent:-18pt;"><br/></p><p class="MsoListParagraphCxSpMiddle" style="margin-left:72pt;text-indent:-18pt;"><img src="/uploads/images/133152/zjc96B.jpeg" style="width:500px;" alt="zjc96B.jpeg"/><br/></p>

<p class="MsoListParagraphCxSpMiddle">12. Run this script with
administrative rights to install the VPN connection for all users on the
system. Users will require user certificates in order to authenticate as per
standard Azure P2S VPN configuration. </p><p></p>

<p class="MsoListParagraphCxSpMiddle"></p><p> </p><p class="MsoListParagraphCxSpMiddle"></p><p><br/></p><p class="MsoListParagraphCxSpMiddle"></p><p><br/></p><p class="MsoListParagraphCxSpMiddle"><br/></p>

<p class="MsoListParagraphCxSpLast"></p><p> </p>
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>Legacy Setup with command line support</span></div>
                <div>Deployment Method Used: <span>Repackaged (to a proprietary Format)</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            Somewhat Difficult
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/bongobot" class="username" rel="nofollow">bongobot</a>
                </li>
                <li>
                    09/01/2016 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
</ul>

                    Please <a href="/login">log in</a> to comment


            </div>

        </div>
        </div>

                
            </div>

                    </div>

    </div>
    <!-- end Deployment Tips -->

    <div class="software-section" id="inventory-records">

        <div class="callout-box2">

            <h3><a href="#" class="plus toggle"></a> Inventory Records (1)</h3>
            <p>View inventory records anonymously contributed by opt-in users of the
                <a href="http://software.dell.com/products/kace-k1000-systems-management-appliance">
                K1000 Systems Management Appliance</a>.
            </p>

        </div>

        <div class="inner-content">

            <div class="inner">

                <div id="software-view-version-revision-list">
                    <div class="title">Versions</div>
                    <ul class="no-bullet nav nav-pills">
                                                    <li class="active">
                                <a href="/software/version/revision/64574/136363">
                                    1
                                </a>
                            </li>
                                            </ul>
                </div>
                <div id="software-view-version-revision-details">
                                            <h2>Azure P2S VPN Client (Non Admin)</h2>
            <div><h3>Version</h3><span>1</span></div>
                                                                                                    
                                    </div>
                <br class="clear"/>
            </div>

        </div>

    </div>
    <!-- end inventory records section -->

    <div class="software-section" id="q-a">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Questions & Answers (0)
                            </h3>
            <p>Questions & Answers related to Microsoft Azure P2S VPN Client (Non Admin)</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                
                            </div>

        </div>
    </div>
    <!-- end Q & A section -->

    <div class="software-section" id="blogs">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Blogs (0)
                            </h3>
            <p>Blog posts related to Microsoft Azure P2S VPN Client (Non Admin)</p>

        </div>
        <div class="inner-content">

            <div class="inner">

                
                            </div>

        </div>
    </div>
    <!-- end blog section -->

    <div class="software-section" id="links">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Links (0)
                            </h3>

            <p>Links related to Microsoft Azure P2S VPN Client (Non Admin)</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                
                            </div>

        </div>
    </div>
    <!-- end links section -->

    <!-- reviews -->
        <div class="software-section" id="reviews">

           <div class="callout-box2">

               <h3>
                   <a href="#" class="plus toggle"></a> Reviews (0)
                                  </h3>

               <p>Reviews related to Microsoft Azure P2S VPN Client (Non Admin)</p>

           </div>

           <div class="inner-content">

               <div class="inner">


                   
               </div>

           </div>

       </div>


</div>
            <div class="clearfix">&nbsp;</div>

        </div>
        <!-- end container-->

        <footer>
            <div class="container">
                                <div id="footer-nav" class="row">
                    <div class="md-3">
                        <strong>Home Pages</strong>
                        <ul>
                            <li><a href="/software">Software</a></li>
                            <li><a href="/tips">Deployment Tips</a></li>
                            <li><a href="/question">Questions</a></li>
                            <li><a href="/blog">Blog Posts</a></li>
                            <li><a href="/link">Shared Links</a></li>
                        </ul>
                    </div>
                    <div class="md-3">
                        <strong>FAQ &amp; Support</strong>
                        <ul>
                            <li><a href="/faq">Site FAQ</a></li>
                            <li><a href="/appdeploy">AppDeploy FAQ</a></li>
                        </ul>
                    </div>
                    <div class="md-3">
                        <strong>About</strong>
                        <ul>
                            <li><a href="/about">ITNinja</a></li>
                            <li><a href="/about">Welcome Video</a></li>
                            <li><a href="/tour">Tour</a></li>
                            <li><a href="/contact">Contact</a></li>
                            <li><a href="/sitemap">Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="md-3">
                        <strong>Share/Contribute</strong>
                        <ul>
                            <li class="pull-left"><a href="http://www.facebook.com/pages/ITNinja/128951133849867"><img src="/bundles/itninjaweb/img/facebook.png" alt="Facebook"></a></li>
                            <li class="pull-left">&nbsp;&nbsp;</li>
                            <li class="pull-left"><a href="http://twitter.com/ITNinjaSite"><img src="/bundles/itninjaweb/img/xtwitter.png.pagespeed.ic.gQlaUvo9Df.png" alt="Twitter"></a></li>
                                                    </ul>
                    </div>
                </div>

                <div id="footer-links">
                    &copy; 2017 Quest Software Inc. All rights reserved.  &nbsp; <a href="/legal">Legal</a> &nbsp; | &nbsp; <a href="https://kace.uservoice.com/forums/139919-itninja">Feedback</a>
                    <a href="http://www.quest.com/" class="footer-logo"><img src="/bundles/itninjaweb/img/xdsg.png.pagespeed.ic.ezebSmrFAj.png" alt="Quest"/></a>
                </div>

                <div id="version"><span id="revision">dc1c22b</span> <span id="build-date">Mon February  6 18:01:59 EST 2017</span>"<span id="server">www.itninja.com</span></div>

            </div>

        </footer>

        <!--[if lte IE 7 ]>
            <script src="/bundles/itninjaweb/js/plugins/jquery.pngFix.pack.js"></script>
        <![endif]-->
        <script src="/js/27f6277.js.pagespeed.jm.Kj_7mqIptf.js"></script>
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->


        
        
    <script src="/js/8e879bd.js.pagespeed.jm.gJ2N-ZPig8.js"></script>
    
    <script>Itninja.Helpful('div.helpful button');$(document).ready(function(){var id='#platform-new #form_platforms_'+1;$(id).click(function(){showNotificationBar('This platform is associated to one or more tips. Please modify the tip prior to removing this platform',1200);$(this).attr("checked",true);});Itninja.HideContent('a.review-delete-admin','div.version-review');});</script>

        <!--[if lt IE 9]>
            <script src="/js/211a076.js"></script>        <![endif]-->
                    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-26553848-1']);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();</script>
            <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"65b52e7159","applicationID":"56576475","transactionName":"NQRRYkYCDUcHWxcLXgxOcENHFwxZSUsMBEUVAEFTaxUKURE=","queueTime":0,"applicationTime":326,"atts":"GUNSFA4YHkk=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
<script pagespeed_no_defer="">//<![CDATA[
(function(){window.pagespeed=window.pagespeed||{};var f=window.pagespeed,h=function(e,a,c,b){this.c=e;this.a=a;this.b=c;this.d=b};f.beaconUrl="";
var k=function(e){var a=e.c,c=window.mod_pagespeed_start,b=Number(new Date)-c,a=a+(-1==a.indexOf("?")?"?":"&"),a=a+"ets="+("load"==e.a?"load:":"unload:"),a=a+b;if("beforeunload"!=e.a||!window.mod_pagespeed_loaded){a+="&r"+e.a+"=";if(window.performance){var b=window.performance.timing,d=b.navigationStart,g=b.requestStart,a=a+(b[e.a+"EventStart"]-d),a=a+("&nav="+(b.fetchStart-d)),a=a+("&dns="+(b.domainLookupEnd-b.domainLookupStart)),a=a+("&connect="+(b.connectEnd-b.connectStart)),a=a+("&req_start="+
(g-d)),a=a+("&ttfb="+(b.responseStart-g)),a=a+("&dwld="+(b.responseEnd-b.responseStart)),a=a+("&dom_c="+(b.domContentLoadedEventStart-d));window.performance.navigation&&(a+="&nt="+window.performance.navigation.type);d=-1;b.msFirstPaint?d=b.msFirstPaint:window.chrome&&window.chrome.loadTimes&&(d=Math.floor(1E3*window.chrome.loadTimes().firstPaintTime));d=d-g;0<=d&&(a+="&fp="+d)}else a+=b;f.getResourceTimingData&&window.parent==window&&(a+=f.getResourceTimingData());a+=window.parent!=window?"&ifr=1":
"&ifr=0";"load"==e.a&&(window.mod_pagespeed_loaded=!0,(b=window.mod_pagespeed_num_resources_prefetched)&&(a+="&nrp="+b),(b=window.mod_pagespeed_prefetch_start)&&(a+="&htmlAt="+(c-b)));f.panelLoader&&(c=f.panelLoader.getCsiTimingsString(),""!=c&&(a+="&b_csi="+c));f.criticalCss&&(c=f.criticalCss,a+="&ccis="+c.total_critical_inlined_size+"&cces="+c.total_original_external_size+"&ccos="+c.total_overhead_size+"&ccrl="+c.num_replaced_links+"&ccul="+c.num_unreplaced_links);""!=e.b&&(a+=e.b);document.referrer&&
(a+="&ref="+encodeURIComponent(document.referrer));a+="&url="+encodeURIComponent(e.d);f.beaconUrl=a;(new Image).src=a}};f.e=function(e,a,c,b){var d=new h(e,a,c,b);window.addEventListener?window.addEventListener(a,function(){k(d)},!1):window.attachEvent("on"+a,function(){k(d)})};f.addInstrumentationInit=f.e;})();

pagespeed.addInstrumentationInit('/mod_pagespeed_beacon', 'load', '', 'http://www.itninja.com/software/microsoft/azure-p2s-vpn-client-non-admin/1-16669/windows');
//]]></script>