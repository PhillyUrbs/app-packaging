<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>IT Pro Tips for MagicISO MagicDisc 2 | ITNinja</title>
        <meta name="description" content="Deployment tips, questions, blogs and other technical materials related to MagicISO MagicDisc 2">
        <meta name="keywords" content="MagicISO,MagicISO MagicDisc,MagicDisc 2">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="yMY423DZduMGIsTKJnJbRzr_qC4FUxtEhXxtuGftSGw" />
        <link rel="shortcut icon" href="/bundles/itninjaweb/img/favicon.ico">
        <link rel="apple-touch-icon" href="/bundles/itninjaweb/img/apple-touch-icon.png">
                <link rel="canonical" href="http://www.itninja.com/software/magiciso/magicdisc/2-6730" />
        

        <!--
         * Quest Software Inc. PROPRIETARY INFORMATION
         *
         * This software is confidential.  Quest Software Inc., or one of its subsidiaries, has
         * supplied this software to you under the terms of a license agreement,
         * nondisclosure agreement or both.  You may not copy, disclose, or use this
         * software except in accordance with those terms.
         *
         * Copyright 2018 Quest Software Inc..  All Rights Reserved.
         *
         * Quest Software Inc. MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF
         * THE SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
         * IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
         * OR NON-INFRINGEMENT. Quest Software Inc. SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY
         * LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR
         * ITS DERIVATIVES.
         *
        -->

        <link href="/bs-compiled.css" rel="stylesheet/less" type="text/css" />
        
        <link href="/bs-compiled.css" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" media="screen" href="/css/a6a67e0.css" />
        
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/f4e8db9.css" />
        <!--[if lt IE 9]>
            <script src="/js/ede9468.js"></script>        <![endif]-->

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="https://code.jquery.com/jquery-migrate-1.2.1.js"></script>
                   <script type="text/javascript">
               var _gaq = _gaq || [];
               _gaq.push(['_setAccount', 'UA-26553848-1']);
               _gaq.push(['_trackPageview']);

               (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();

           </script>
       
        <script type="text/javascript">

            // create the itninja JS namespace
            var Itninja = {};
            Itninja.isIe8 = false;
                        window.jQuery || document.write("<script src='/bundles/itninjaweb/js/jquery-1.10.2.min.js'>\x3C/script>");
            var TAG_SERVER = 'tags.itninja.com',
                TAG_AUTO_SUGGEST_ENABLE = '1' === '1' ? true : false,
                TAG_SHOW_ADD_NEW = false,
                TAG_USER_ID = 0;

            // Temporarily show notification if user is using IE 11
            if (!$.support.leadingWhitespace) {
                $(function(){ showNotificationBar('Incompatible Browser Detected. We recommend switching to another browser while using this site. <a href="/browser-incompatible" rel="nofollow">Click here for more details</a>'); });
            }
            
        </script>
                    </head>
    <body>
        <div class="container">

            <p id="kace-link">&nbsp;</p>

            <div id="top" class="content-row">
                <div class="md-12">
                    <div id="logo"><a href="/">
                        <img src="/bundles/itninjaweb/img/ITN_logo_no_AD.png" alt="ITNinja Home" width="221" height="75" /></a>
                                            </div>

                    <nav class="navbar navbar-link" role="navigation" id="top-nav">

    <div>
        <ul class="nav navbar-nav navbar-right">

                        <li><a href="/login" class="button">Log in</a></li>
            <li class="last"><a href="/register" class="register"><strong>Sign up!</strong></a></li>
            
        </ul>
    </div>
</nav>
                </div>
            </div>
            <div class="content-row">
                <div class="md-12">
                    <nav class="navbar navbar-inverse" role="navigation" id="main-nav">

    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-nav-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
    </div>



    <div class="collapse navbar-collapse" id="main-nav-collapse">

        <ul class="nav navbar-nav navbar-left">
            <li class="first "><a href="/software">Software Tips</a></li>
            <li ><a href="/question">Questions</a></li>
            <li ><a href="/blog">Blogs</a></li>
            <li ><a href="/link">Links</a></li>
            <li ><a href="/community">Communities</a></li>
                    </ul>
        <div class="navbar-search pull-right">
        <form class="navbar-form navbar-right" role="search" action="/search" id="nav-search">

            <div class="input-group">

                <input type="text" name="q" placeholder="search" class="form-control"/>
                <span class="input-group-btn">
                    <button class="btn btn-itn" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                </span>

            </div>

        </form>
        </div>
    </div>
</nav>

                    <div class="nav-image">
                        <a href="https://www.quest.com/kace-userkon/"
                                                      onClick="_gaq.push(['_trackEvent', 'UserKon2018', 'click'])"
                                                      target="_blank">
                            <img src="/bundles/itninjaweb/img/kace-userkon.jpg"/>
                        </a>
                    </div>
                 </div>
            </div>


                            <ul id="breadcrumbs" class="breadcrumb">
                    <li class="home"><a href="/">
                        <img src="/bundles/itninjaweb/img/Breadcrumb_cap.png"/></a></li>
                        <li><a href="/software/browse?Popular=1">Software</a></li>
    <li><a href="/software/magiciso/browse">MagicISO</a></li>
    <li><a href="/software/magiciso/magicdisc/versions">MagicDisc</a></li>
    <li>2</li>
                </ul>
            
            <div id="widget-notice" class="flash-wrap">
            </div>

            
<div class="itn-content">

    <div class="content-row">

        <div id="software-version-view-meta" class="md-8">
                <h2>MagicISO MagicDisc</h2>

                <div id="version-wrapper">

                    <span class="version-name" id="version-changer">
                        Version: 2
                        <div id="version-list">
                            <div class="version-list-top"></div>
                            <ul id="version-list-items" class="version-list">
                                                                    <li>
                                        <a
                                            href="/software/magiciso/magicdisc/2-6730"
                                            >
                                            2.x <span>(3 tips) </span>
                                        </a>
                                    </li>
                                                            </ul>
                        </div>
                    </span>

                    
                </div>

            </div>

        


    <section id="widget-signup" class="signup-widget">

    <h4>Don't be a Stranger!</h4>

    <p>Sign up today to participate,
        stay informed, earn points and establish a reputation for yourself!</p>

    <a class="btn-follow btn" rel="nofollow"
       href="/register?/follow/version/53339/JTJGc29mdHdhcmUlMkZtYWdpY2lzbyUyRm1hZ2ljZGlzYyUyRjItNjczMA==">
        <span> Sign up!</span>
    </a>
    or
    <a class="" rel="nofollow"
       href="/login?/follow/version/53339/JTJGc29mdHdhcmUlMkZtYWdpY2lzbyUyRm1hZ2ljZGlzYyUyRjItNjczMA==">
        login
    </a>
</section>



            <div class="tr-meta" title="Average rating 0 based on 0 votes">
                
<div id="widget-software-byline" class="pull-right">
    Views: 4.4k &nbsp|&nbsp
    Created: 08/11/2008
    
</div><br>

<div id="widget-software-byline-stars" class="stars-wrap">

    <div id="scale-rating" class="rating">
    <input name="Version53339" type="radio" class="star" disabled="disabled"  />
    <input name="Version53339" type="radio" class="star" disabled="disabled"  />
    <input name="Version53339" type="radio" class="star" disabled="disabled"  />
    <input name="Version53339" type="radio" class="star" disabled="disabled"  />
    <input name="Version53339" type="radio" class="star" disabled="disabled"  />
</div></div>
<div id="widget-software-byline-rating" class="pull-right"> Average Rating: <span
            id="average-rating">0</span></div>
            </div>


        <!--end header-->

    </div>


    <div class="content-row">

            </div>


        

    <div class="content-row">

        <div class="md-12">
            

<div id="widget-tags" class="tags-wrap">
    </div>
            
        </div>


        <div id="software-version-view-add-version-meta-additional" class="additional-meta md-12">
            <div class="additional-meta-content callout-box">
                <span class="glyphicon glyphicon-info-sign"></span>
                MagicDisc has <a href="#inventory-records" id="scrollInv">1 inventory records</a>,
                <a href="#q-a" id="scrollQA">1 Questions</a>,
                <a href="#blogs" id="scrollBlog">0 Blogs</a>
                and <a href="#links" id="scrollLinks">1 links</a>. Please help add to this by sharing more!
            </div>
        </div>

    </div>


    <div id="deployment-tips" class="software-section">

        <div class="callout-box2">
            <h3>
                <a href="#" class="plus toggle minus"></a> Deployment Tips (3)
                            </h3>



        </div>


                <div class="inner-content" id="deploy-div">

            <div id="deployment-ratings-summary" class="inner">

                    <div class="meta">
                        <strong>Most Common Setup Type</strong>
                        <div>
                            Not Determined
                        </div>
                    </div>
                    <div class="meta meta-middle">
                        <strong>Average Package Difficulty Rating</strong>
                        <img src="/bundles/itninjaweb/img/difficulty/clear.png" class="img-responsive" />
                        <div class="rating-text">
                            Rated <strong>0 / 5 (Not Rated)</strong>
                            based on <strong>0</strong> ratings
                        </div>
                    </div>
                    <div class="meta">
                        <strong>Most Commonly Reported Deployment Method</strong>
                        <div>
                            Not Determined
                        </div>
                    </div>

            </div>

            <!-- end rating section -->
            
                                                        

            <div id="software-view-deployment-summary-form">
                
<form name="tip_summary" role="form" method="post" action="/version/summary/new/53339" novalidate="novalidate">

<div class="form-group"><label for="tip_summary_text" class="required">Enter your tip</label><textarea id="tip_summary_text" name="tip_summary[text]" required="required" class="form-control"></textarea></div>
<div class="input-group">
<button type="button" id="tip_summary_submit" name="tip_summary[submit]" class="btn btn-itn" class="btn btn-itn">Submit</button>
<span class="or-cancel">
           or
       <a class="tip_summary_cancel">cancel</a>
       </span>
   </div>
<input type="hidden" id="tip_summary__token" name="tip_summary[_token]" value="Ec80X-ME1fGwRPd1W6MyFW-e_W_7TMQnWbqyW2u8Mdc"   class="form-control"/>

</form>

            </div>


            <ul class="nav nav-tabs" id="tips">

                    <li class="active">
                        <a href="/software/magiciso/magicdisc/2-6730#tips">
                            All Tips
                        </a>
                    </li>
                                           <li ><a href="/software/magiciso/magicdisc/2-6730/windows#tips">
                               Windows Tips
                            </a>
                       </li>
                                    </ul>

            </ul>

                    <div id="software-version-tips" class="inner">

                
    <div>
        
    
        <div class="tip" id="tip_4366" name="tip_4366">

            <div class="md-1">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-4366"></div> -->
   <div id="tip-4366" class="thumbs_up" style="text-align: center; width: 28px";><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-up"></span></button></div>
    <div class="avg-rating">120</div>
   <div id="tip-4366" class="thumbs_down" style="text-align: center; width:28px; margin-top: 28px;";><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-down"></span></button></div>
   <!--<div class="arrow_down" id="tip-4366"></div> -->
</div>
            </div>

            <div class="md-11">
    <div class="the-tip">
        <div class="tip-type-heading">Command Line</div>

            <span id="tip-text">
            Simple command line to install:<br />
<br />
{path}\setup_magicdisc.exe /s
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/jcauthorn" class="username" rel="nofollow">jcauthorn</a>
                </li>
                <li>
                    08/11/2008 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
</ul>

                    Please <a href="/login">log in</a> to comment


            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_4367" name="tip_4367">

            <div class="md-1">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-4367"></div> -->
   <div id="tip-4367" class="thumbs_up" style="text-align: center; width: 28px";><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-up"></span></button></div>
    <div class="avg-rating">0</div>
   <div id="tip-4367" class="thumbs_down" style="text-align: center; width:28px; margin-top: 28px;";><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-down"></span></button></div>
   <!--<div class="arrow_down" id="tip-4367"></div> -->
</div>
            </div>

            <div class="md-11">
    <div class="the-tip">
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            msi package creation of magicDisc<br />
<br />
Application Information: - While installing the Magic discÃ¢Â€Â™s setup.exe it will prompt for confirmation to install the driver, since the driver is an unsigned one (not digitally signed by Microsoft). Click Ã¢Â€ÂœInstall this driver software anywayÃ¢Â€Â Then it will install the unsigned driver into the system.<br />
<br />
The message box Click Ã¢Â€ÂœInstall this driver software anywayÃ¢Â€Â will come into picture for those applications which are containing unsigned drivers in it.<br />
<br />
(OS used:- window 7x64 bits)<br />
<br />
INSTALLDIR:- C:\program files (86)\Magic disc<br />
Changes in system:-<br />
<br />
1:- installs the unsigned driver (Name: - mcdbus.inf)<br />
Location: - C:\Windows\System32\DriverStore\FileRepository and<br />
oem files in C:\windows\inf<br />
2. Changes in registry:-<br />
Create registry entries under<br />
- Ã¢Â€ÂœHKLM\SYSTEM\CurrentControlSet\Enum\Root\SCSIADAPTERÃ¢Â€Â and<br />
- Ã¢Â€ÂœHKLM\SYSTEM\CurrentControlSet\services\mcdbusÃ¢Â€Â<br />
<br />
Packaging information: - msi package created using wise packaging studio and custom action written to install the drivers using Ã¢Â€ÂœDPInst.exeÃ¢Â€Â<br />
<br />
Package installation:- After installation when the shortcut is launched, it throws the below error message.<br />
<br />
MagicDisc can't open driver(mcdbus), Please make sure that MagicDisc is run as adminstrator.<br />
You need to right MagicDisc.exe on Windows Explorer, and click "Run As Adminstrator" to run.<br />
<br />
Since the driver is not from a verified publisher (unsigned driver), the driver doesnÃ¢Â€Â™t install. Hence the error.<br />
<br />
Solution :- Converting unsigned driver to signed driver<br />
<br />
Guide to signing unsigned drivers<br />
<br />
Tools you need: (most are from the Windows Driver Kit):<br />
Inf2Cat.exe (To generate the unsigned catalog file from our INF)<br />
<br />
In the same folder as Inf2Cat.exe I have the following DLLs:<br />
Microsoft.Whos.Shared.IO.Cabinets.dll<br />
Microsoft.Whos.Shared.IO.Catalogs.dll<br />
Microsoft.Whos.Shared.Xml.InfReader.dll<br />
Microsoft.Whos.Winqual.Submissions.SubmissionBuilder.dll<br />
Microsoft.Whos.Xml.NonXmlDataReader.dll<br />
<br />
Makecert.exe (Used to create our certificate)<br />
Cert2spc.exe (Create Software Publisher's Certificate (SPC) from our certificate)<br />
Signcode.Exe (Sign our catalog file with an Authenticode digital signature)<br />
Certmgr.exe (Used to add and delete our certificate to the system root)<br />
<br />
Introduction<br />
Now we have our toolset in place, let's package the unsigned magicdiscÃ¢Â€Â™s driver. We're packaging this driver for a customer called Ã¢Â€Â˜MSFTLtdÃ¢Â€Â™.<br />
<br />
Let's assume we've captured the Magic disc application using a snapshot tool. We can see from the resultant snapshot that there is a file in [WindowsFolder]\inf called 'mcdbus.inf'. There are also file called 'mcdbus.sys' in [SystemFolder]DriverStore\FileRepository<br />
<br />
All of these files make up the Magicdisc driver so let's create a folder anywhere on your work machine<br />
(say, "c:\MDdrivers") and copy the three files to it.<br />
<br />
We should now have our unsigned driver in a temporary folder called " c:\MDdrivers " which contains:<br />
mcdbus.inf<br />
mcdbus.sys<br />
mInstNt.dll<br />
<br />
Now let's generate a customer certificate, so we can sign this (and many more) driver(s).<br />
<br />
<br />
SIGNING THE DRIVER<br />
1. Create .cat (catalog) file for driver.<br />
<br />
We notice that the Magicdisc driver contain a cat file which is for unsigned driver, so we'll need to generate one for singed.<br />
Open the .INF file in a text editor. Ensure that under the [version] section that you have an entry specifying a .cat file. If it's not there, add the line<br />
at the end of the section. For example:<br />
[version]<br />
Signature=xxxxxx<br />
Provider=xxxxxx<br />
CatalogFile.NT=mcdbus.cat<br />
<br />
Command line:<br />
Inf2Cat.exe /driver:"&lt;Path to folder containing driver files&gt;" /os:7_X64<br />
<br />
Example:<br />
Inf2Cat.exe /driver:"C:\MDdrivers" /os:7_X64<br />
<br />
<br />
Running this successfully will generate mcdbus.cat in the 'C:\MDdrivers' folder.<br />
<br />
<br />
2. Create authenticode certificate and set private key<br />
<br />
Create another folder called 'c:\MSFTLtd_certificate'. It is here where we'll create our customer-specific certificate and private key. Remember that this certificate can be reused multiple times for the customer (MSFT Ltd) to sign different drivers, so keep naming conventions generic to your customer.<br />
<br />
Command line:<br />
<br />
MakeCert.Exe -r -pe &lt;path to .cer file you want to generate&gt; -n CN=&lt;certificate name&gt; -sv &lt;path to .pvk file you want to generate&gt; -len 2048<br />
<br />
Example:<br />
<br />
makecert.exe -r -pe "c\MSFTLtd_certificate\MSFTLtd.cer" -n CN="MSFTLtd" -sv " c\MSFTLtd_certificate\MSFTLtd.pvk" -len 2048<br />
<br />
<br />
Running this will ask you to set a private key. Ã¢Â€ÂœClick on noneÃ¢Â€Â Make a note of this key! Running this command will generate:<br />
c\MSFTLtd_certificate\MSFTLtd.cer and<br />
c\MSFTLtd_certificate\MSFTLtd.pvk<br />
<br />
<br />
3. Create Software Publisher's Certificate (SPC) from our certificate<br />
<br />
Command Line:<br />
<br />
Cert2Spc.Exe &lt;path to .cer file&gt; &lt;path to .spc file&gt;<br />
<br />
Example:<br />
<br />
cert2spc.exe " c\MSFTLtd _certificate\MSFTLtd.cer" " c\MSFTLtd _certificate\MSFTLtd.spc"<br />
<br />
This will generate c\MSFTLtd_certificate\MSFTLtd.spc<br />
<br />
<br />
4. Sign the catalog file<br />
<br />
Command line:<br />
<br />
signcode.exe -spc &lt;path to .spc file&gt; -v &lt;path to .pvk file&gt; -t http://timestamp.verisign.com/scripts/timstamp.dll &lt;Path to catalogfile&gt;<br />
<br />
Example:<br />
<br />
SignCode.Exe -spc " c\MSFTLtd _certificate\MSFTLtd.spc" Ã¢Â€Â“v "c\MSFTLtd_certificate\MSFTLtd.pvk" Ã¢Â€Â“t http://timestamp.verisign.com/scripts/timstamp.dll "C:\MDdrivers\mcdbus.cat"<br />
<br />
<br />
<br />
The above methods: - Ã¢Â€ÂœGuide to signing unsigned driversÃ¢Â€Â<br />
Is usefull to create<br />
.cer file- customer-specific certificate<br />
And .cat (Catalog)file and to Sign the catalog file<br />
<br />
Step 1:- Signing the driver (using above document)<br />
i) Create .cat (catalog) file for driver ( Delete the old one from INSTALLDIR )<br />
ii) Create Authenticode certificate<br />
iii) Create Software Publisher's Certificate (SPC) from our certificate<br />
iv) Sign the catalog file<br />
Now we have following files<br />
mcdbus.inf (content changed)<br />
mcdbus.sys<br />
mcdbus.cat file (New one)<br />
MSFTLtd.cer<br />
<br />
Step 2:- Created msi package<br />
Replace following files with newly generated files in the INSTALLDIR of the package<br />
mcdbus.inf<br />
mcdbus.sys<br />
mcdbus.cat<br />
and add MSFTLtd.cer file under windows\system32 in msi<br />
and add certmgr.exe file under INSTALLDIR<br />
Now the INSTALLDIR contains following files<br />
MagicDisc.exe<br />
Mcdbus.cat (Newly created)<br />
Mcdbus.inf (Newly created)<br />
Mcdbus.sys (New)<br />
mcdInst64.exe<br />
mInstNt.dll<br />
certmgr.exe<br />
muninst.exe<br />
<br />
Step 3:- Adding Custom Actions in the msi<br />
A) During Installation<br />
Condition: - NOT Installed<br />
<br />
i) To add certificate to local machine<br />
Name: CA_AddCertLocal<br />
Executable files: certmgr.exe<br />
Command line Argument: -add "[SystemFolder]MSFTLtd.cer" -s -r localMachine ROOT<br />
<br />
ii) To add Certificate to Trusted publishers<br />
Name: CA_AddCertPublish<br />
Executable files: certmgr.exe<br />
Command line Argument: -add "[SystemFolder]MSFTLtd.cer" -c -s -r localMachine TrustedPublisher<br />
<br />
iii) Installing the driver using DPInst.exe<br />
Name:- CA_installDriver<br />
Executable files: DPInstx64.exe<br />
Command line Argument: /S /SA /F<br />
<br />
iv) InstallSCSI using Ã¢Â€ÂœmcdInst64.exeÃ¢Â€Â<br />
This exe will create and start service and add entries into registries under<br />
- Ã¢Â€ÂœHKLM\SYSTEM\CurrentControlSet\Enum\Root\SCSIADAPTERÃ¢Â€Â and<br />
- Ã¢Â€ÂœHKLM\SYSTEM\CurrentControlSet\services\mcdbusÃ¢Â€Â<br />
Name:- CA_InstallSCSI<br />
Command line Argument:-<br />
"[INSTALLDIR]mcdInst64.exe" "[ProgramFilesFolder]MagicDisc"<br />
<br />
B) During Uninstalltion<br />
Condition:- REMOVE~="ALL"<br />
<br />
v) To delete certificate From Trusted publishers<br />
Name: CA_DelCertPublish<br />
Executable files: certmgr.exe<br />
Command line Argument: -del -c -n "MSFTLtd" -c -s -r localMachine TrustedPublisher<br />
<br />
vi) To Delete Certificate From local machine<br />
Name: CA_DelCertLocal<br />
Executable files: certmgr.exe<br />
Command line Argument: -del -c -n "MSFTLtd" -s -r localMachine ROOT<br />
<br />
vii) To uninstall the driver from local machine<br />
Name: CA_Unistall_mcdbusDriver<br />
EXE or command line: cmd.exe /c ""[INSTALLDIR]DPInstx64.exe" /U "[INSTALLDIR]mcdbus.inf" /s"<br />
<br />
viii) To Stop service<br />
Name: CA_UninstallSCSI<br />
EXE or command line: "[INSTALLDIR]mcdInst64.exe" Ã¢Â€Â“uninst<br />
<br />
ix) To Delete service<br />
Name: CA_Unistall_service<br />
EXE or command line: cmd.exe /c "sc delete mcdbus" 
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/sudarshan546" class="username" rel="nofollow">sudarshan546</a>
                </li>
                <li>
                    03/12/2012 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
</ul>

                    Please <a href="/login">log in</a> to comment


            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_6100" name="tip_6100">

            <div class="md-1">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-6100"></div> -->
   <div id="tip-6100" class="thumbs_up" style="text-align: center; width: 28px";><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-up"></span></button></div>
    <div class="avg-rating">0</div>
   <div id="tip-6100" class="thumbs_down" style="text-align: center; width:28px; margin-top: 28px;";><button class="btn btn-xs btn-link "><span class="glyphicon glyphicon-thumbs-down"></span></button></div>
   <!--<div class="arrow_down" id="tip-6100"></div> -->
</div>
            </div>

            <div class="md-11">
    <div class="the-tip">
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            msi package creation of magicDisc<br />
<br />
Application Information: - While installing the Magic discâs setup.exe it will prompt for confirmation to install the driver, since the driver is an unsigned one (not digitally signed by Microsoft). Click âInstall this driver software anywayâ Then it will install the unsigned driver into the system.<br />
<br />
The message box Click âInstall this driver software anywayâ will come into picture for those applications which are containing unsigned drivers in it.<br />
<br />
(OS used:- window 7x64 bits)<br />
<br />
INSTALLDIR:- C:\program files (86)\Magic disc<br />
Changes in system:-<br />
<br />
1:- installs the unsigned driver (Name: - mcdbus.inf)<br />
Location: - C:\Windows\System32\DriverStore\FileRepository and<br />
oem files in C:\windows\inf<br />
2. Changes in registry:-<br />
Create registry entries under<br />
- âHKLM\SYSTEM\CurrentControlSet\Enum\Root\SCSIADAPTERâ and<br />
- âHKLM\SYSTEM\CurrentControlSet\services\mcdbusâ<br />
<br />
Packaging information: - msi package created using wise packaging studio and custom action written to install the drivers using âDPInst.exeâ<br />
<br />
Package installation:- After installation when the shortcut is launched, it throws the below error message.<br />
<br />
MagicDisc can't open driver(mcdbus), Please make sure that MagicDisc is run as adminstrator.<br />
You need to right MagicDisc.exe on Windows Explorer, and click "Run As Adminstrator" to run.<br />
<br />
Since the driver is not from a verified publisher (unsigned driver), the driver doesnât install. Hence the error.<br />
<br />
Solution :- Converting unsigned driver to signed driver<br />
<br />
Guide to signing unsigned drivers<br />
<br />
Tools you need: (most are from the Windows Driver Kit):<br />
Inf2Cat.exe (To generate the unsigned catalog file from our INF)<br />
<br />
In the same folder as Inf2Cat.exe I have the following DLLs:<br />
Microsoft.Whos.Shared.IO.Cabinets.dll<br />
Microsoft.Whos.Shared.IO.Catalogs.dll<br />
Microsoft.Whos.Shared.Xml.InfReader.dll<br />
Microsoft.Whos.Winqual.Submissions.SubmissionBuilder.dll<br />
Microsoft.Whos.Xml.NonXmlDataReader.dll<br />
<br />
Makecert.exe (Used to create our certificate)<br />
Cert2spc.exe (Create Software Publisher's Certificate (SPC) from our certificate)<br />
Signcode.Exe (Sign our catalog file with an Authenticode digital signature)<br />
Certmgr.exe (Used to add and delete our certificate to the system root)<br />
<br />
Introduction<br />
Now we have our toolset in place, let's package the unsigned magicdiscâs driver. We're packaging this driver for a customer called âMSFTLtdâ.<br />
<br />
Let's assume we've captured the Magic disc application using a snapshot tool. We can see from the resultant snapshot that there is a file in [WindowsFolder]\inf called 'mcdbus.inf'. There are also file called 'mcdbus.sys' in [SystemFolder]DriverStore\FileRepository<br />
<br />
All of these files make up the Magicdisc driver so let's create a folder anywhere on your work machine<br />
(say, "c:\MDdrivers") and copy the three files to it.<br />
<br />
We should now have our unsigned driver in a temporary folder called " c:\MDdrivers " which contains:<br />
mcdbus.inf<br />
mcdbus.sys<br />
mInstNt.dll<br />
<br />
Now let's generate a customer certificate, so we can sign this (and many more) driver(s).<br />
<br />
<br />
SIGNING THE DRIVER<br />
1. Create .cat (catalog) file for driver.<br />
<br />
We notice that the Magicdisc driver contain a cat file which is for unsigned driver, so we'll need to generate one for singed.<br />
Open the .INF file in a text editor. Ensure that under the [version] section that you have an entry specifying a .cat file. If it's not there, add the line<br />
at the end of the section. For example:<br />
[version]<br />
Signature=xxxxxx<br />
Provider=xxxxxx<br />
CatalogFile.NT=mcdbus.cat<br />
<br />
Command line:<br />
Inf2Cat.exe /driver:"&lt;Path to folder containing driver files&gt;" /os:7_X64<br />
<br />
Example:<br />
Inf2Cat.exe /driver:"C:\MDdrivers" /os:7_X64<br />
<br />
<br />
Running this successfully will generate mcdbus.cat in the 'C:\MDdrivers' folder.<br />
<br />
<br />
2. Create authenticode certificate and set private key<br />
<br />
Create another folder called 'c:\MSFTLtd_certificate'. It is here where we'll create our customer-specific certificate and private key. Remember that this certificate can be reused multiple times for the customer (MSFT Ltd) to sign different drivers, so keep naming conventions generic to your customer.<br />
<br />
Command line:<br />
<br />
MakeCert.Exe -r -pe &lt;path to .cer file you want to generate&gt; -n CN=&lt;certificate name&gt; -sv &lt;path to .pvk file you want to generate&gt; -len 2048<br />
<br />
Example:<br />
<br />
makecert.exe -r -pe "c\MSFTLtd_certificate\MSFTLtd.cer" -n CN="MSFTLtd" -sv " c\MSFTLtd_certificate\MSFTLtd.pvk" -len 2048<br />
<br />
<br />
Running this will ask you to set a private key. âClick on noneâ Make a note of this key! Running this command will generate:<br />
c\MSFTLtd_certificate\MSFTLtd.cer and<br />
c\MSFTLtd_certificate\MSFTLtd.pvk<br />
<br />
<br />
3. Create Software Publisher's Certificate (SPC) from our certificate<br />
<br />
Command Line:<br />
<br />
Cert2Spc.Exe &lt;path to .cer file&gt; &lt;path to .spc file&gt;<br />
<br />
Example:<br />
<br />
cert2spc.exe " c\MSFTLtd _certificate\MSFTLtd.cer" " c\MSFTLtd _certificate\MSFTLtd.spc"<br />
<br />
This will generate c\MSFTLtd_certificate\MSFTLtd.spc<br />
<br />
<br />
4. Sign the catalog file<br />
<br />
Command line:<br />
<br />
signcode.exe -spc &lt;path to .spc file&gt; -v &lt;path to .pvk file&gt; -t http://timestamp.verisign.com/scripts/timstamp.dll &lt;Path to catalogfile&gt;<br />
<br />
Example:<br />
<br />
SignCode.Exe -spc " c\MSFTLtd _certificate\MSFTLtd.spc" âv "c\MSFTLtd_certificate\MSFTLtd.pvk" ât http://timestamp.verisign.com/scripts/timstamp.dll "C:\MDdrivers\mcdbus.cat"<br />
<br />
<br />
<br />
The above methods: - âGuide to signing unsigned driversâ<br />
Is usefull to create<br />
.cer file- customer-specific certificate<br />
And .cat (Catalog)file and to Sign the catalog file<br />
<br />
Step 1:- Signing the driver (using above document)<br />
i) Create .cat (catalog) file for driver ( Delete the old one from INSTALLDIR )<br />
ii) Create Authenticode certificate<br />
iii) Create Software Publisher's Certificate (SPC) from our certificate<br />
iv) Sign the catalog file<br />
Now we have following files<br />
mcdbus.inf (content changed)<br />
mcdbus.sys<br />
mcdbus.cat file (New one)<br />
MSFTLtd.cer<br />
<br />
Step 2:- Created msi package<br />
Replace following files with newly generated files in the INSTALLDIR of the package<br />
mcdbus.inf<br />
mcdbus.sys<br />
mcdbus.cat<br />
and add MSFTLtd.cer file under windows\system32 in msi<br />
and add certmgr.exe file under INSTALLDIR<br />
Now the INSTALLDIR contains following files<br />
MagicDisc.exe<br />
Mcdbus.cat (Newly created)<br />
Mcdbus.inf (Newly created)<br />
Mcdbus.sys (New)<br />
mcdInst64.exe<br />
mInstNt.dll<br />
certmgr.exe<br />
muninst.exe<br />
<br />
Step 3:- Adding Custom Actions in the msi<br />
A) During Installation<br />
Condition: - NOT Installed<br />
<br />
i) To add certificate to local machine<br />
Name: CA_AddCertLocal<br />
Executable files: certmgr.exe<br />
Command line Argument: -add "[SystemFolder]MSFTLtd.cer" -s -r localMachine ROOT<br />
<br />
ii) To add Certificate to Trusted publishers<br />
Name: CA_AddCertPublish<br />
Executable files: certmgr.exe<br />
Command line Argument: -add "[SystemFolder]MSFTLtd.cer" -c -s -r localMachine TrustedPublisher<br />
<br />
iii) Installing the driver using DPInst.exe<br />
Name:- CA_installDriver<br />
Executable files: DPInstx64.exe<br />
Command line Argument: /S /SA /F<br />
<br />
iv) InstallSCSI using âmcdInst64.exeâ<br />
This exe will create and start service and add entries into registries under<br />
- âHKLM\SYSTEM\CurrentControlSet\Enum\Root\SCSIADAPTERâ and<br />
- âHKLM\SYSTEM\CurrentControlSet\services\mcdbusâ<br />
Name:- CA_InstallSCSI<br />
Command line Argument:-<br />
"[INSTALLDIR]mcdInst64.exe" "[ProgramFilesFolder]MagicDisc"<br />
<br />
B) During Uninstalltion<br />
Condition:- REMOVE~="ALL"<br />
<br />
v) To delete certificate From Trusted publishers<br />
Name: CA_DelCertPublish<br />
Executable files: certmgr.exe<br />
Command line Argument: -del -c -n "MSFTLtd" -c -s -r localMachine TrustedPublisher<br />
<br />
vi) To Delete Certificate From local machine<br />
Name: CA_DelCertLocal<br />
Executable files: certmgr.exe<br />
Command line Argument: -del -c -n "MSFTLtd" -s -r localMachine ROOT<br />
<br />
vii) To uninstall the driver from local machine<br />
Name: CA_Unistall_mcdbusDriver<br />
EXE or command line: cmd.exe /c ""[INSTALLDIR]DPInstx64.exe" /U "[INSTALLDIR]mcdbus.inf" /s"<br />
<br />
viii) To Stop service<br />
Name: CA_UninstallSCSI<br />
EXE or command line: "[INSTALLDIR]mcdInst64.exe" âuninst<br />
<br />
ix) To Delete service<br />
Name: CA_Unistall_service<br />
EXE or command line: cmd.exe /c "sc delete mcdbus" 
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/sudarshan546" class="username" rel="nofollow">sudarshan546</a>
                </li>
                <li>
                    03/12/2012 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
</ul>

                    Please <a href="/login">log in</a> to comment


            </div>

        </div>
        </div>

                
            </div>

                    </div>

    </div>
    <!-- end Deployment Tips -->

    <div class="software-section" id="inventory-records">

        <div class="callout-box2">

            <h3><a href="#" class="plus toggle"></a> Inventory Records (1)</h3>
            <p>View inventory records anonymously contributed by opt-in users of the
                <a href="http://software.dell.com/products/kace-k1000-systems-management-appliance">
                K1000 Systems Management Appliance</a>.
            </p>

        </div>

        <div class="inner-content">

            <div class="inner">

                <div id="software-view-version-revision-list">
                    <div class="title">Versions</div>
                    <ul class="no-bullet nav nav-pills">
                                                    <li class="active">
                                <a href="/software/version/revision/53339/114018">
                                    2
                                </a>
                            </li>
                                            </ul>
                </div>
                <div id="software-view-version-revision-details">
                                            <h2>MagicDisc</h2>
            <div><h3>Version</h3><span>2</span></div>
                                                                                                    
                                    </div>
                <br class="clear"/>
            </div>

        </div>

    </div>
    <!-- end inventory records section -->

    <div class="software-section" id="q-a">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Questions & Answers (1)
                            </h3>
            <p>Questions & Answers related to MagicISO MagicDisc</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">

    <div class="content-left">
        <div class="vote-wrap">

            <div class="vote-num">
                2
            </div>

            <div class="vote-label">
                <!--insert conditional based on answered or not-->
                ANSWERS
            </div>

        </div>
    </div>


    <div class="content-meta">

        <a href="/question/magicdisc-2-7" class="title">
            MagicDisc 2.7
        </a>

        <div class="content-lower">

            <div class="content-rating"><div id="scale-rating" class="rating">
    <input name="magicdisc-2-7" type="radio" class="star" disabled="disabled"  />
    <input name="magicdisc-2-7" type="radio" class="star" disabled="disabled"  />
    <input name="magicdisc-2-7" type="radio" class="star" disabled="disabled"  />
    <input name="magicdisc-2-7" type="radio" class="star" disabled="disabled"  />
    <input name="magicdisc-2-7" type="radio" class="star" disabled="disabled"  />
</div></div>

            <div class="byline">
                By:
                <a href="/user/sudarshan789" rel="nofollow">sudarshan789</a>
                6 years ago 26.5k views
            </div>
            <div id="question-latest-activity" class="latestActivity">
        </div>

        </div>

    </div>

</div>
<!--end question -->                
                            </div>

        </div>
    </div>
    <!-- end Q & A section -->

    <div class="software-section" id="blogs">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Blogs (0)
                            </h3>
            <p>Blog posts related to MagicISO MagicDisc</p>

        </div>
        <div class="inner-content">

            <div class="inner">

                
                            </div>

        </div>
    </div>
    <!-- end blog section -->

    <div class="software-section" id="links">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Links (1)
                            </h3>

            <p>Links related to MagicISO MagicDisc</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/free-iso-mounting-software" class="title">
                Free ISO mounting software
            </a>

        <div class="content-lower">

            <div class="content-rating"><div id="scale-rating" class="rating">
    <input name="free-iso-mounting-software" type="radio" class="star" disabled="disabled"  />
    <input name="free-iso-mounting-software" type="radio" class="star" disabled="disabled"  />
    <input name="free-iso-mounting-software" type="radio" class="star" disabled="disabled"  />
    <input name="free-iso-mounting-software" type="radio" class="star" disabled="disabled"  />
    <input name="free-iso-mounting-software" type="radio" class="star" disabled="disabled"  />
</div></div>
            <div class="byline">
                By:
                <a href="/user/jcauthorn" rel="nofollow">jcauthorn</a>
                9 years ago 1.5k views
            </div>

        </div>

    </div>

</div>                
                            </div>

        </div>
    </div>
    <!-- end links section -->

    <!-- reviews -->
        <div class="software-section" id="reviews">

           <div class="callout-box2">

               <h3>
                   <a href="#" class="plus toggle"></a> Reviews (0)
                                  </h3>

               <p>Reviews related to MagicISO MagicDisc</p>

           </div>

           <div class="inner-content">

               <div class="inner">


                   
               </div>

           </div>

       </div>


</div>
            <div class="clearfix">&nbsp;</div>

        </div>
        <!-- end container-->

        <footer>
            <div class="container">
                                <div id="footer-nav" class="row">
                    <div class="md-3">
                        <strong>Home Pages</strong>
                        <ul>
                            <li><a href="/software">Software</a></li>
                            <li><a href="/tips">Deployment Tips</a></li>
                            <li><a href="/question">Questions</a></li>
                            <li><a href="/blog">Blog Posts</a></li>
                            <li><a href="/link">Shared Links</a></li>
                        </ul>
                    </div>
                    <div class="md-3">
                        <strong>FAQ &amp; Support</strong>
                        <ul>
                            <li><a href="/faq">Site FAQ</a></li>
                            <li><a href="/appdeploy">AppDeploy FAQ</a></li>
                        </ul>
                    </div>
                    <div class="md-3">
                        <strong>About</strong>
                        <ul>
                            <li><a href="/about">ITNinja</a></li>
                            <li><a href="/about">Welcome Video</a></li>
                            <li><a href="/tour">Tour</a></li>
                            <li><a href="/contact">Contact</a></li>
                            <li><a href="/sitemap">Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="md-3">
                        <strong>Share/Contribute</strong>
                        <ul>
                            <li class="pull-left"><a href="http://www.facebook.com/pages/ITNinja/128951133849867"><img src="/bundles/itninjaweb/img/facebook.png" alt="Facebook"></a></li>
                            <li class="pull-left">&nbsp;&nbsp;</li>
                            <li class="pull-left"><a href="http://twitter.com/ITNinjaSite"><img src="/bundles/itninjaweb/img/twitter.png" alt="Twitter"></a></li>
                                                    </ul>
                    </div>
                </div>

                <div id="footer-links">
                    &copy; 2018 Quest Software Inc. All rights reserved.  &nbsp; <a href="/legal">Legal</a> &nbsp; | &nbsp; <a href="https://kace.uservoice.com/forums/139919-itninja">Feedback</a>
                    <a href="http://www.quest.com/" class="footer-logo"><img src="/bundles/itninjaweb/img/dsg.png" alt="Quest" /></a>
                </div>

                <div id="version">bd7ebcd</div>

            </div>

        </footer>

        <!--[if lte IE 7 ]>
            <script src="/bundles/itninjaweb/js/plugins/jquery.pngFix.pack.js"></script>
        <![endif]-->
        <script src="/js/27f6277.js"></script>
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->


        
        
    <script src="/js/8e879bd.js"></script>
    
    <script>
        Itninja.Helpful('div.helpful button');

        $(document).ready( function() {
        // only way to do this
                     var id = '#platform-new #form_platforms_' + 1;
            $(id).click(function() {
                showNotificationBar('This platform is associated to one or more tips. Please modify the tip prior to removing this platform',1200);
                // reclick it
                $(this).attr("checked", true);
            });
                Itninja.HideContent('a.review-delete-admin','div.version-review');
        });
    </script>

        <!--[if lt IE 9]>
            <script src="/js/211a076.js"></script>        <![endif]-->
    </body>
</html>
