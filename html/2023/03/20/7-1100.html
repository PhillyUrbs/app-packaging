<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>IT Pro Tips for Microsoft Internet Information Server (IIS) 7</title>
    <meta name="description" content="Deployment tips, questions, blogs and other technical materials related to Microsoft Internet Information Server (IIS) 7">
    <meta name="keywords" content="Microsoft,Microsoft Internet Information Server (IIS),Internet Information Server (IIS) 7">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="yMY423DZduMGIsTKJnJbRzr_qC4FUxtEhXxtuGftSGw" />
    <link rel="apple-touch-icon" sizes="180x180" href="/build/static/layout/apple-touch-icon.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/build/static/layout/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/build/static/layout/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/build/static/layout/safari-pinned-tab.svg" color="#a81e25">
    <meta name="msapplication-TileColor" content="#a81e25">
    <meta name="theme-color" content="#ffffff">
            <link rel="canonical" href="http://www.itninja.com/software/microsoft/internet-information-server-iis/7-1100" />
    

    <!--
         * Quest Software Inc. PROPRIETARY INFORMATION
         *
         * This software is confidential.  Quest Software Inc., or one of its subsidiaries, has
         * supplied this software to you under the terms of a license agreement,
         * nondisclosure agreement or both.  You may not copy, disclose, or use this
         * software except in accordance with those terms.
         *
         * Copyright 2023 Quest Software Inc..  All Rights Reserved.
         *
         * Quest Software Inc. MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF
         * THE SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
         * IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
         * OR NON-INFRINGEMENT. Quest Software Inc. SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY
         * LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR
         * ITS DERIVATIVES.
         *
        -->
    <link rel="stylesheet" href="/build/index.82f4a908.css">

    
            <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-P8DH2B7');</script>
        <!-- End Google Tag Manager -->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26553848-1']);
            _gaq.push(['_trackPageview']);

            (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();

        </script>
    
    <script type="text/javascript">

        // create the itninja JS namespace
        var Itninja = {};
        Itninja.isIe8 = false;
                var TAG_SERVER = 'tags.itninja.com',
            TAG_AUTO_SUGGEST_ENABLE = 'true' === '1' ? true : false,
            TAG_SHOW_ADD_NEW = false,
            TAG_USER_ID = 0;



    </script>
        </head>
<body>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P8DH2B7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="content-row">
    <div class="md-12">
        
<nav class="navbar navbar-inverse" role="navigation" id="main-nav">
    <div class="navbar-header">
        <div class="nav-logo-container-c"><a href="/"> <img src="/build/static/layout/ITN_logo_white.svg" class="nav-logo-collapse"/> </a></div>
        <button class="navbar-toggle" data-toggle="collapse" data-target="#main-nav-collapse" id="navbar-toggle">
            <div id="nav-icon-bar">
                <span class="nav-icon-bar-span"></span>
                <span class="nav-icon-bar-span"></span>
                <span class="nav-icon-bar-span"></span>
                <span class="nav-icon-bar-span"></span>
            </div>
        </button>
    </div>


    <div id="main-nav-collapse" class="collapse collapse-container">
        <div class="navbar-search-container">
            <form role="search" action="/search" id="nav-search">
                <div class="input-group">
                    <input type="text" name="q" placeholder="Search..." class="form-control nav-collapsed-form"/>
                    <span class="input-group-btn">
                    <button class="btn search-btn" type="submit"><img class="search-icon" src="/build/static/layout/Search_Icon_White.svg"></button>
                </span>
                </div>
            </form>
        </div>

        <ul class="collapse-list">
            <li class=""><a href="/software-library" class="nav-collapse-text">Software Tips</a></li>
            <li ><a href="/question" class="nav-collapse-text">Questions</a></li>
            <li ><a href="/blog" class="nav-collapse-text">Blogs</a></li>
            <li ><a href="/link" class="nav-collapse-text">Links</a></li>
            <li ><a href="/community" class="nav-collapse-text">Communities</a></li>
            <li ><a href="/gallery" class="nav-collapse-text">KACE Photos</a></li>
                        
            <li>
                <div>
                    <div class="user-dropdown-collapse">
                                                    <a href="/login" class="button log-in-collapse">Log in</a>
                                        </div>
            </div>
        </li>
    </ul>
    </div>

    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav ">
            <div class="nav-logo-container"> <li> <a href="/"> <img src="/build/static/layout/ITN_logo_white.svg" class="nav-logo"> </a> </li> </div>
            <li class="nav-bar-text-first first "><a href="/software-library" class="navigation-bar-text">Software Tips</a></li>
            <li ><a href="/question" class="navigation-bar-text">Questions</a></li>
            <li ><a href="/blog" class="navigation-bar-text">Blogs</a></li>
            <li ><a href="/link" class="navigation-bar-text">Links</a></li>
            <li ><a href="/community" class="navigation-bar-text">Communities</a></li>
            <li ><a href="/gallery" class="navigation-bar-text">KACE Photos</a></li>
                                </ul>

        <div>
            <div class="user-dropdown">
                                    <div class="nav-login-container">
                        <li class="nav-login-list"><a href="/login" class="button nav-register-log-text">Log in</a></li>
                    </div>
                            </div>
        </div>

        <div id="search-form-container" class="search-form-container">
            <div class="navbar-search pull-right">
                <form class="navbar-form navbar-right" role="search" action="/search" id="nav-search">
                    <div class="input-group search-input-span box">
                        <input type="text" id="search-trigger" name="q" placeholder="Search..." class="form-control nav-search-form"/>
                        <span class="input-group-btn">
                            <button class="btn search-btn" type="submit"><img class="search-icon" src="/build/static/layout/Search_Icon_White.svg"></button>
                        </span>
                    </div>
                </form>
            </div>
        </div>


    </div>
</nav>





    </div>
</div>

    <a href="/"> <img class="breadcrumbCap" src="/build/static/layout/Breadcrumb_cap.svg" alt="/build/static/layout/Breadcrumb_cap_w.png" href="/"/></a>
    <ul id="breadcrumbs" class="breadcrumb">
        <li><a href="/">
            </a></li>
            <li><a href="/software-library">Software</a></li>
    <li><a href="/software-library/company/microsoft">Microsoft</a></li>
    <li><a href="/software-library/company/microsoft/internet-information-server-iis">Internet Information Server (IIS)</a></li>
    <li>7</li>
    </ul>


<div id="widget-notice" class="flash-wrap">
            </div>
<div class="body-container"  id="app">

    
<div class="itn-content">

    <div class="content-row">

        <div id="software-version-view-meta" class="md-9">
                <h2>Microsoft Internet Information Server (IIS)</h2>

                <div id="version-wrapper">

                    <span class="version-name" id="version-changer">
                        Version: 7
                        <div id="version-list">
                            <div class="version-list-top"></div>
                            <ul id="version-list-items" class="version-list">
                                                                    <li>
                                        <a
                                            href="/software/microsoft/internet-information-server-iis/7-1100"
                                            >
                                            7.x <span>(3 tips) </span>
                                        </a>
                                    </li>
                                                                    <li>
                                        <a
                                            href="/software/microsoft/internet-information-server-iis/6-1551"
                                            >
                                            6.x <span>(12 tips) </span>
                                        </a>
                                    </li>
                                                            </ul>
                        </div>
                    </span>

                    
                </div>

            </div>
        <div class="md-3">

            


    <section id="widget-signup">

    <h4>Don't be a Stranger!</h4>

    <p>Sign up today to participate,
        stay informed, earn points and establish a reputation for yourself!</p>

    <a class="btn-follow btn" rel="nofollow"
       href="/register?/follow/version/29540/JTJGc29mdHdhcmUlMkZtaWNyb3NvZnQlMkZpbnRlcm5ldC1pbmZvcm1hdGlvbi1zZXJ2ZXItaWlzJTJGNy0xMTAw">
        <span> Sign up!</span>
    </a>
    or
    <a class="" rel="nofollow"
       href="/login?/follow/version/29540/JTJGc29mdHdhcmUlMkZtaWNyb3NvZnQlMkZpbnRlcm5ldC1pbmZvcm1hdGlvbi1zZXJ2ZXItaWlzJTJGNy0xMTAw">
        login
    </a>
</section>



            <div class="tr-meta" title="Average rating 0 based on 0 votes">
                
<div id="widget-software-byline" class="pull-right">
    Views: 6.2k &nbsp|&nbsp
    Created: 08/25/2009
    
</div><br>

<div id="widget-software-byline-stars" class="stars-wrap">
    <div name="itninja-star-rating"
     data-entity-id="29540"
     data-enabled="false"
     data-entity-name="software"
     data-rating=4
     data-expanded="false"
     data-entityType="software"
     >
</div></li>

</div>
<div id="widget-software-byline-rating" class="pull-right"> Average Rating: <span
            id="average-rating">0</span></div>
            </div>
        </div>


        <!--end header-->

    </div>


    <div class="content-row">

            </div>


        

    <div class="content-row">

        <div class="md-12">
            

<div id="widget-tags" class="tags-wrap">
    </div>
            
        </div>


        <div id="software-version-view-add-version-meta-additional" class="additional-meta md-12">
            <div class="additional-meta-content callout-box">
                <span class="glyphicon glyphicon-info-sign"></span>
                Internet Information Server (IIS) has <a href="#inventory-records" id="scrollInv">1 inventory records</a>,
                <a href="#q-a" id="scrollQA">1 Questions</a>,
                <a href="#blogs" id="scrollBlog">1 Blogs</a>
                and <a href="#links" id="scrollLinks">6 links</a>. Please help add to this by sharing more!
            </div>
        </div>

    </div>


    <div id="deployment-tips" class="software-section">

        <div class="callout-box2">
            <h3>
                <a href="#" class="plus toggle minus"></a> Deployment Tips (3)
                            </h3>



        </div>


                <div class="inner-content" id="deploy-div">

            <div id="deployment-ratings-summary" class="inner">

                    <div class="meta">
                        <strong>Most Common Setup Type</strong>
                        <div>
                            Not Determined
                        </div>
                    </div>
                    <div class="meta meta-middle">
                        <strong>Average Package Difficulty Rating</strong>
                        <img src="/build/static/software/orange.png" class="img-responsive" />
                        <div class="rating-text">
                            Rated <strong>4 / 5 (Somewhat Difficult)</strong>
                            based on <strong>1</strong> ratings
                        </div>
                    </div>
                    <div class="meta">
                        <strong>Most Commonly Reported Deployment Method</strong>
                        <div>
                            Vendor Provided Command Line (answer file driven)
                        </div>
                    </div>

            </div>

            <!-- end rating section -->
            
                                                        

            

            <ul class="nav nav-tabs" id="tips">

                    <li class="active">
                        <a href="/software/microsoft/internet-information-server-iis/7-1100#tips">
                            All Tips
                        </a>
                    </li>
                                           <li ><a href="/software/microsoft/internet-information-server-iis/7-1100/windows#tips">
                               Windows Tips
                            </a>
                       </li>
                                    </ul>

            </ul>

                    <div id="software-version-tips" class="inner">

                
    <div>
        
    
        <div class="tip" id="tip_2475" name="tip_2475">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-2475"></div> -->
   <div id="tip-2475" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">5</div>
   <div id="tip-2475" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-2475"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            IIS 7.0 can be installed unattended using one of 3 methods:<br />
-Pkgmgr.exe	(Works in Vista, Server 2008, and Server 2008 R2)<br />
-Servermanagercmd.exe	(Server 2008 and deprecated in Server 2008 R2) (not available in Vista or Seven)<br />
-ServerManager PowerShell cmdlets (Server 2008 R2 ONLY!!)<br />
<br />
In true MS form, MS has turned on the upgrade threadmill by scrapping the old sysocmgr.exe and its INF file. Now there are way more features to pick from than IIS 6.0 but NNTP is dropped and the SMTP is now separated from IIS and is now listed as a *feature* in Windows 2008's Server Manager. <br />
<br />
Other changes are explained here:<br />
http://blogs.technet.com/mscom/archive/2007/09/07/the-tasty-morsels-found-in-dogfood-mscom-ops-top-10-changes-in-iis7-0.aspx<br />
<br />
In either method, you can no longer specify where the files are to be installed at the onset. This is confirmed with the existence of a batch file to move ISS to another drive written by an IIS team member! Another thing that could be done is to format a new partition and instead of assigning it a drive letter, use the "mount in the following empty NTFS folder" option in disk management to host C:\inetpub before the install.  With the lack of ability to specify where to install ANY Service or Feature with the any of the 3 methods, it's as if MS is hinting that UNIX's way of partitions instead of drive letters is the way to go!<br />
<br />
All 3 methods share the same key words for installing Roles, Role Services and Features. The following methods work "as-is" on Server 2008 R1 except for PowerShell method which is Server 2008 R2 only. The names of the Roles, Role Services and Features have slightly changed from R1 to R2.<br />
<br />
**************<br />
The Pkgmgr.exe method is the simplest but you cannot install SMTP.<br />
It is explained here http://learn.iis.net/page.aspx/133/using-unattend-setup-to-install-iis-7/<br />
And http://learn.iis.net/page.aspx/132/install-iis-7-from-the-command-line/<br />
NOTE: It's very important that the Windows build version within the xml file (version="6.0.6001.16659") is the full version number of the OS, otherwise the xml file won't work.<br />
<br />
You can use the following to install ALL of  IIS' 7.0 features:<br />
-Create unattend.xml from:<br />
<br />
&lt;?xml version="1.0" ?&gt;<br />
&lt;!-- http://learn.iis.net/page.aspx/133/using-unattend-setup-to-install-iis-7/ --&gt;<br />
&lt;unattend xmlns="urn:schemas-microsoft-com:unattend"<br />
        xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"&gt;<br />
&lt;servicing&gt;<br />
      &lt;!-- Install a selectable update in a package that is in the Windows Foundation namespace --&gt;<br />
      &lt;package action="configure"&gt;<br />
            &lt;assemblyIdentity<br />
                  name="Microsoft-Windows-Foundation-Package"<br />
                  version="6.0.5308.6"<br />
                  language="neutral"<br />
                  processorArchitecture="x86"<br />
                  publicKeyToken="31bf3856ad364e35"<br />
                  versionScope="nonSxS"<br />
            /&gt;<br />
        &lt;selection name="IIS-WebServerRole" state="true"/&gt;<br />
        &lt;selection name="IIS-WebServer" state="true"/&gt;<br />
        &lt;selection name="IIS-CommonHttpFeatures" state="true"/&gt;<br />
        &lt;selection name="IIS-StaticContent" state="true"/&gt;<br />
        &lt;selection name="IIS-DefaultDocument" state="true"/&gt;<br />
        &lt;selection name="IIS-DirectoryBrowsing" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpErrors" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpRedirect" state="true"/&gt;<br />
        &lt;selection name="IIS-ApplicationDevelopment" state="true"/&gt;<br />
        &lt;selection name="IIS-ASPNET" state="true"/&gt;<br />
        &lt;selection name="IIS-NetFxExtensibility" state="true"/&gt;<br />
        &lt;selection name="IIS-ASP" state="true"/&gt;<br />
        &lt;selection name="IIS-CGI" state="true"/&gt;<br />
        &lt;selection name="IIS-ISAPIExtensions" state="true"/&gt;<br />
        &lt;selection name="IIS-ISAPIFilter" state="true"/&gt;<br />
        &lt;selection name="IIS-ServerSideIncludes" state="true"/&gt;<br />
        &lt;selection name="IIS-HealthAndDiagnostics" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpLogging" state="true"/&gt;<br />
        &lt;selection name="IIS-LoggingLibraries" state="true"/&gt;<br />
        &lt;selection name="IIS-RequestMonitor" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpTracing" state="true"/&gt;<br />
        &lt;selection name="IIS-CustomLogging" state="true"/&gt;<br />
        &lt;selection name="IIS-ODBCLogging" state="true"/&gt;<br />
        &lt;selection name="IIS-Security" state="true"/&gt;<br />
        &lt;selection name="IIS-BasicAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-WindowsAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-DigestAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-ClientCertificateMappingAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-IISCertificateMappingAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-URLAuthorization" state="true"/&gt;<br />
        &lt;selection name="IIS-RequestFiltering" state="true"/&gt;<br />
        &lt;selection name="IIS-IPSecurity" state="true"/&gt;<br />
        &lt;selection name="IIS-Performance" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpCompressionStatic" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpCompressionDynamic" state="true"/&gt;<br />
        &lt;selection name="IIS-WebServerManagementTools" state="true"/&gt;<br />
        &lt;selection name="IIS-ManagementConsole" state="true"/&gt;<br />
        &lt;selection name="IIS-ManagementScriptingTools" state="true"/&gt;<br />
        &lt;selection name="IIS-ManagementService" state="true"/&gt;<br />
        &lt;selection name="IIS-IIS6ManagementCompatibility" state="true"/&gt;<br />
        &lt;selection name="IIS-Metabase" state="true"/&gt;<br />
        &lt;selection name="IIS-WMICompatibility" state="true"/&gt;<br />
        &lt;selection name="IIS-LegacyScripts" state="true"/&gt;<br />
        &lt;selection name="IIS-LegacySnapIn" state="true"/&gt;<br />
        &lt;selection name="IIS-FTPPublishingService" state="true"/&gt;<br />
        &lt;selection name="IIS-FTPServer" state="true"/&gt;<br />
        &lt;selection name="IIS-FTPManagement" state="true"/&gt;<br />
        &lt;selection name="WAS-WindowsActivationService" state="true"/&gt;<br />
        &lt;selection name="WAS-ProcessModel" state="true"/&gt;<br />
        &lt;selection name="WAS-NetFxEnvironment" state="true"/&gt;<br />
        &lt;selection name="WAS-ConfigurationAPI" state="true"/&gt;<br />
    &lt;/package&gt;<br />
&lt;/servicing&gt;<br />
&lt;/unattend&gt;<br />
<br />
And then launch with:   start /w pkgmgr /n:unattend.xml<br />
<br />
<br />
You can also skip the XML file creation with this one liner:<br />
start /w pkgmgr /l:log.etw /iu:IIS-WebServerRole;IIS-WebServer;IIS-CommonHttpFeatures;IIS-StaticContent;IIS-DefaultDocument;IIS-DirectoryBrowsing;IIS-HttpErrors;IIS-HttpRedirect;IIS-ApplicationDevelopment;IIS-ASPNET;IIS-NetFxExtensibility;IIS-ASP;IIS-ISAPIExtensions;IIS-ISAPIFilter;IIS-ServerSideIncludes;IIS-HealthAndDiagnostics;IIS-HttpLogging;IIS-LoggingLibraries;IIS-RequestMonitor;IIS-HttpTracing;IIS-Security;IIS-ClientCertificateMappingAuthentication;IIS-IISCertificateMappingAuthentication;IIS-RequestFiltering;IIS-IPSecurity;IIS-Performance;IIS-HttpCompressionStatic;IIS-HttpCompressionDynamic;IIS-WebServerManagementTools;IIS-ManagementConsole;IIS-ManagementScriptingTools;IIS-ManagementService;IIS-IIS6ManagementCompatibility;IIS-Metabase;IIS-WMICompatibility;IIS-LegacyScripts;IIS-LegacySnapIn;WAS-WindowsActivationService;WAS-ProcessModel;WAS-NetFxEnvironment;WAS-ConfigurationAPI<br />
<br />
Now this will install IIS but ONLY on the %SystemDrive% ( C:\ drive).<br />
See the batch file in the next section on how to move it to another drive letter.<br />
<br />
******************<br />
The Servermanagercmd.exe will not work in a workstation OS (Vista or Seven) but will be able to install SMTP and any other Features/server Roles you wish at the same time as IIS 7.0. The catch is that MS has deprecated (aka "to be phased out later") in Windows server 2008 R2.<br />
<br />
Syntax is as follows:<br />
ServerManagerCmd.exe -query [&lt;query.xml&gt;] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe -inputPath &lt;answer.xml&gt; [-resultPath &lt;result.xml&gt; [-restart] | -whatIf] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe -install &lt;command-Id&gt; [-setting &lt;setting-name&gt;=&lt;setting value&gt;][-allSubFeatures] [-resultPath &lt;result.xml&gt; [-restart] | -whatIf] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe -remove &lt;command-Id&gt; [-resultPath &lt;result.xml&gt; [-restart] | -whatIf] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe [-help | -?]<br />
<br />
Every time you launch it or its GUI counterpart it updates a log in: C:\windows\LOGS\ServerManager.log<br />
<br />
The hardest thing to figure out is the difference between a Role, Role Services and Features.<br />
A Role is a grouping of Role Services. Features are basically Services that have not been grouped under a Role. Role Services can also be part of other Roles. If you specify to install a Role (e.g. Web-Server for IIS 7), its default Role Services will be installed. You can get a full list here: http://technet.microsoft.com/en-us/library/cc875805(WS.10).aspx  (Well, at least it was here Aug 28, 2009) but notice they don't tell you which is the "Role" and which is the "Role Service". Since itÃ¢Â€Â™s Trial and Error, use the -whatif parameter. You can also get a hint as what is a Role Service by running:  ServerManagerCmd.exe -query<br />
<br />
Notice that Sub-Roles also exists (e.g. Web-App-Development)<br />
<br />
This will install IIS 7.0 (aka the Web-Server "role") without SMTP:<br />
ServerManagerCmd.exe -install Web-Server -allSubFeatures -resultPath C:\TEMP\WebServer.xml -restart<br />
<br />
To install IIS 7.0 with default "role services" plus the SMTP "Feature", create IIS7_w_SMTP.xml with the following:<br />
&lt;ServerManagerConfiguration Action="Install" xmlns="http://schemas.microsoft.com/sdm/Windows/ServerManager/Configuration/2007/1"&gt;<br />
&lt;Role Id="Web-Server"/&gt;<br />
&lt;Feature Id="SMTP-Server"/&gt;<br />
&lt;/ServerManagerConfiguration&gt;<br />
<br />
Then launch:<br />
ServerManagerCmd.exe -inputPath .\IIS7_w_SMTP.xml -resultPath .\IIS7_Log_file.xml<br />
<br />
Other things to remember: <br />
-If you want to install IIS with your selection of Role Services, don't mention the Web-Server Role or Sub-Roles, just the "Role Services" themselves.<br />
-You cannot have comments in the xml file (e.g. - &lt;!--  ====== --&gt;  ) in R1. They are, however, allowed in R2. (Go figure!)<br />
<br />
<br />
To install IIS 7.0 with ALL "Role Services" plus the SMTP "Feature", create IIS7_w_SMTP.xml with the following:<br />
&lt;ServerManagerConfiguration Action="Install" xmlns="http://schemas.microsoft.com/sdm/Windows/ServerManager/Configuration/2007/1"&gt;<br />
&lt;RoleService Id="Web-WebServer"/&gt;<br />
&lt;RoleService Id="Web-Common-Http"/&gt;<br />
&lt;RoleService Id="Web-Static-Content"/&gt;<br />
&lt;RoleService Id="Web-Default-Doc"/&gt;<br />
&lt;RoleService Id="Web-Dir-Browsing"/&gt;<br />
&lt;RoleService Id="Web-Http-Errors"/&gt;<br />
&lt;RoleService Id="Web-Http-Redirect"/&gt;<br />
&lt;RoleService Id="Web-Asp-Net"/&gt;<br />
&lt;RoleService Id="Web-Net-Ext"/&gt;<br />
&lt;RoleService Id="Web-ASP"/&gt;<br />
&lt;RoleService Id="Web-CGI"/&gt;<br />
&lt;RoleService Id="Web-ISAPI-Ext"/&gt;<br />
&lt;RoleService Id="Web-ISAPI-Filter"/&gt;<br />
&lt;RoleService Id="Web-Includes"/&gt;<br />
&lt;RoleService Id="Web-Health"/&gt;<br />
&lt;RoleService Id="Web-Http-Logging"/&gt;<br />
&lt;RoleService Id="Web-Log-Libraries"/&gt;<br />
&lt;RoleService Id="Web-Request-Monitor"/&gt;<br />
&lt;RoleService Id="Web-Http-Tracing"/&gt;<br />
&lt;RoleService Id="Web-Custom-Logging"/&gt;<br />
&lt;RoleService Id="Web-ODBC-Logging"/&gt;<br />
&lt;RoleService Id="Web-Security"/&gt;<br />
&lt;RoleService Id="Web-Basic-Auth"/&gt;<br />
&lt;RoleService Id="Web-Windows-Auth"/&gt;<br />
&lt;RoleService Id="Web-Digest-Auth"/&gt;<br />
&lt;RoleService Id="Web-Client-Auth"/&gt;<br />
&lt;RoleService Id="Web-Cert-Auth"/&gt;<br />
&lt;RoleService Id="Web-Url-Auth"/&gt;<br />
&lt;RoleService Id="Web-Filtering"/&gt;<br />
&lt;RoleService Id="Web-IP-Security"/&gt;<br />
&lt;RoleService Id="Web-Performance"/&gt;<br />
&lt;RoleService Id="Web-Stat-Compression"/&gt;<br />
&lt;RoleService Id="Web-Dyn-Compression"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Tools"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Console"/&gt;<br />
&lt;RoleService Id="Web-Scripting-Tools"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Service"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Compat"/&gt;<br />
&lt;RoleService Id="Web-Metabase"/&gt;<br />
&lt;RoleService Id="Web-WMI"/&gt;<br />
&lt;RoleService Id="Web-Lgcy-Scripting"/&gt;<br />
&lt;RoleService Id="Web-Lgcy-Mgmt-Console"/&gt;<br />
&lt;RoleService Id="Web-Ftp-Publishing"/&gt;<br />
&lt;RoleService Id="Web-Ftp-Server"/&gt;<br />
&lt;RoleService Id="Web-Ftp-Mgmt-Console"/&gt;<br />
&lt;Feature Id="SMTP-Server"/&gt;<br />
&lt;/ServerManagerConfiguration&gt;<br />
<br />
<br />
Now this will install IIS but ONLY on the %SystemDrive% ( C:\ drive).<br />
http://blogs.iis.net/thomad/archive/2008/02/10/moving-the-iis7-inetpub-directory-to-a-different-drive.aspx<br />
Here, Thomas Deml, an ISS team member shares a script to move the IIS INETPUB folder *after* it is installed. What follows is that script (with a bug fix) since MS' web sites are made of vapour and disappears on a whim:<br />
<br />
&lt;&lt; Start of moveiis7root.bat &gt;&gt;<br />
@echo off<br />
IF "%1" == "" goto err<br />
setlocal<br />
set MOVETO=%1:\<br />
<br />
REM simple error handling if drive does not exist or argument is wrong <br />
IF NOT EXIST %MOVETO% goto err<br />
<br />
REM Backup IIS config before we start changing config to point to the new path<br />
%windir%\system32\inetsrv\appcmd add backup beforeRootMove<br />
<br />
<br />
REM Stop all IIS services<br />
iisreset /stop<br />
<br />
REM Copy all content <br />
REM /O - copy ACLs<br />
REM /E - copy sub directories including empty ones<br />
REM /I - assume destination is a directory<br />
REM /Q - quiet<br />
<br />
REM echo on, because user will be prompted if content already exists.<br />
echo on<br />
xcopy %systemdrive%\inetpub %MOVETO%inetpub /O /E /I /Q<br />
@echo off<br />
REM Move AppPool isolation directory <br />
reg add HKLM\System\CurrentControlSet\Services\WAS\Parameters /v ConfigIsolationPath /t REG_SZ /d %MOVETO%inetpub\temp\appPools /f<br />
<br />
REM Move logfile directories<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/sites -siteDefaults.traceFailedRequestsLogging.directory:"%MOVETO%inetpub\logs\FailedReqLogFiles"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/sites -siteDefaults.logfile.directory:"%MOVETO%inetpub\logs\logfiles"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/log -centralBinaryLogFile.directory:"%MOVETO%inetpub\logs\logfiles"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/log -centralW3CLogFile.directory:"%MOVETO%inetpub\logs\logfiles"<br />
<br />
REM Move config history location, temporary files, the path for the Default Web Site and the custom error locations<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationhost/configHistory -path:%MOVETO%inetpub\history<br />
%windir%\system32\inetsrv\appcmd set config -section:system.webServer/asp -cache.disktemplateCacheDirectory:"%MOVETO%inetpub\temp\ASP Compiled Templates"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.webServer/httpCompression -directory:"%MOVETO%inetpub\temp\IIS Temporary Compressed Files"<br />
%windir%\system32\inetsrv\appcmd set vdir "Default Web Site/" -physicalPath:%MOVETO%inetpub\wwwroot<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='401'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='403'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='404'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='405'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='406'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='412'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='500'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='501'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='502'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
<br />
REM Make sure Service Pack and Hotfix Installers know where the IIS root directories are<br />
reg add HKLM\Software\Microsoft\inetstp /v PathWWWRoot /t REG_SZ /d %moveto%inetpub\wwwroot /f<br />
reg add HKLM\Software\Microsoft\inetstp /v PathFTPRoot /t REG_SZ /d %moveto%inetpub\ftproot /f<br />
<br />
REM Restart all IIS services<br />
iisreset /start<br />
echo.<br />
echo.<br />
echo ===============================================================================<br />
echo Moved IIS7 root directory from %systemdrive%\ to %MOVETO%.<br />
echo.<br />
echo Please verify if the move worked. If so you can delete the %systemdrive%\inetpub directory.<br />
echo If something went wrong you can restore the old settings via <br />
echo     "APPCMD restore backup beforeRootMove" <br />
echo and <br />
echo     "REG delete HKLM\System\CurrentControlSet\Services\WAS\Parameters\ConfigIsolationPath"<br />
echo You also have to reset the PathWWWRoot and PathFTPRoot registry values<br />
echo in HKEY_LOCAL_MACHINE\Software\Microsoft\InetStp.<br />
echo ===============================================================================<br />
echo.<br />
echo.<br />
endlocal<br />
goto success<br />
<br />
REM error message if no argument or drive does not exist<br />
:err<br />
echo. <br />
echo New root drive letter required. <br />
echo Here an example how to move the IIS root to the F:\ drive:<br />
echo. <br />
echo MOVEIISROOT.BAT F<br />
echo.<br />
echo. <br />
<br />
:success<br />
&lt;&lt; End of moveiis7root.bat &gt;&gt;<br />
<br />
AppCMD.exe can be used to tweak some more after the install is completed but I digress.<br />
http://blogs.iis.net/webdevelopertips/archive/2009/01/11/tip-42-did-you-know-configurationeditor-allows-you-to-generate-c-javascript-or-appcmd-script-to-update-configuration.aspx<br />
<br />
<br />
**************<br />
If you have the RTM version of Windows Server 2008 R2 then you can also use PowerShell.<br />
To launch PowerShell 2.0 from the command-line type:  POWERSHELL<br />
        * Import the Server Manager Module with: Import-Module ServerManager<br />
        * You will get the following cmdlets to list/add/remove features and roles:<br />
                    Get-WindowsFeature --&gt; lists available/Installed features and roles<br />
                    Add-WindowsFeature --&gt; installs a feature or role<br />
                    Remove-WindowsFeature --&gt; removes a feature or role<br />
The rest is poorly documented right now but it seems to borrow heavily from the 2 previous methods.<br />
<br />
http://technet.microsoft.com/en-us/library/cc732757.aspx<br />
<br />
At this time, there is no PowerShell script to install IIS 7.0 so here is the one I wrote:<br />
<br />
# Installs IIS 7.0 with ALL Role-Services Plus SMTP feature<br />
# Creates a log file in the same folder as this script<br />
# CAVEAT: This *ONLY* works on Windows server 2008 R2 (and later?)<br />
#<br />
#<br />
# To Run this Powershell script<br />
# Step 1: Allow Powershell scripts to run<br />
#	Start -&gt; Run<br />
#	Type: PowerShell &lt;Press Enter&gt;<br />
#	Type: Set-ExecutionPolicy Unrestricted &lt;Press Enter&gt;<br />
#	Type: &lt;Press Enter&gt;<br />
#<br />
# Step 2: Run this Powershell Script <br />
#	From the PowerShell Prompt<br />
#		Browse to the folder where this Powershell Script is located<br />
#		Type: . &lt;name of this Script&gt;<br />
# 	OR<br />
#<br />
#	Right-click on the Powershell Script file (*.ps1)<br />
#		Select "Run with PowerShell"<br />
#<br />
# Powershell Tip: Do not point Add-WindowsFeature's -logPath and redirection (&gt;&gt; $LogFile) to the same file<br />
# 	Powershell gets confused as to what encoding to use (ANSI/UTF-8) and you will get Chinese characters!?!<br />
#	Use "transcript" instead as done below.<br />
#	NOTE: for some reasons it talks about "activities not shown..."<br />
#<br />
<br />
#Make $LogFile match the Powershell script name with a date and time stamp followed by ".log"<br />
$dt = Get-Date -format "yyyyMMdd_hhmm"<br />
$LogFile  = ($MyInvocation.MyCommand.Name).Replace(".ps1","_$dt.log")<br />
<br />
<br />
start-transcript $LogFile 	#start the transcript (aka Logging)<br />
trap { stop-transcript; break}	#error trapping code to stop the transcript and break out of script<br />
								#(alternatively could use "continue" execution) <br />
<br />
<br />
# Load ServerManager Powershell module <br />
Import-Module ServerManager<br />
<br />
Add-WindowsFeature -Name Web-WebServer<br />
Add-WindowsFeature -Name Web-Common-Http<br />
Add-WindowsFeature -Name Web-Static-Content<br />
Add-WindowsFeature -Name Web-Default-Doc<br />
Add-WindowsFeature -Name Web-Dir-Browsing<br />
Add-WindowsFeature -Name Web-Http-Errors<br />
Add-WindowsFeature -Name Web-Http-Redirect<br />
Add-WindowsFeature -Name Web-DAV-Publishing<br />
Add-WindowsFeature -Name Web-Asp-Net<br />
Add-WindowsFeature -Name Web-Net-Ext<br />
Add-WindowsFeature -Name Web-ASP<br />
Add-WindowsFeature -Name Web-CGI<br />
Add-WindowsFeature -Name Web-ISAPI-Ext<br />
Add-WindowsFeature -Name Web-ISAPI-Filter<br />
Add-WindowsFeature -Name Web-Includes<br />
Add-WindowsFeature -Name Web-Health<br />
Add-WindowsFeature -Name Web-Http-Logging<br />
Add-WindowsFeature -Name Web-Log-Libraries<br />
Add-WindowsFeature -Name Web-Request-Monitor<br />
Add-WindowsFeature -Name Web-Http-Tracing<br />
Add-WindowsFeature -Name Web-Custom-Logging<br />
Add-WindowsFeature -Name Web-ODBC-Logging<br />
Add-WindowsFeature -Name Web-Security<br />
Add-WindowsFeature -Name Web-Basic-Auth<br />
Add-WindowsFeature -Name Web-Windows-Auth<br />
Add-WindowsFeature -Name Web-Digest-Auth<br />
Add-WindowsFeature -Name Web-Client-Auth<br />
Add-WindowsFeature -Name Web-Cert-Auth<br />
Add-WindowsFeature -Name Web-Url-Auth<br />
Add-WindowsFeature -Name Web-Filtering<br />
Add-WindowsFeature -Name Web-IP-Security<br />
Add-WindowsFeature -Name Web-Performance<br />
Add-WindowsFeature -Name Web-Stat-Compression<br />
Add-WindowsFeature -Name Web-Dyn-Compression<br />
Add-WindowsFeature -Name Web-Mgmt-Tools<br />
Add-WindowsFeature -Name Web-Mgmt-Console<br />
Add-WindowsFeature -Name Web-Scripting-Tools<br />
Add-WindowsFeature -Name Web-Mgmt-Service<br />
Add-WindowsFeature -Name Web-Mgmt-Compat<br />
Add-WindowsFeature -Name Web-Metabase<br />
Add-WindowsFeature -Name Web-WMI<br />
Add-WindowsFeature -Name Web-Lgcy-Scripting<br />
Add-WindowsFeature -Name Web-Lgcy-Mgmt-Console<br />
Add-WindowsFeature -Name Web-Ftp-Server<br />
Add-WindowsFeature -Name Web-WHC<br />
<br />
Add-WindowsFeature -Name SMTP-Server<br />
<br />
stop-transcript #stop the transcript (aka Logging)<br />
<br />
#pause 50 Seconds (There is no "PAUSE" in PS, thx MS!)<br />
Start-sleep -s 50<br />
<br />
<br />
You are still able to use AppCMD.exe to tweak after install (e.g. the batch file to move c:\ inetpub) but it is rumoured that it will also be assimilated into a PowerSmell module.<br />

            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/misterd" class="username" rel="nofollow">misterd</a>
                </li>
                <li>
                    10/27/2009 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_6113" name="tip_6113">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-6113"></div> -->
   <div id="tip-6113" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">5</div>
   <div id="tip-6113" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-6113"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            IIS 7.0 can be installed unattended using one of 3 methods:<br />
-Pkgmgr.exe	(Works in Vista, Server 2008, and Server 2008 R2)<br />
-Servermanagercmd.exe	(Server 2008 and deprecated in Server 2008 R2) (not available in Vista or Seven)<br />
-ServerManager PowerShell cmdlets (Server 2008 R2 ONLY!!)<br />
<br />
In true MS form, MS has turned on the upgrade threadmill by scrapping the old sysocmgr.exe and its INF file. Now there are way more features to pick from than IIS 6.0 but NNTP is dropped and the SMTP is now separated from IIS and is now listed as a *feature* in Windows 2008's Server Manager. <br />
<br />
Other changes are explained here:<br />
http://blogs.technet.com/mscom/archive/2007/09/07/the-tasty-morsels-found-in-dogfood-mscom-ops-top-10-changes-in-iis7-0.aspx<br />
<br />
In either method, you can no longer specify where the files are to be installed at the onset. This is confirmed with the existence of a batch file to move ISS to another drive written by an IIS team member! Another thing that could be done is to format a new partition and instead of assigning it a drive letter, use the "mount in the following empty NTFS folder" option in disk management to host C:\inetpub before the install.  With the lack of ability to specify where to install ANY Service or Feature with the any of the 3 methods, it's as if MS is hinting that UNIX's way of partitions instead of drive letters is the way to go!<br />
<br />
All 3 methods share the same key words for installing Roles, Role Services and Features. The following methods work "as-is" on Server 2008 R1 except for PowerShell method which is Server 2008 R2 only. The names of the Roles, Role Services and Features have slightly changed from R1 to R2.<br />
<br />
**************<br />
The Pkgmgr.exe method is the simplest but you cannot install SMTP.<br />
It is explained here http://learn.iis.net/page.aspx/133/using-unattend-setup-to-install-iis-7/<br />
And http://learn.iis.net/page.aspx/132/install-iis-7-from-the-command-line/<br />
NOTE: It's very important that the Windows build version within the xml file (version="6.0.6001.16659") is the full version number of the OS, otherwise the xml file won't work.<br />
<br />
You can use the following to install ALL of  IIS' 7.0 features:<br />
-Create unattend.xml from:<br />
<br />
&lt;?xml version="1.0" ?&gt;<br />
&lt;!-- http://learn.iis.net/page.aspx/133/using-unattend-setup-to-install-iis-7/ --&gt;<br />
&lt;unattend xmlns="urn:schemas-microsoft-com:unattend"<br />
        xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"&gt;<br />
&lt;servicing&gt;<br />
      &lt;!-- Install a selectable update in a package that is in the Windows Foundation namespace --&gt;<br />
      &lt;package action="configure"&gt;<br />
            &lt;assemblyIdentity<br />
                  name="Microsoft-Windows-Foundation-Package"<br />
                  version="6.0.5308.6"<br />
                  language="neutral"<br />
                  processorArchitecture="x86"<br />
                  publicKeyToken="31bf3856ad364e35"<br />
                  versionScope="nonSxS"<br />
            /&gt;<br />
        &lt;selection name="IIS-WebServerRole" state="true"/&gt;<br />
        &lt;selection name="IIS-WebServer" state="true"/&gt;<br />
        &lt;selection name="IIS-CommonHttpFeatures" state="true"/&gt;<br />
        &lt;selection name="IIS-StaticContent" state="true"/&gt;<br />
        &lt;selection name="IIS-DefaultDocument" state="true"/&gt;<br />
        &lt;selection name="IIS-DirectoryBrowsing" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpErrors" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpRedirect" state="true"/&gt;<br />
        &lt;selection name="IIS-ApplicationDevelopment" state="true"/&gt;<br />
        &lt;selection name="IIS-ASPNET" state="true"/&gt;<br />
        &lt;selection name="IIS-NetFxExtensibility" state="true"/&gt;<br />
        &lt;selection name="IIS-ASP" state="true"/&gt;<br />
        &lt;selection name="IIS-CGI" state="true"/&gt;<br />
        &lt;selection name="IIS-ISAPIExtensions" state="true"/&gt;<br />
        &lt;selection name="IIS-ISAPIFilter" state="true"/&gt;<br />
        &lt;selection name="IIS-ServerSideIncludes" state="true"/&gt;<br />
        &lt;selection name="IIS-HealthAndDiagnostics" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpLogging" state="true"/&gt;<br />
        &lt;selection name="IIS-LoggingLibraries" state="true"/&gt;<br />
        &lt;selection name="IIS-RequestMonitor" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpTracing" state="true"/&gt;<br />
        &lt;selection name="IIS-CustomLogging" state="true"/&gt;<br />
        &lt;selection name="IIS-ODBCLogging" state="true"/&gt;<br />
        &lt;selection name="IIS-Security" state="true"/&gt;<br />
        &lt;selection name="IIS-BasicAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-WindowsAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-DigestAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-ClientCertificateMappingAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-IISCertificateMappingAuthentication" state="true"/&gt;<br />
        &lt;selection name="IIS-URLAuthorization" state="true"/&gt;<br />
        &lt;selection name="IIS-RequestFiltering" state="true"/&gt;<br />
        &lt;selection name="IIS-IPSecurity" state="true"/&gt;<br />
        &lt;selection name="IIS-Performance" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpCompressionStatic" state="true"/&gt;<br />
        &lt;selection name="IIS-HttpCompressionDynamic" state="true"/&gt;<br />
        &lt;selection name="IIS-WebServerManagementTools" state="true"/&gt;<br />
        &lt;selection name="IIS-ManagementConsole" state="true"/&gt;<br />
        &lt;selection name="IIS-ManagementScriptingTools" state="true"/&gt;<br />
        &lt;selection name="IIS-ManagementService" state="true"/&gt;<br />
        &lt;selection name="IIS-IIS6ManagementCompatibility" state="true"/&gt;<br />
        &lt;selection name="IIS-Metabase" state="true"/&gt;<br />
        &lt;selection name="IIS-WMICompatibility" state="true"/&gt;<br />
        &lt;selection name="IIS-LegacyScripts" state="true"/&gt;<br />
        &lt;selection name="IIS-LegacySnapIn" state="true"/&gt;<br />
        &lt;selection name="IIS-FTPPublishingService" state="true"/&gt;<br />
        &lt;selection name="IIS-FTPServer" state="true"/&gt;<br />
        &lt;selection name="IIS-FTPManagement" state="true"/&gt;<br />
        &lt;selection name="WAS-WindowsActivationService" state="true"/&gt;<br />
        &lt;selection name="WAS-ProcessModel" state="true"/&gt;<br />
        &lt;selection name="WAS-NetFxEnvironment" state="true"/&gt;<br />
        &lt;selection name="WAS-ConfigurationAPI" state="true"/&gt;<br />
    &lt;/package&gt;<br />
&lt;/servicing&gt;<br />
&lt;/unattend&gt;<br />
<br />
And then launch with:   start /w pkgmgr /n:unattend.xml<br />
<br />
<br />
You can also skip the XML file creation with this one liner:<br />
start /w pkgmgr /l:log.etw /iu:IIS-WebServerRole;IIS-WebServer;IIS-CommonHttpFeatures;IIS-StaticContent;IIS-DefaultDocument;IIS-DirectoryBrowsing;IIS-HttpErrors;IIS-HttpRedirect;IIS-ApplicationDevelopment;IIS-ASPNET;IIS-NetFxExtensibility;IIS-ASP;IIS-ISAPIExtensions;IIS-ISAPIFilter;IIS-ServerSideIncludes;IIS-HealthAndDiagnostics;IIS-HttpLogging;IIS-LoggingLibraries;IIS-RequestMonitor;IIS-HttpTracing;IIS-Security;IIS-ClientCertificateMappingAuthentication;IIS-IISCertificateMappingAuthentication;IIS-RequestFiltering;IIS-IPSecurity;IIS-Performance;IIS-HttpCompressionStatic;IIS-HttpCompressionDynamic;IIS-WebServerManagementTools;IIS-ManagementConsole;IIS-ManagementScriptingTools;IIS-ManagementService;IIS-IIS6ManagementCompatibility;IIS-Metabase;IIS-WMICompatibility;IIS-LegacyScripts;IIS-LegacySnapIn;WAS-WindowsActivationService;WAS-ProcessModel;WAS-NetFxEnvironment;WAS-ConfigurationAPI<br />
<br />
Now this will install IIS but ONLY on the %SystemDrive% ( C:\ drive).<br />
See the batch file in the next section on how to move it to another drive letter.<br />
<br />
******************<br />
The Servermanagercmd.exe will not work in a workstation OS (Vista or Seven) but will be able to install SMTP and any other Features/server Roles you wish at the same time as IIS 7.0. The catch is that MS has deprecated (aka "to be phased out later") in Windows server 2008 R2.<br />
<br />
Syntax is as follows:<br />
ServerManagerCmd.exe -query [&lt;query.xml&gt;] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe -inputPath &lt;answer.xml&gt; [-resultPath &lt;result.xml&gt; [-restart] | -whatIf] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe -install &lt;command-Id&gt; [-setting &lt;setting-name&gt;=&lt;setting value&gt;][-allSubFeatures] [-resultPath &lt;result.xml&gt; [-restart] | -whatIf] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe -remove &lt;command-Id&gt; [-resultPath &lt;result.xml&gt; [-restart] | -whatIf] [-logPath &lt;log.txt&gt;]<br />
ServerManagerCmd.exe [-help | -?]<br />
<br />
Every time you launch it or its GUI counterpart it updates a log in: C:\windows\LOGS\ServerManager.log<br />
<br />
The hardest thing to figure out is the difference between a Role, Role Services and Features.<br />
A Role is a grouping of Role Services. Features are basically Services that have not been grouped under a Role. Role Services can also be part of other Roles. If you specify to install a Role (e.g. Web-Server for IIS 7), its default Role Services will be installed. You can get a full list here: http://technet.microsoft.com/en-us/library/cc875805(WS.10).aspx  (Well, at least it was here Aug 28, 2009) but notice they don't tell you which is the "Role" and which is the "Role Service". Since itâs Trial and Error, use the -whatif parameter. You can also get a hint as what is a Role Service by running:  ServerManagerCmd.exe -query<br />
<br />
Notice that Sub-Roles also exists (e.g. Web-App-Development)<br />
<br />
This will install IIS 7.0 (aka the Web-Server "role") without SMTP:<br />
ServerManagerCmd.exe -install Web-Server -allSubFeatures -resultPath C:\TEMP\WebServer.xml -restart<br />
<br />
To install IIS 7.0 with default "role services" plus the SMTP "Feature", create IIS7_w_SMTP.xml with the following:<br />
&lt;ServerManagerConfiguration Action="Install" xmlns="http://schemas.microsoft.com/sdm/Windows/ServerManager/Configuration/2007/1"&gt;<br />
&lt;Role Id="Web-Server"/&gt;<br />
&lt;Feature Id="SMTP-Server"/&gt;<br />
&lt;/ServerManagerConfiguration&gt;<br />
<br />
Then launch:<br />
ServerManagerCmd.exe -inputPath .\IIS7_w_SMTP.xml -resultPath .\IIS7_Log_file.xml<br />
<br />
Other things to remember: <br />
-If you want to install IIS with your selection of Role Services, don't mention the Web-Server Role or Sub-Roles, just the "Role Services" themselves.<br />
-You cannot have comments in the xml file (e.g. - &lt;!--  ====== --&gt;  ) in R1. They are, however, allowed in R2. (Go figure!)<br />
<br />
<br />
To install IIS 7.0 with ALL "Role Services" plus the SMTP "Feature", create IIS7_w_SMTP.xml with the following:<br />
&lt;ServerManagerConfiguration Action="Install" xmlns="http://schemas.microsoft.com/sdm/Windows/ServerManager/Configuration/2007/1"&gt;<br />
&lt;RoleService Id="Web-WebServer"/&gt;<br />
&lt;RoleService Id="Web-Common-Http"/&gt;<br />
&lt;RoleService Id="Web-Static-Content"/&gt;<br />
&lt;RoleService Id="Web-Default-Doc"/&gt;<br />
&lt;RoleService Id="Web-Dir-Browsing"/&gt;<br />
&lt;RoleService Id="Web-Http-Errors"/&gt;<br />
&lt;RoleService Id="Web-Http-Redirect"/&gt;<br />
&lt;RoleService Id="Web-Asp-Net"/&gt;<br />
&lt;RoleService Id="Web-Net-Ext"/&gt;<br />
&lt;RoleService Id="Web-ASP"/&gt;<br />
&lt;RoleService Id="Web-CGI"/&gt;<br />
&lt;RoleService Id="Web-ISAPI-Ext"/&gt;<br />
&lt;RoleService Id="Web-ISAPI-Filter"/&gt;<br />
&lt;RoleService Id="Web-Includes"/&gt;<br />
&lt;RoleService Id="Web-Health"/&gt;<br />
&lt;RoleService Id="Web-Http-Logging"/&gt;<br />
&lt;RoleService Id="Web-Log-Libraries"/&gt;<br />
&lt;RoleService Id="Web-Request-Monitor"/&gt;<br />
&lt;RoleService Id="Web-Http-Tracing"/&gt;<br />
&lt;RoleService Id="Web-Custom-Logging"/&gt;<br />
&lt;RoleService Id="Web-ODBC-Logging"/&gt;<br />
&lt;RoleService Id="Web-Security"/&gt;<br />
&lt;RoleService Id="Web-Basic-Auth"/&gt;<br />
&lt;RoleService Id="Web-Windows-Auth"/&gt;<br />
&lt;RoleService Id="Web-Digest-Auth"/&gt;<br />
&lt;RoleService Id="Web-Client-Auth"/&gt;<br />
&lt;RoleService Id="Web-Cert-Auth"/&gt;<br />
&lt;RoleService Id="Web-Url-Auth"/&gt;<br />
&lt;RoleService Id="Web-Filtering"/&gt;<br />
&lt;RoleService Id="Web-IP-Security"/&gt;<br />
&lt;RoleService Id="Web-Performance"/&gt;<br />
&lt;RoleService Id="Web-Stat-Compression"/&gt;<br />
&lt;RoleService Id="Web-Dyn-Compression"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Tools"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Console"/&gt;<br />
&lt;RoleService Id="Web-Scripting-Tools"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Service"/&gt;<br />
&lt;RoleService Id="Web-Mgmt-Compat"/&gt;<br />
&lt;RoleService Id="Web-Metabase"/&gt;<br />
&lt;RoleService Id="Web-WMI"/&gt;<br />
&lt;RoleService Id="Web-Lgcy-Scripting"/&gt;<br />
&lt;RoleService Id="Web-Lgcy-Mgmt-Console"/&gt;<br />
&lt;RoleService Id="Web-Ftp-Publishing"/&gt;<br />
&lt;RoleService Id="Web-Ftp-Server"/&gt;<br />
&lt;RoleService Id="Web-Ftp-Mgmt-Console"/&gt;<br />
&lt;Feature Id="SMTP-Server"/&gt;<br />
&lt;/ServerManagerConfiguration&gt;<br />
<br />
<br />
Now this will install IIS but ONLY on the %SystemDrive% ( C:\ drive).<br />
http://blogs.iis.net/thomad/archive/2008/02/10/moving-the-iis7-inetpub-directory-to-a-different-drive.aspx<br />
Here, Thomas Deml, an ISS team member shares a script to move the IIS INETPUB folder *after* it is installed. What follows is that script (with a bug fix) since MS' web sites are made of vapour and disappears on a whim:<br />
<br />
&lt;&lt; Start of moveiis7root.bat &gt;&gt;<br />
@echo off<br />
IF "%1" == "" goto err<br />
setlocal<br />
set MOVETO=%1:\<br />
<br />
REM simple error handling if drive does not exist or argument is wrong <br />
IF NOT EXIST %MOVETO% goto err<br />
<br />
REM Backup IIS config before we start changing config to point to the new path<br />
%windir%\system32\inetsrv\appcmd add backup beforeRootMove<br />
<br />
<br />
REM Stop all IIS services<br />
iisreset /stop<br />
<br />
REM Copy all content <br />
REM /O - copy ACLs<br />
REM /E - copy sub directories including empty ones<br />
REM /I - assume destination is a directory<br />
REM /Q - quiet<br />
<br />
REM echo on, because user will be prompted if content already exists.<br />
echo on<br />
xcopy %systemdrive%\inetpub %MOVETO%inetpub /O /E /I /Q<br />
@echo off<br />
REM Move AppPool isolation directory <br />
reg add HKLM\System\CurrentControlSet\Services\WAS\Parameters /v ConfigIsolationPath /t REG_SZ /d %MOVETO%inetpub\temp\appPools /f<br />
<br />
REM Move logfile directories<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/sites -siteDefaults.traceFailedRequestsLogging.directory:"%MOVETO%inetpub\logs\FailedReqLogFiles"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/sites -siteDefaults.logfile.directory:"%MOVETO%inetpub\logs\logfiles"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/log -centralBinaryLogFile.directory:"%MOVETO%inetpub\logs\logfiles"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/log -centralW3CLogFile.directory:"%MOVETO%inetpub\logs\logfiles"<br />
<br />
REM Move config history location, temporary files, the path for the Default Web Site and the custom error locations<br />
%windir%\system32\inetsrv\appcmd set config -section:system.applicationhost/configHistory -path:%MOVETO%inetpub\history<br />
%windir%\system32\inetsrv\appcmd set config -section:system.webServer/asp -cache.disktemplateCacheDirectory:"%MOVETO%inetpub\temp\ASP Compiled Templates"<br />
%windir%\system32\inetsrv\appcmd set config -section:system.webServer/httpCompression -directory:"%MOVETO%inetpub\temp\IIS Temporary Compressed Files"<br />
%windir%\system32\inetsrv\appcmd set vdir "Default Web Site/" -physicalPath:%MOVETO%inetpub\wwwroot<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='401'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='403'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='404'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='405'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='406'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='412'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='500'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='501'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
%windir%\system32\inetsrv\appcmd set config -section:httpErrors /[statusCode='502'].prefixLanguageFilePath:%MOVETO%inetpub\custerr<br />
<br />
REM Make sure Service Pack and Hotfix Installers know where the IIS root directories are<br />
reg add HKLM\Software\Microsoft\inetstp /v PathWWWRoot /t REG_SZ /d %moveto%inetpub\wwwroot /f<br />
reg add HKLM\Software\Microsoft\inetstp /v PathFTPRoot /t REG_SZ /d %moveto%inetpub\ftproot /f<br />
<br />
REM Restart all IIS services<br />
iisreset /start<br />
echo.<br />
echo.<br />
echo ===============================================================================<br />
echo Moved IIS7 root directory from %systemdrive%\ to %MOVETO%.<br />
echo.<br />
echo Please verify if the move worked. If so you can delete the %systemdrive%\inetpub directory.<br />
echo If something went wrong you can restore the old settings via <br />
echo     "APPCMD restore backup beforeRootMove" <br />
echo and <br />
echo     "REG delete HKLM\System\CurrentControlSet\Services\WAS\Parameters\ConfigIsolationPath"<br />
echo You also have to reset the PathWWWRoot and PathFTPRoot registry values<br />
echo in HKEY_LOCAL_MACHINE\Software\Microsoft\InetStp.<br />
echo ===============================================================================<br />
echo.<br />
echo.<br />
endlocal<br />
goto success<br />
<br />
REM error message if no argument or drive does not exist<br />
:err<br />
echo. <br />
echo New root drive letter required. <br />
echo Here an example how to move the IIS root to the F:\ drive:<br />
echo. <br />
echo MOVEIISROOT.BAT F<br />
echo.<br />
echo. <br />
<br />
:success<br />
&lt;&lt; End of moveiis7root.bat &gt;&gt;<br />
<br />
AppCMD.exe can be used to tweak some more after the install is completed but I digress.<br />
http://blogs.iis.net/webdevelopertips/archive/2009/01/11/tip-42-did-you-know-configurationeditor-allows-you-to-generate-c-javascript-or-appcmd-script-to-update-configuration.aspx<br />
<br />
<br />
**************<br />
If you have the RTM version of Windows Server 2008 R2 then you can also use PowerShell.<br />
To launch PowerShell 2.0 from the command-line type:  POWERSHELL<br />
        * Import the Server Manager Module with: Import-Module ServerManager<br />
        * You will get the following cmdlets to list/add/remove features and roles:<br />
                    Get-WindowsFeature --&gt; lists available/Installed features and roles<br />
                    Add-WindowsFeature --&gt; installs a feature or role<br />
                    Remove-WindowsFeature --&gt; removes a feature or role<br />
The rest is poorly documented right now but it seems to borrow heavily from the 2 previous methods.<br />
<br />
http://technet.microsoft.com/en-us/library/cc732757.aspx<br />
<br />
At this time, there is no PowerShell script to install IIS 7.0 so here is the one I wrote:<br />
<br />
# Installs IIS 7.0 with ALL Role-Services Plus SMTP feature<br />
# Creates a log file in the same folder as this script<br />
# CAVEAT: This *ONLY* works on Windows server 2008 R2 (and later?)<br />
#<br />
#<br />
# To Run this Powershell script<br />
# Step 1: Allow Powershell scripts to run<br />
#	Start -&gt; Run<br />
#	Type: PowerShell &lt;Press Enter&gt;<br />
#	Type: Set-ExecutionPolicy Unrestricted &lt;Press Enter&gt;<br />
#	Type: &lt;Press Enter&gt;<br />
#<br />
# Step 2: Run this Powershell Script <br />
#	From the PowerShell Prompt<br />
#		Browse to the folder where this Powershell Script is located<br />
#		Type: . &lt;name of this Script&gt;<br />
# 	OR<br />
#<br />
#	Right-click on the Powershell Script file (*.ps1)<br />
#		Select "Run with PowerShell"<br />
#<br />
# Powershell Tip: Do not point Add-WindowsFeature's -logPath and redirection (&gt;&gt; $LogFile) to the same file<br />
# 	Powershell gets confused as to what encoding to use (ANSI/UTF-8) and you will get Chinese characters!?!<br />
#	Use "transcript" instead as done below.<br />
#	NOTE: for some reasons it talks about "activities not shown..."<br />
#<br />
<br />
#Make $LogFile match the Powershell script name with a date and time stamp followed by ".log"<br />
$dt = Get-Date -format "yyyyMMdd_hhmm"<br />
$LogFile  = ($MyInvocation.MyCommand.Name).Replace(".ps1","_$dt.log")<br />
<br />
<br />
start-transcript $LogFile 	#start the transcript (aka Logging)<br />
trap { stop-transcript; break}	#error trapping code to stop the transcript and break out of script<br />
								#(alternatively could use "continue" execution) <br />
<br />
<br />
# Load ServerManager Powershell module <br />
Import-Module ServerManager<br />
<br />
Add-WindowsFeature -Name Web-WebServer<br />
Add-WindowsFeature -Name Web-Common-Http<br />
Add-WindowsFeature -Name Web-Static-Content<br />
Add-WindowsFeature -Name Web-Default-Doc<br />
Add-WindowsFeature -Name Web-Dir-Browsing<br />
Add-WindowsFeature -Name Web-Http-Errors<br />
Add-WindowsFeature -Name Web-Http-Redirect<br />
Add-WindowsFeature -Name Web-DAV-Publishing<br />
Add-WindowsFeature -Name Web-Asp-Net<br />
Add-WindowsFeature -Name Web-Net-Ext<br />
Add-WindowsFeature -Name Web-ASP<br />
Add-WindowsFeature -Name Web-CGI<br />
Add-WindowsFeature -Name Web-ISAPI-Ext<br />
Add-WindowsFeature -Name Web-ISAPI-Filter<br />
Add-WindowsFeature -Name Web-Includes<br />
Add-WindowsFeature -Name Web-Health<br />
Add-WindowsFeature -Name Web-Http-Logging<br />
Add-WindowsFeature -Name Web-Log-Libraries<br />
Add-WindowsFeature -Name Web-Request-Monitor<br />
Add-WindowsFeature -Name Web-Http-Tracing<br />
Add-WindowsFeature -Name Web-Custom-Logging<br />
Add-WindowsFeature -Name Web-ODBC-Logging<br />
Add-WindowsFeature -Name Web-Security<br />
Add-WindowsFeature -Name Web-Basic-Auth<br />
Add-WindowsFeature -Name Web-Windows-Auth<br />
Add-WindowsFeature -Name Web-Digest-Auth<br />
Add-WindowsFeature -Name Web-Client-Auth<br />
Add-WindowsFeature -Name Web-Cert-Auth<br />
Add-WindowsFeature -Name Web-Url-Auth<br />
Add-WindowsFeature -Name Web-Filtering<br />
Add-WindowsFeature -Name Web-IP-Security<br />
Add-WindowsFeature -Name Web-Performance<br />
Add-WindowsFeature -Name Web-Stat-Compression<br />
Add-WindowsFeature -Name Web-Dyn-Compression<br />
Add-WindowsFeature -Name Web-Mgmt-Tools<br />
Add-WindowsFeature -Name Web-Mgmt-Console<br />
Add-WindowsFeature -Name Web-Scripting-Tools<br />
Add-WindowsFeature -Name Web-Mgmt-Service<br />
Add-WindowsFeature -Name Web-Mgmt-Compat<br />
Add-WindowsFeature -Name Web-Metabase<br />
Add-WindowsFeature -Name Web-WMI<br />
Add-WindowsFeature -Name Web-Lgcy-Scripting<br />
Add-WindowsFeature -Name Web-Lgcy-Mgmt-Console<br />
Add-WindowsFeature -Name Web-Ftp-Server<br />
Add-WindowsFeature -Name Web-WHC<br />
<br />
Add-WindowsFeature -Name SMTP-Server<br />
<br />
stop-transcript #stop the transcript (aka Logging)<br />
<br />
#pause 50 Seconds (There is no "PAUSE" in PS, thx MS!)<br />
Start-sleep -s 50<br />
<br />
<br />
You are still able to use AppCMD.exe to tweak after install (e.g. the batch file to move c:\ inetpub) but it is rumoured that it will also be assimilated into a PowerSmell module.<br />

            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/misterd" class="username" rel="nofollow">misterd</a>
                </li>
                <li>
                    10/27/2009 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_2476" name="tip_2476">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-2476"></div> -->
   <div id="tip-2476" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">3</div>
   <div id="tip-2476" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-2476"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            The following is the Move_IIS7.bat (moveiis7root.zip) translated to PowerShell. <br />
&gt;&gt;&gt; Use at your own risk. &lt;&lt;&lt;<br />
<br />
<br />
# REM The following it the CMD created by Thomas Deml, an ISS team member<br />
#http://blogs.iis.net/thomad/archive/2008/02/10/moving-the-iis7-inetpub-directory-to-a-different-drive.aspx<br />
# now translated to Powershell by misterd (Ottawa, Canada)<br />
<br />
#Pickup Drive letter from command line<br />
<br />
$MOVETO=$arg:<br />
Write-host $MOVETO<br />
<br />
#REM simple error handling if drive does not exist or argument is wrong <br />
if (-not (test-path $MOVETO)){<br />
		echo $MOVETO + " drive does not exist"<br />
		EXIT 2<br />
		}<br />
<br />
Write-host <br />
Write-host *****************************************<br />
Write-host Moving C:\inetpub\ to ${MOVETO}inetpubWrite-host *****************************************<br />
Write-host <br />
<br />
<br />
<br />
Write-host REM Backup IIS config before we start changing config to point to the new path<br />
& $env:WINDIR\system32\inetsrv\appcmd add backup beforeRootMove<br />
<br />
<br />
Write-host Stop all IIS services<br />
iisreset /stop<br />
<br />
#REM Copy all content <br />
#REM /O - copy ACLs<br />
#REM /E - copy sub directories including empty ones<br />
#REM /I - assume destination is a directory<br />
#REM /Q - quiet<br />
<br />
#CAVEAT: the following does not show up in log files<br />
<br />
Write-host REM Xcopy $env:systemdrive\inetpub to ${MOVETO}inetpub folder<br />
xcopy $env:systemdrive\inetpub ${MOVETO}inetpub /O /E /I /Q<br />
<br />
<br />
Write-host REM Move AppPool isolation directory <br />
reg add HKLM\System\CurrentControlSet\Services\WAS\Parameters /v ConfigIsolationPath /t REG_SZ /d "${MOVETO}inetpub\temp\appPools" /f<br />
<br />
<br />
Write-host REM Move logfile directories<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:system.applicationHost/sites" "-siteDefaults.traceFailedRequestsLogging.directory: ""${MOVETO}inetpub\logs\FailedReqLogFiles"""<br />
& $env:windir\system32\inetsrv\appcmd set config "-section:system.applicationHost/sites" "-siteDefaults.logfile.directory:""${MOVETO}inetpub\logs\FailedReqLogFiles"""<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:system.applicationHost/log" "-centralBinaryLogFile.directory:""${MOVETO}inetpub\logs\logfiles"""<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:system.applicationHost/log" "-centralW3CLogFile.directory:""${MOVETO}inetpub\logs\logfiles"""<br />
<br />
<br />
Write-host REM Move config history location<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:system.applicationhost/configHistory" "-path:${MOVETO}inetpub\history"<br />
<br />
<br />
Write-host REM Move temporary files location<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:system.webServer/asp" "-cache.disktemplateCacheDirectory:${MOVETO}inetpub\temp\ASP Compiled Templates"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:system.webServer/httpCompression" "-directory:${MOVETO}inetpub\temp\IIS Temporary Compressed Files"<br />
<br />
<br />
Write-host REM Move the path for the Default Web Site location<br />
& $env:WINDIR\system32\inetsrv\appcmd set vdir "Default Web Site/" "-physicalPath:${MOVETO}inetpub\wwwroot"<br />
<br />
<br />
Write-host REM Move the path for the custom error locations<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='401'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='403'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='404'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='405'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='406'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='412'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='500'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='501'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
& $env:WINDIR\system32\inetsrv\appcmd set config "-section:httpErrors" "/[statusCode='502'].prefixLanguageFilePath:${MOVETO}inetpub\custerr"<br />
<br />
<br />
Write-host REM Make sure Service Pack and Hotfix Installers know where the IIS root directories are<br />
reg add HKLM\Software\Microsoft\inetstp /v PathWWWRoot /t REG_SZ /d ${MOVETO}inetpub\wwwroot /f<br />
reg add HKLM\Software\Microsoft\inetstp /v PathFTPRoot /t REG_SZ /d ${MOVETO}inetpub\ftproot /f<br />
<br />
Write-host REM Restart all IIS services<br />
iisreset /start<br />
<br />
Write-host<br />
Write-host ===============================================================================<br />
Write-host  Moved IIS7 root directory from $env:{systemdrive}\ to ${MOVETO}\.<br />
Write-host <br />
Write-host  Please verify if the move worked. If so you can delete the $env:{systemdrive}\inetpub directory.<br />
Write-host  If something went wrong you can restore the old settings via <br />
Write-host      "APPCMD restore backup beforeRootMove" <br />
Write-host  and <br />
Write-host      "REG delete HKLM\System\CurrentControlSet\Services\WAS\Parameters\ConfigIsolationPath"<br />
Write-host  You also have to reset the PathWWWRoot and PathFTPRoot registry values<br />
Write-host  in HKEY_LOCAL_MACHINE\Software\Microsoft\InetStp.<br />
Write-host  ===============================================================================<br />
Write-host <br />
<br />
read-host 'Press ENTER key to continue...'	# aka Pause
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/misterd" class="username" rel="nofollow">misterd</a>
                </li>
                <li>
                    11/04/2009 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

                
            </div>

                    </div>

    </div>
    <!-- end Deployment Tips -->

    <div class="software-section" id="inventory-records">

        <div class="callout-box2">

            <h3><a href="#" class="plus toggle"></a> Inventory Records (1)</h3>
            <p>View inventory records anonymously contributed by opt-in users of the
                <a href="http://software.dell.com/products/kace-k1000-systems-management-appliance">
                K1000 Systems Management Appliance</a>.
            </p>

        </div>

        <div class="inner-content">

            <div class="inner">

                <div id="software-view-version-revision-list">
                    <div class="title">Versions</div>
                    <ul class="no-bullet nav nav-pills">
                                                    <li class="active">
                                <a href="/software/version/revision/29540/61319">
                                    7
                                </a>
                            </li>
                                            </ul>
                </div>
                <div id="software-view-version-revision-details">
                                            <h2>Internet Information Server (IIS)</h2>
            <div><h3>Version</h3><span>7</span></div>
                                                                                                    
                                    </div>
                <br class="clear"/>
            </div>

        </div>

    </div>
    <!-- end inventory records section -->

    <div class="software-section" id="q-a">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Questions & Answers (1)
                            </h3>
            <p>Questions & Answers related to Microsoft Internet Information Server (IIS)</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">

    <div class="content-left">
        <div class="vote-wrap">

            <div class="vote-num">
                2
            </div>

            <div class="vote-label">
                <!--insert conditional based on answered or not-->
                ANSWERS
            </div>

        </div>
    </div>


    <div class="content-meta">

        <a href="/question/sccm-2012-unable-to-connect-to-application-catalog" class="title">
            SCCM 2012 unable to connect to application catalog
        </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="27768"
     data-enabled="false"
     data-entity-name="question"
     data-rating=4
     data-expanded="false"
     data-entityType="question"
     >
</div></li>

            </div>

            <div class="byline">
                By:
                <a href="/user/edilling" rel="nofollow">edilling</a>
                9 years ago 33.9k views
            </div>
            <div id="question-latest-activity" class="latestActivity">
               creck answered 7 years ago
    </div>

        </div>

    </div>

</div>
<!--end question -->                
                            </div>

        </div>
    </div>
    <!-- end Q & A section -->

    <div class="software-section" id="blogs">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Blogs (1)
                            </h3>
            <p>Blog posts related to Microsoft Internet Information Server (IIS)</p>

        </div>
        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">

    <div class="content-left">
        <div class="content-icon blog-icon" title="Blog">blog</div>
    </div>

    <div id="blog-post-light" class="content-meta">
                <a href="/blog/view/microsoft-internet-information-services-iis-7-manager" class="title">
            Microsoft Internet Information Services(IIS) 7 Manager
        </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="3729"
     data-enabled="false"
     data-entity-name="blog_post"
     data-rating=4
     data-expanded="false"
     data-entityType="blog_post"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/Sidhugadu" rel="nofollow">Sidhugadu</a>
                10 years ago 4.5k views
            </div>

        </div>

    </div>

</div>                
                            </div>

        </div>
    </div>
    <!-- end blog section -->

    <div class="software-section" id="links">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Links (6)
                            </h3>

            <p>Links related to Microsoft Internet Information Server (IIS)</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/using-unattended-setup-to-install-iis-7-0-installing-iis-7-installing-and-configuring-iis-7-the-official-microsoft-iis-site" class="title">
                Using Unattended Setup to Install IIS 7.0 : Installing IIS 7 : Installing and Configuring IIS 7 : The Official Microsoft IIS Site
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="1707"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/misterd" rel="nofollow">misterd</a>
                13 years ago 6.2k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/creating-an-answer-file-for-server-manager-commands" class="title">
                Creating an Answer File for Server Manager Commands
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="1752"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/misterd" rel="nofollow">misterd</a>
                13 years ago 2.6k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/how-to-add-or-remove-windows-components-with-sysocmgr-exe-1" class="title">
                How to Add or Remove Windows Components with Sysocmgr.exe
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="2828"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/jasonth" rel="nofollow">jasonth</a>
                17 years ago 4.1k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/how-to-add-or-remove-windows-components-with-sysocmgr-exe" class="title">
                How to Add or Remove Windows Components with Sysocmgr.exe
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="2826"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/jasonth" rel="nofollow">jasonth</a>
                18 years ago 3.3k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/iis-configuration-script-iiscnfg-vbs" class="title">
                IIS Configuration Script (iiscnfg.vbs)
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="2872"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/jasonth" rel="nofollow">jasonth</a>
                18 years ago 2.8k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/microsofts-installing-iis-document" class="title">
                MicrosoftÂ’s Installing IIS document
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="2918"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/jasonth" rel="nofollow">jasonth</a>
                18 years ago 2.1k views
            </div>

        </div>

    </div>

</div>                
                            </div>

        </div>
    </div>
    <!-- end links section -->

    <!-- reviews -->
        <div class="software-section" id="reviews">

           <div class="callout-box2">

               <h3>
                   <a href="#" class="plus toggle"></a> Reviews (0)
                                  </h3>

               <p>Reviews related to Microsoft Internet Information Server (IIS)</p>

           </div>

           <div class="inner-content">

               <div class="inner">


                   
               </div>

           </div>

       </div>


</div>
    <div class="clearfix">&nbsp;</div>
</div>
<div class="ccpa-notification">
    <div class="ccpa-notification-text">
        <div><button class="btn-itn" id="ccpa-accept">ACCEPT</button></div>

        This website uses cookies.
        By continuing to use this site and/or clicking the "Accept" button you are providing consent


        Quest Software and its affiliates do NOT sell the Personal Data you provide to us either when you register on our
        websites or when you do business with us. For more information about our
        <a href="https://www.quest.com/legal/privacy.aspx" target="_blank" rel="noopener noreferrer">Privacy Policy</a> and our data protection
        efforts, please visit
        <a href="https://www.quest.com/legal/gdpr-hq.aspx" target="_blank" rel="noopener noreferrer">GDPR-HQ</a>
        </div>
    </div>
</div>


<footer>
    <div class="container">
                <div id="footer-nav" class="row">
            <div class="md-3">
                <strong>Home Pages</strong>
                <ul>
                    <li><a href="/software-library">Software</a></li>
                    <li><a href="/question">Questions</a></li>
                    <li><a href="/blog">Blog Posts</a></li>
                    <li><a href="/link">Shared Links</a></li>
                </ul>
            </div>
            <div class="md-3">
                <strong>FAQ &amp; Support</strong>
                <ul>
                    <li><a href="/faq">Site FAQ</a></li>
                    <li><a href="https://www.quest.com/community/quest/unified-endpoint-management" target="_blank" rel="noopener noreferrer">Unified Endpoint Management</a></li>
                </ul>
            </div>
            <div class="md-3">
                <strong>About</strong>
                <ul>
                    <li><a href="/about">ITNinja</a></li>
                    <li><a href="/about">Welcome Video</a></li>
                    <li><a href="/tour">Tour</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/sitemap">Sitemap</a></li>
                </ul>
            </div>
            <div class="md-3">
                <strong>Share/Contribute</strong>
                <ul>
                    <li class="pull-left"><a href="http://www.facebook.com/pages/ITNinja/128951133849867"><img src="/build/static/layout/facebook.png" alt="Facebook"></a></li>
                    <li class="pull-left">&nbsp;&nbsp;</li>
                    <li class="pull-left"><a href="http://twitter.com/ITNinjaSite"><img src="/build/static/layout/twitter.png" alt="Twitter"></a></li>
                </ul>
            </div>
        </div>

        <div id="footer-links">
            &copy; 2023 Quest Software Inc. All rights reserved.  &nbsp; <a href="/legal">Legal</a> &nbsp; | &nbsp; <a href="https://kace.uservoice.com/forums/139919-itninja">Feedback</a>
            <a href="https://www.quest.com/kace/" class="footer-logo-kace"><img src="/build/static/layout/KACE_White-grey.png" alt="KACE" /></a>
            <a href="https://www.quest.com/" class="footer-logo"><img src="/build/static/layout/dsg.png" alt="Quest" /></a>
        </div>

        <div id="version">unknown</div>

    </div>

</footer>

<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=es6"></script>

<script src="/build/index.5c9f75e6.js"></script>


    <script src="/build/software.afa0d704.js"></script>

    <script>
        Itninja.Helpful('div.helpful button');
        Itninja.HideContent('a.review-delete-admin','div.version-review');

        $(document).ready( function() {
            tagging.init($('#form_tags'), {'suggest':false});

            // only way to do this
                             var id = '#platform-new #form_platforms_' + 1;
                $(id).click(function() {
                    showNotificationBar('This platform is associated to one or more tips. Please modify the tip prior to removing this platform',1200);
                    // reclick it
                    $(this).attr("checked", true);
                });
            

            $("input#difficulty[data-slider]").bind("slider:changed", function (event, data) {

                difficultyValue = data.value.toFixed(0);

                // set difficulty dropdown to value from slider
                $("select#difficultyRating").val(difficultyValue);

                // get difficulty phrase
                var phrase = $('select#difficultyRating option:selected').html();

                if (phrase) {
                    // set slider phrase span
                    $('#slider-value').html("Difficulty: <span class='diff_" + difficultyValue + "'>" + phrase + "</span>");
                }

                if ( data.value == 0){
                     $('.slider-back').addClass('slider-disabled');
                     $('#slider-value span').removeClass('diff_1');
                 } else {
                    $('.slider-back').removeClass('slider-disabled');
                 }

            })
        });
    </script>


</body>
</html>
