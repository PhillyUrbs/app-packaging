<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>IT Pro Tips for Microsoft ActiveSync 4</title>
    <meta name="description" content="Deployment tips, questions, blogs and other technical materials related to Microsoft ActiveSync 4">
    <meta name="keywords" content="Microsoft,Microsoft ActiveSync,ActiveSync 4">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="yMY423DZduMGIsTKJnJbRzr_qC4FUxtEhXxtuGftSGw" />
    <link rel="apple-touch-icon" sizes="180x180" href="/build/static/layout/apple-touch-icon.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/build/static/layout/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/build/static/layout/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/build/static/layout/safari-pinned-tab.svg" color="#a81e25">
    <meta name="msapplication-TileColor" content="#a81e25">
    <meta name="theme-color" content="#ffffff">
            <link rel="canonical" href="http://www.itninja.com/software/microsoft/activesync/4-286" />
    

    <!--
         * Quest Software Inc. PROPRIETARY INFORMATION
         *
         * This software is confidential.  Quest Software Inc., or one of its subsidiaries, has
         * supplied this software to you under the terms of a license agreement,
         * nondisclosure agreement or both.  You may not copy, disclose, or use this
         * software except in accordance with those terms.
         *
         * Copyright 2024 Quest Software Inc..  All Rights Reserved.
         *
         * Quest Software Inc. MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF
         * THE SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
         * IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
         * OR NON-INFRINGEMENT. Quest Software Inc. SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY
         * LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR
         * ITS DERIVATIVES.
         *
        -->
    <link rel="stylesheet" href="/build/index.82f4a908.css">

    
            <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-P8DH2B7');</script>
        <!-- End Google Tag Manager -->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26553848-1']);
            _gaq.push(['_trackPageview']);

            (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();

        </script>
    
    <script type="text/javascript">

        // create the itninja JS namespace
        var Itninja = {};
        Itninja.isIe8 = false;
                var TAG_SERVER = 'tags.itninja.com',
            TAG_AUTO_SUGGEST_ENABLE = 'true' === '1' ? true : false,
            TAG_SHOW_ADD_NEW = false,
            TAG_USER_ID = 0;



    </script>
        </head>
<body>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P8DH2B7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="content-row">
    <div class="md-12">
        
<nav class="navbar navbar-inverse" role="navigation" id="main-nav">
    <div class="navbar-header">
        <div class="nav-logo-container-c"><a href="/"> <img src="/build/static/layout/ITN_logo_white.svg" class="nav-logo-collapse"/> </a></div>
        <button class="navbar-toggle" data-toggle="collapse" data-target="#main-nav-collapse" id="navbar-toggle">
            <div id="nav-icon-bar">
                <span class="nav-icon-bar-span"></span>
                <span class="nav-icon-bar-span"></span>
                <span class="nav-icon-bar-span"></span>
                <span class="nav-icon-bar-span"></span>
            </div>
        </button>
    </div>


    <div id="main-nav-collapse" class="collapse collapse-container">
        <div class="navbar-search-container">
            <form role="search" action="/search" id="nav-search">
                <div class="input-group">
                    <input type="text" name="q" placeholder="Search..." class="form-control nav-collapsed-form"/>
                    <span class="input-group-btn">
                    <button class="btn search-btn" type="submit"><img class="search-icon" src="/build/static/layout/Search_Icon_White.svg"></button>
                </span>
                </div>
            </form>
        </div>

        <ul class="collapse-list">
            <li class=""><a href="/software-library" class="nav-collapse-text">Software Tips</a></li>
            <li ><a href="/question" class="nav-collapse-text">Questions</a></li>
            <li ><a href="/blog" class="nav-collapse-text">Blogs</a></li>
            <li ><a href="/link" class="nav-collapse-text">Links</a></li>
            <li ><a href="/community" class="nav-collapse-text">Communities</a></li>
            <li ><a href="/gallery" class="nav-collapse-text">KACE Photos</a></li>
                        
            <li>
                <div>
                    <div class="user-dropdown-collapse">
                                                    <a href="/login" class="button log-in-collapse">Log in</a>
                                        </div>
            </div>
        </li>
    </ul>
    </div>

    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav ">
            <div class="nav-logo-container"> <li> <a href="/"> <img src="/build/static/layout/ITN_logo_white.svg" class="nav-logo"> </a> </li> </div>
            <li class="nav-bar-text-first first "><a href="/software-library" class="navigation-bar-text">Software Tips</a></li>
            <li ><a href="/question" class="navigation-bar-text">Questions</a></li>
            <li ><a href="/blog" class="navigation-bar-text">Blogs</a></li>
            <li ><a href="/link" class="navigation-bar-text">Links</a></li>
            <li ><a href="/community" class="navigation-bar-text">Communities</a></li>
            <li ><a href="/gallery" class="navigation-bar-text">KACE Photos</a></li>
                                </ul>

        <div>
            <div class="user-dropdown">
                                    <div class="nav-login-container">
                        <li class="nav-login-list"><a href="/login" class="button nav-register-log-text">Log in</a></li>
                    </div>
                            </div>
        </div>

        <div id="search-form-container" class="search-form-container">
            <div class="navbar-search pull-right">
                <form class="navbar-form navbar-right" role="search" action="/search" id="nav-search">
                    <div class="input-group search-input-span box">
                        <input type="text" id="search-trigger" name="q" placeholder="Search..." class="form-control nav-search-form"/>
                        <span class="input-group-btn">
                            <button class="btn search-btn" type="submit"><img class="search-icon" src="/build/static/layout/Search_Icon_White.svg"></button>
                        </span>
                    </div>
                </form>
            </div>
        </div>


    </div>
</nav>





    </div>
</div>

    <a href="/"> <img class="breadcrumbCap" src="/build/static/layout/Breadcrumb_cap.svg" alt="/build/static/layout/Breadcrumb_cap_w.png" href="/"/></a>
    <ul id="breadcrumbs" class="breadcrumb">
        <li><a href="/">
            </a></li>
            <li><a href="/software-library">Software</a></li>
    <li><a href="/software-library/company/microsoft">Microsoft</a></li>
    <li><a href="/software-library/company/microsoft/activesync">ActiveSync</a></li>
    <li>4</li>
    </ul>


<div id="widget-notice" class="flash-wrap">
            </div>
<div class="body-container"  id="app">

    
<div class="itn-content">

    <div class="content-row">

        <div id="software-version-view-meta" class="md-9">
                <h2>Microsoft ActiveSync</h2>

                <div id="version-wrapper">

                    <span class="version-name" id="version-changer">
                        Version: 4
                        <div id="version-list">
                            <div class="version-list-top"></div>
                            <ul id="version-list-items" class="version-list">
                                                                    <li>
                                        <a
                                            href="/software/microsoft/activesync/4-286"
                                            >
                                            4.x <span>(12 tips) </span>
                                        </a>
                                    </li>
                                                                    <li>
                                        <a
                                            href="/software/microsoft/activesync/3-421"
                                            >
                                            3.x <span>(8 tips) </span>
                                        </a>
                                    </li>
                                                            </ul>
                        </div>
                    </span>

                    
                </div>

            </div>
        <div class="md-3">

            


    <section id="widget-signup">

    <h4>Don't be a Stranger!</h4>

    <p>Sign up today to participate,
        stay informed, earn points and establish a reputation for yourself!</p>

    <a class="btn-follow btn" rel="nofollow"
       href="/register?/follow/version/4652/JTJGc29mdHdhcmUlMkZtaWNyb3NvZnQlMkZhY3RpdmVzeW5jJTJGNC0yODY=">
        <span> Sign up!</span>
    </a>
    or
    <a class="" rel="nofollow"
       href="/login?/follow/version/4652/JTJGc29mdHdhcmUlMkZtaWNyb3NvZnQlMkZhY3RpdmVzeW5jJTJGNC0yODY=">
        login
    </a>
</section>



            <div class="tr-meta" title="Average rating 0 based on 0 votes">
                
<div id="widget-software-byline" class="pull-right">
    Views: 8.6k &nbsp|&nbsp
    Created: 01/24/2007
    
</div><br>

<div id="widget-software-byline-stars" class="stars-wrap">
    <div name="itninja-star-rating"
     data-entity-id="4652"
     data-enabled="false"
     data-entity-name="software"
     data-rating=2
     data-expanded="false"
     data-entityType="software"
     >
</div></li>

</div>
<div id="widget-software-byline-rating" class="pull-right"> Average Rating: <span
            id="average-rating">0</span></div>
            </div>
        </div>


        <!--end header-->

    </div>


    <div class="content-row">

            </div>


        

    <div class="content-row">

        <div class="md-12">
            

<div id="widget-tags" class="tags-wrap">
    </div>
            
        </div>


        <div id="software-version-view-add-version-meta-additional" class="additional-meta md-12">
            <div class="additional-meta-content callout-box">
                <span class="glyphicon glyphicon-info-sign"></span>
                ActiveSync has <a href="#inventory-records" id="scrollInv">9 inventory records</a>,
                <a href="#q-a" id="scrollQA">3 Questions</a>,
                <a href="#blogs" id="scrollBlog">0 Blogs</a>
                and <a href="#links" id="scrollLinks">3 links</a>. Please help add to this by sharing more!
            </div>
        </div>

    </div>


    <div id="deployment-tips" class="software-section">

        <div class="callout-box2">
            <h3>
                <a href="#" class="plus toggle minus"></a> Deployment Tips (12)
                            </h3>



        </div>


                <div class="inner-content" id="deploy-div">

            <div id="deployment-ratings-summary" class="inner">

                    <div class="meta">
                        <strong>Most Common Setup Type</strong>
                        <div>
                            Not Determined
                        </div>
                    </div>
                    <div class="meta meta-middle">
                        <strong>Average Package Difficulty Rating</strong>
                        <img src="/build/static/software/green.png" class="img-responsive" />
                        <div class="rating-text">
                            Rated <strong>2 / 5 (Somewhat Easy)</strong>
                            based on <strong>3</strong> ratings
                        </div>
                    </div>
                    <div class="meta">
                        <strong>Most Commonly Reported Deployment Method</strong>
                        <div>
                            Repackaged (to a setup.msi)
                        </div>
                    </div>

            </div>

            <!-- end rating section -->
            
                                                        

            

            <ul class="nav nav-tabs" id="tips">

                    <li class="active">
                        <a href="/software/microsoft/activesync/4-286#tips">
                            All Tips
                        </a>
                    </li>
                                           <li ><a href="/software/microsoft/activesync/4-286/windows#tips">
                               Windows Tips
                            </a>
                       </li>
                                    </ul>

            </ul>

                    <div id="software-version-tips" class="inner">

                
    <div>
        
    
        <div class="tip" id="tip_451" name="tip_451">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-451"></div> -->
   <div id="tip-451" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">121</div>
   <div id="tip-451" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-451"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            ActiveSync 4.5<br />
<br />
No systemtray icon:<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows CE Services]<br />
"ComShowIcon"=dword:00000000<br />
<br />
No connection wizard:<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows CE Services]<br />
"GuestOnly"=dword:00000001
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/bertman" class="username" rel="nofollow">bertman</a>
                </li>
                <li>
                    12/10/2007 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_441" name="tip_441">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-441"></div> -->
   <div id="tip-441" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">118</div>
   <div id="tip-441" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-441"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            You may download the latest Active Sync Developer Preview <a href="http://download.microsoft.com/download/c/4/5/c45f8f83-6383-43d7-840b-cb9638484e4d/setup.exe">here</a>.<br />
<br />
FINALLY Microsoft went away from that silly silent.ini and create an MSI for delivery.<br />
<br />
You can run "setup.exe /a" to install to an Admin Share.  Once installed, I have ran it through InstallShield Tuner to customize the package.<br />
<br />
Read the README.DOC in the admin shares root.  There are still a host of issues.  But this is a step in the right direction.  I have not yet tested it on our Lockdown XP SP2 Config.  I will post findings once completed.
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/TheWorkz" class="username" rel="nofollow">TheWorkz</a>
                </li>
                <li>
                    06/20/2005 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_445" name="tip_445">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-445"></div> -->
   <div id="tip-445" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">118</div>
   <div id="tip-445" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-445"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            Create a Snap-Shot of the installation. Then use "SETUP.EXE /V /a" to create an administrative installation to a network location. Search for the file "Rndis_Update.exe" in "\\\Windows\INF" if you are planning to create a MSI-Package for WinXP (use "Rndis_Update_2k3.exe" for Win2k3 Server and "Rndis_Update_64.exe" on 64Bit platforms. These files are included in the same directory) and add this file to your Snap-Shot in the folder "Program Files\Microsoft ActiveSync\Drivers" (This folder should already exist containing the files "WceRndis.cat", "wceRndis.inf", "Wceusbsh.cat", "wceusbsh.inf" and "wceusbsh.sys"). Add the file "Dpinst.exe" to this folder (<a href="http://www.microsoft.com/whdc/driver/install/DIFxtlsdwn.mspx?">http://www.microsoft.com/whdc/driver/install/DIFxtlsdwn.mspx?</a>). Add the files "wceRndis.inf" and "wceusbsh.inf" to the folder "Windows\INF" in your package. Add Custom Actions to your package which run in the following order during installation with elevated rights: 1) Execute program from installed files "Rndis_Update.exe /quiet /norestart"; 2) Execute program from installed files "Dpinst.exe /S /LM /SA". When the package was distibuted to a user, the user can now simply connect the mobile device to the computer whitout being asked for an Administrative account to add the hardware.<br />
<br />
[Note: AppDeploy Does Not Recommend The Repackaging of MSI Setups]
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/psomeren" class="username" rel="nofollow">psomeren</a>
                </li>
                <li>
                    02/08/2006 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_450" name="tip_450">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-450"></div> -->
   <div id="tip-450" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">118</div>
   <div id="tip-450" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-450"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Command Line</div>

            <span id="tip-text">
            The above command line didn't quite work for me, try this instead:<br />
<br />
setup.exe /S /v"/qn"<br />
<br />
For uninstallation:<br />
<br />
MsiExec.exe /X{B208806F-A231-4FA0-AB3F-5C1B8979223E} /qb-<br />
<br />
To prevent the system of starting the configuration screen after the reboot remove registry-entry:<br />
<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]<br />
"H/PC Connection Agent"="\"C:\\PROGRA~1\\MICROS~2\\wcescomm.exe\""
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/AndreE" class="username" rel="nofollow">AndreE</a>
                </li>
                <li>
                    08/15/2007 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_442" name="tip_442">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-442"></div> -->
   <div id="tip-442" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">117</div>
   <div id="tip-442" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-442"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Command Line</div>

            <span id="tip-text">
            setup.exe /s /V/qb!<br />
<br />
The above works for a default installation.<br />
<br />
Sebastian
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/sprobst" class="username" rel="nofollow">sprobst</a>
                </li>
                <li>
                    09/09/2005 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_443" name="tip_443">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-443"></div> -->
   <div id="tip-443" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">117</div>
   <div id="tip-443" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-443"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            Here is my recipe:<br />
<br />
*** Create a MST for Microsoft ActiveSync 4.x.<br />
1) Make a backup copy of the original '*ActiveSync*.msi' file as example I use: 'ActiveSync_ORCA.msi'.<br />
2) Open ActiveSync_ORCA.msi in Orca.<br />
      Note: This file comes with the Microsoft Platform SDK.<br />
      You can change the following propertys (you can use 1/0 instead of YES/NO):<br />
      * In the Table row (left screen) click on the 'InstallExecuteSequence' table.<br />
		CA_Nt5_PrimeInf		= Add 'AND (NOT REINSTALL)' for poweruser issue (See 'MICROSOFT ACTIVESYNC 4.1 HELL' on http://www.appdeploy.com/) (Default='(VersionNT  &gt;= 500) AND (NOT REMOVE)').<br />
		CA_InstallInkNotes	= Add 'AND (NOT RunAs_INSTALL)' Specially added to avoid a Microsoft Outlook error: "Either there is no default mail client or the current mail client cannot fulfill the messaging request. Please run Microsoft Outlook and set it as the default mail client." when installing this from a RunAs command (Default='$InkProps.dll.5F492FF1_28AE_4C56_A4D6_B40F4E565FD2=3').<br />
      * In the Table row (left screen) click on the 'Property' table.<br />
		RunAs_INSTALL		= (YES/NO) This property I specially added to avoid a Microsoft Outlook error when installing from a RunAs command See the cal to 'InstallExecuteSequence' above, you have to create both propertys!<br />
      * NOTE *<br />
		You can add the 'RunAs_INSTALL' Property in the ActiveSync_ORCA.msi and eventually the MST, or you can give it directly in the commandline, for example:<br />
				'MsiExec.exe /i "*ActiveSync*.msi" TRANSFORMS="ActiveSync.mst" RunAs_INSTALL=1'<br />
		You still need the 'CA_InstallInkNotes' part in the 'InstallExecuteSequence' as described in the MST thoug for it to function!<br />
3) Create the FINAL Transforms file (MST): "*ActiveSync*.mst"<br />
		MsiTran.exe -g "[PathTo]/*ActiveSync*.msi" "[PathTo]/ActiveSync_ORCA.msi" "[PathTo]/ActiveSync.mst"<br />
4) Now you can apply the transform on the command line as follows:<br />
		MsiExec.exe /i "*ActiveSync*.msi" TRANSFORMS="ActiveSync.mst" /qb!<br />
        Or it can be applied through the modification tab in the Group Policy using Active Directory.<br />
<br />
*** Notes ***<br />
    Most propertys discussed can be given in the commandline, like:<br />
		MsiExec.exe /i ....msi OPTION=...<br />
<br />
    Orca.exe is a FREE database table editor for creating and editing Windows Installer packages and merge modules.<br />
		See: http://msdn.microsoft.com/library/en-us/msi/setup/orca_exe.asp<br />
    MsiTran.exe is a FREE tool to generate or apply a transform file.<br />
		See: http://msdn.microsoft.com/library/en-us/msi/setup/msitran_exe.asp<br />
		MsiTran.exe will be installed in: "C:\Program Files\Microsoft Platform SDK\Bin".<br />
    ORCA and MsiTran Notes:<br />
		- ORCA and MsiTran come with the Microsoft Platform SDK.<br />
	  	  See: http://www.microsoft.com/msdownload/platformsdk/sdkupdate / http://msdn.microsoft.com/library/en-us/msi/setup/platform_sdk_components_for_windows_installer_developers.asp<br />
		- Orca.msi, MsiTran.exe and others will be installed in: "C:\Program Files\Microsoft Platform SDK\Bin".<br />
		- Instead of the the executable MsiTran.exe you could use the new 'Gen.vbs' ~ Create this vbs as described in the Platform SDK help file ~. But, as far as I tried it, it didn't work!<br />

            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/C_Denninger" class="username" rel="nofollow">C_Denninger</a>
                </li>
                <li>
                    12/24/2005 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_446" name="tip_446">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-446"></div> -->
   <div id="tip-446" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">117</div>
   <div id="tip-446" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-446"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            1) Run Setup.exe /a to create an admin installation share<br />
2) Install Software via software management<br />
<br />
MsiExec.exe /I "Microsoft ActiveSync 4.0.msi" /qb-! Reboot=ReallySuppress<br />
<br />
3) Copy DPInst.exe into C:\Programme\Microsoft ActiveSync\Drivers directory and run<br />
<br />
C:\Programme\Microsoft ActiveSync\Drivers\Dpinst.exe /S<br />
<br />
to install the usb drivers. so no local administrative action is necessary.<br />
 <br />
Setup.exe includes KB909394 patch, which is automatically installed during setup resp. deployed via your patch management tool.<br />
<br />
Deinstallation:<br />
MsiExec.exe /x{B208806F-A231-4FA0-AB3F-5C1B8979223E} /qb!<br />
<br />
Yours,<br />
Marko.
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/Moeki" class="username" rel="nofollow">Moeki</a>
                </li>
                <li>
                    04/04/2006 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_447" name="tip_447">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-447"></div> -->
   <div id="tip-447" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">117</div>
   <div id="tip-447" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-447"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            To prevent the ActiveSync dialog from showing up everytime a handheld device connects to the pc add this registry key to your installation:<br />
<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows CE Services]<br />
"Sync window display mode"=dword:00000000
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/rpfenninger" class="username" rel="nofollow">rpfenninger</a>
                </li>
                <li>
                    07/30/2006 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_444" name="tip_444">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-444"></div> -->
   <div id="tip-444" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">116</div>
   <div id="tip-444" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-444"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            Deploying ActiveSync 4.1 in USER (restricted, locked down) context from the GPO for WindowsXP pro based client.<br />
<br />
I used Wise for Windows installer (3.5) and made a full capture of C:\. <br />
<br />
I assume you are familiar with the capture process and do not need explanations about registry and files entries capture. At the end of this documents there are background notes and comments.<br />
<br />
Installing the drivers:<br />
I use the SetupCopyOEMInf API trough a visual basic 6.0 program. You can call that API directly from the wise project, but that is the way I have always been doing and I have my little habits. <br />
<br />
----VB6 Code----<br />
Private Declare Function SetupCopyOEMInf Lib "setupapi.dll" Alias "SetupCopyOEMInfA" _<br />
  (ByVal SourceInfFileName As String, ByVal OEMSourceMediaLocation As String, _<br />
  ByVal OEMSourceMediaType As Long, ByVal CopyStyle As Long, ByVal DestinationInfFileName As String, _<br />
  ByVal DestinationInfFileNameSize As Long, ByRef RequiredSize As Long, _<br />
  ByVal DestinationInfFileNameComponent As String) _<br />
  As Long<br />
<br />
<br />
Private Sub Form_Load()<br />
On Error Resume Next<br />
Dim param() As String<br />
Dim ret2 As String * 255<br />
Dim ret3 As String * 255<br />
Dim ret As Long<br />
<br />
If Command = "" Then End<br />
<br />
param = Split(Command, "@@")<br />
<br />
<br />
ret = SetupCopyOEMInf(param(0), param(1), 1, &H4, ret2, 255, 255, ret3)<br />
<br />
        If ret = 0 And UBound(param) = 2 Then<br />
        MsgBox "retour:" & ret & vbCrLf & _<br />
              "erreur:" & Err.LastDllError & vbCrLf & _<br />
              "nom fichier:" & Trim(ret2), vbCritical, "error"<br />
        End If<br />
End<br />
End Sub<br />
----end of Code----<br />
<br />
Param 0 to 2 are the following: (command line of the custom action)<br />
Param(0) = C:\Program Files\Microsoft ActiveSync\Drivers\wceusbsh.inf<br />
Param(1) = C:\Program Files\Microsoft ActiveSync\Drivers<br />
<br />
Param(2) is for debug, if you wish.<br />
<br />
Separator is "@@" - Environment variable are preferable to "C:\"<br />
<br />
This piece of code sets the inf file in the C:\winnt\inf\oemX.inf and registers the security catalogue in the catroot directory. Please keep in mind that with the (windowsXP) windows file protection you cannot change directly a registered inf in the inf directory without using the API.<br />
<br />
So create two custom action "Exe from binary table", Deffered system context - synchronous ignore exit code - after file and registry installation in the (install) sequence. <br />
<br />
Launch conditions are "NOT Installed" (but feel free to improve)<br />
<br />
Use those two command line:<br />
C:\Program Files\Microsoft ActiveSync\Drivers\WceRndis.inf@@C:\Program Files\Microsoft ActiveSync\Drivers<br />
C:\Program Files\Microsoft ActiveSync\Drivers\wceusbsh.inf@@C:\Program Files\Microsoft ActiveSync\Drivers<br />
<br />
HotFix:<br />
The original 4.1 MSI comes with two partially documented (at that time) hotfixs.<br />
<br />
First of all scan the registry for the following values:<br />
System search:<br />
<br />
Hklm\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\KB894476 returns in the "HFOK1" variable<br />
Hklm\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\KB909394 returns in the "HFOK2" variable<br />
<br />
Create both variables (HFOK1 and HFOK2) and initialize to "NO"<br />
<br />
Create one custom action, "exe in binary table", use WMP10_Update.exe that you can extract from the original MSI. System context, Synchronous ignore exit code, after file and registry installation in the sequence.<br />
Condition (NOT Installed) AND ( HFOK1 = "NO")<br />
Command line: /quiet /norestart<br />
<br />
Create one custom action, exe in binary table, Rndis_Update.exe that you can extract from the original MSI. System context, Synchronous, ignore exit code, after file and registry installation in the sequence.<br />
Condition (NOT Installed) AND ( HFOK2 = "NO")<br />
Command line: /quiet /norestart<br />
<br />
DLL based custom action:<br />
Create one custom action based on newbinary19 from the original MSI.<br />
Once you have exported newbinary19, create a "custom action dll (windows installer method)" stored in the binary table, the calling function is FReserveAirSyncURLNamespace. System context, Synchronous, ignore exit code, after file and registry installation in the sequence.<br />
<br />
This function writes the registry here:<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\HTTP\Parameters\UrlAclInfo]<br />
"http://*:2869" etcÂ¡K<br />
"http://*:26675/Microsoft-Server-ActiveSync" etcÂ¡K<br />
<br />
It does something (I still do not know what, I am searching, I will keep you informed) with the HTTP service. The result is that, if you donÂ¡Â¦t launch that function the new Pocket PC do not seem to work (I Used a Dell AXIM x51 for those test).  I think this is the new way pocket PC with  OS version 2005 sync, but I have to test more devices to certify it. The Axim registers itself as a network interface (yes) and not as "a windows mobile device". Once connected it gets an IP from the TCP:169.254.2.0/255.255.255.0 range. <br />
<br />
You can use dependencies walker from Visual studio to browse the integrated functions in the dll.<br />
<br />
Firewall :<br />
Yep, ThatÂ¡Â¦s something I particularly disliked from the original MSI. It just opens your local firewall. On the internal network, OK why not- On the external network, are you kidding, do not touch my corporate settings if I do not tell you so. <br />
<br />
It changes: <br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile]<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile] <br />
<br />
For the Axim to work, you have got to open up those ports (take a look at your initial scan for more precisions). It is all about the TCP:169.254.2.0/255.255.255.0 range and wcescomm.exe.<br />
<br />
If you do not open the ports, the Pocket PC does not get an IP and etc.<br />
<br />
We made that our way, directly from the GPO firewall settings, so we keep a global control on those settings and if there a security issue, we can close access to the network to those device.<br />
<br />
Uninstall:<br />
For the uninstall, IÂ¡Â¦ve implemented a kill program, to stop the different background programs.<br />
In admin deferred - synchronous ignore exit code - before file uninstall in the sequence.<br />
Condition: REMOVE~="ALL"<br />
You can use kill.exe from the resource kit, or compile your own based on the api (example available at http://vbnet.mvps.org/)<br />
Tasks to kill:<br />
wcesmgr.exe<br />
wcescomm.exe<br />
rapimgr.exe<br />
<br />
There is also the FUnreserveAirSyncURLNamespace in the newbinary19.dll  that you can launch to undo the FReserveAirSyncURLNamespace function. Both custom action are the same, except the function name. I launch that one before uninstalling the files too.<br />
<br />
Background:<br />
I couldn't manage to deploy this program in the user context using the standard "setup.exe /a" and integrate the MSI in the GPO. If I do so, the client computer ask for admin rights. So I resigned to repackage this piece of MSI provided by Microsoft. Provided the huge number of custom action set in user context, I doubt the original MSI could be used as it is.<br />
<br />
<br />
Other stuff:<br />
I suppressed all selfreg, it avoids the missing mail client message, and doesn't seem to affect the package.<br />
<br />
In older version (3.7) that registry key was omitted from capture. It's the key to the browse device feature in User context:<br />
<br />
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved\{49BF5420-FA7F-11cf-8011-00A0C90A8F78}<br />
<br />
I also launch the WCESMgr.exe if an outlook profile is found, but that's home cooking, do it your way.<br />
<br />
It doesn't handle repair (REINSTALL) because I want more user feedback before improving the MSI. It doesn't handle windows 2000.  But feel free to improve it and post your comments here.<br />
<br />
This package has been tested with a Dell Axim X51 (2005) and a Ipaq 6515 (2003SP2). As soon as my users will increase my database I'll improve the package and my compatibility list. <br />
<br />
Installations are possible in assigned and published to the user configuration. I WOULDN'T set it as a system configuration package in the GPO, definitively.
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/ardevaz" class="username" rel="nofollow">ardevaz</a>
                </li>
                <li>
                    01/26/2006 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_448" name="tip_448">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-448"></div> -->
   <div id="tip-448" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">116</div>
   <div id="tip-448" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-448"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            I have found that you get a message (Previous version already installed) when trying to upgrade from 4.1.4841.0. In order to get around this I have created a transform and done the following:<br />
<br />
Created a Set Proprty Custom Action<br />
Custom Action Name: Reinstall_Fix<br />
Proptery Name:REINSTALL<br />
Property vale: {}<br />
Install UI Sequence: After setAllUsersProfile2K<br />
Install Exec Sequence: After IsolateComponents<br />
<br />
Once saved, run the msi from the comd prompt as follows:<br />
msiexec /i "Microsoft ActiveSync 4.0.msi" TRANSFORMS=activesync.mst REINSTALLMODE=voums REINSTALL=All REBOOT=ReallySupress /qn<br />
<br />
I have tested this and it has silently updated MS ActiveSync 4.1 (4.1.4841) & 3.7.1 (3.7.1.3244).<br />
<br />
Note: To get the ActiveSync msi, download ActiveSync from Microsoft and run "setup.exe /a" to install to an Admin share
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/gtuser" class="username" rel="nofollow">gtuser</a>
                </li>
                <li>
                    09/28/2006 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_5602" name="tip_5602">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-5602"></div> -->
   <div id="tip-5602" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">116</div>
   <div id="tip-5602" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-5602"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            Deploying ActiveSync 4.1 in USER (restricted, locked down) context from the GPO for WindowsXP pro based client.<br />
<br />
I used Wise for Windows installer (3.5) and made a full capture of C:\. <br />
<br />
I assume you are familiar with the capture process and do not need explanations about registry and files entries capture. At the end of this documents there are background notes and comments.<br />
<br />
Installing the drivers:<br />
I use the SetupCopyOEMInf API trough a visual basic 6.0 program. You can call that API directly from the wise project, but that is the way I have always been doing and I have my little habits. <br />
<br />
----VB6 Code----<br />
Private Declare Function SetupCopyOEMInf Lib "setupapi.dll" Alias "SetupCopyOEMInfA" _<br />
  (ByVal SourceInfFileName As String, ByVal OEMSourceMediaLocation As String, _<br />
  ByVal OEMSourceMediaType As Long, ByVal CopyStyle As Long, ByVal DestinationInfFileName As String, _<br />
  ByVal DestinationInfFileNameSize As Long, ByRef RequiredSize As Long, _<br />
  ByVal DestinationInfFileNameComponent As String) _<br />
  As Long<br />
<br />
<br />
Private Sub Form_Load()<br />
On Error Resume Next<br />
Dim param() As String<br />
Dim ret2 As String * 255<br />
Dim ret3 As String * 255<br />
Dim ret As Long<br />
<br />
If Command = "" Then End<br />
<br />
param = Split(Command, "@@")<br />
<br />
<br />
ret = SetupCopyOEMInf(param(0), param(1), 1, &H4, ret2, 255, 255, ret3)<br />
<br />
        If ret = 0 And UBound(param) = 2 Then<br />
        MsgBox "retour:" & ret & vbCrLf & _<br />
              "erreur:" & Err.LastDllError & vbCrLf & _<br />
              "nom fichier:" & Trim(ret2), vbCritical, "error"<br />
        End If<br />
End<br />
End Sub<br />
----end of Code----<br />
<br />
Param 0 to 2 are the following: (command line of the custom action)<br />
Param(0) = C:\Program Files\Microsoft ActiveSync\Drivers\wceusbsh.inf<br />
Param(1) = C:\Program Files\Microsoft ActiveSync\Drivers<br />
<br />
Param(2) is for debug, if you wish.<br />
<br />
Separator is "@@" - Environment variable are preferable to "C:\"<br />
<br />
This piece of code sets the inf file in the C:\winnt\inf\oemX.inf and registers the security catalogue in the catroot directory. Please keep in mind that with the (windowsXP) windows file protection you cannot change directly a registered inf in the inf directory without using the API.<br />
<br />
So create two custom action "Exe from binary table", Deffered system context - synchronous ignore exit code - after file and registry installation in the (install) sequence. <br />
<br />
Launch conditions are "NOT Installed" (but feel free to improve)<br />
<br />
Use those two command line:<br />
C:\Program Files\Microsoft ActiveSync\Drivers\WceRndis.inf@@C:\Program Files\Microsoft ActiveSync\Drivers<br />
C:\Program Files\Microsoft ActiveSync\Drivers\wceusbsh.inf@@C:\Program Files\Microsoft ActiveSync\Drivers<br />
<br />
HotFix:<br />
The original 4.1 MSI comes with two partially documented (at that time) hotfixs.<br />
<br />
First of all scan the registry for the following values:<br />
System search:<br />
<br />
Hklm\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\KB894476 returns in the "HFOK1" variable<br />
Hklm\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\KB909394 returns in the "HFOK2" variable<br />
<br />
Create both variables (HFOK1 and HFOK2) and initialize to "NO"<br />
<br />
Create one custom action, "exe in binary table", use WMP10_Update.exe that you can extract from the original MSI. System context, Synchronous ignore exit code, after file and registry installation in the sequence.<br />
Condition (NOT Installed) AND ( HFOK1 = "NO")<br />
Command line: /quiet /norestart<br />
<br />
Create one custom action, exe in binary table, Rndis_Update.exe that you can extract from the original MSI. System context, Synchronous, ignore exit code, after file and registry installation in the sequence.<br />
Condition (NOT Installed) AND ( HFOK2 = "NO")<br />
Command line: /quiet /norestart<br />
<br />
DLL based custom action:<br />
Create one custom action based on newbinary19 from the original MSI.<br />
Once you have exported newbinary19, create a "custom action dll (windows installer method)" stored in the binary table, the calling function is FReserveAirSyncURLNamespace. System context, Synchronous, ignore exit code, after file and registry installation in the sequence.<br />
<br />
This function writes the registry here:<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\HTTP\Parameters\UrlAclInfo]<br />
"http://*:2869" etc¡K<br />
"http://*:26675/Microsoft-Server-ActiveSync" etc¡K<br />
<br />
It does something (I still do not know what, I am searching, I will keep you informed) with the HTTP service. The result is that, if you don¡¦t launch that function the new Pocket PC do not seem to work (I Used a Dell AXIM x51 for those test).  I think this is the new way pocket PC with  OS version 2005 sync, but I have to test more devices to certify it. The Axim registers itself as a network interface (yes) and not as "a windows mobile device". Once connected it gets an IP from the TCP:169.254.2.0/255.255.255.0 range. <br />
<br />
You can use dependencies walker from Visual studio to browse the integrated functions in the dll.<br />
<br />
Firewall :<br />
Yep, That¡¦s something I particularly disliked from the original MSI. It just opens your local firewall. On the internal network, OK why not- On the external network, are you kidding, do not touch my corporate settings if I do not tell you so. <br />
<br />
It changes: <br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile]<br />
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile] <br />
<br />
For the Axim to work, you have got to open up those ports (take a look at your initial scan for more precisions). It is all about the TCP:169.254.2.0/255.255.255.0 range and wcescomm.exe.<br />
<br />
If you do not open the ports, the Pocket PC does not get an IP and etc.<br />
<br />
We made that our way, directly from the GPO firewall settings, so we keep a global control on those settings and if there a security issue, we can close access to the network to those device.<br />
<br />
Uninstall:<br />
For the uninstall, I¡¦ve implemented a kill program, to stop the different background programs.<br />
In admin deferred - synchronous ignore exit code - before file uninstall in the sequence.<br />
Condition: REMOVE~="ALL"<br />
You can use kill.exe from the resource kit, or compile your own based on the api (example available at http://vbnet.mvps.org/)<br />
Tasks to kill:<br />
wcesmgr.exe<br />
wcescomm.exe<br />
rapimgr.exe<br />
<br />
There is also the FUnreserveAirSyncURLNamespace in the newbinary19.dll  that you can launch to undo the FReserveAirSyncURLNamespace function. Both custom action are the same, except the function name. I launch that one before uninstalling the files too.<br />
<br />
Background:<br />
I couldn't manage to deploy this program in the user context using the standard "setup.exe /a" and integrate the MSI in the GPO. If I do so, the client computer ask for admin rights. So I resigned to repackage this piece of MSI provided by Microsoft. Provided the huge number of custom action set in user context, I doubt the original MSI could be used as it is.<br />
<br />
<br />
Other stuff:<br />
I suppressed all selfreg, it avoids the missing mail client message, and doesn't seem to affect the package.<br />
<br />
In older version (3.7) that registry key was omitted from capture. It's the key to the browse device feature in User context:<br />
<br />
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved\{49BF5420-FA7F-11cf-8011-00A0C90A8F78}<br />
<br />
I also launch the WCESMgr.exe if an outlook profile is found, but that's home cooking, do it your way.<br />
<br />
It doesn't handle repair (REINSTALL) because I want more user feedback before improving the MSI. It doesn't handle windows 2000.  But feel free to improve it and post your comments here.<br />
<br />
This package has been tested with a Dell Axim X51 (2005) and a Ipaq 6515 (2003SP2). As soon as my users will increase my database I'll improve the package and my compatibility list. <br />
<br />
Installations are possible in assigned and published to the user configuration. I WOULDN'T set it as a system configuration package in the GPO, definitively.
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/ardevaz" class="username" rel="nofollow">ardevaz</a>
                </li>
                <li>
                    01/26/2006 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

    <div>
        
    
        <div class="tip" id="tip_449" name="tip_449">

            <div class="md-1">
                <div class="software-rating-container">
                

    
<div id="incremental-rating" class="incrementalRating">
<!--   <div class="arrow_up" id="tip-449"></div> -->
   <div id="tip-449" class="thumbs_up"><button class="btn btn-xs btn-link "><div class="comment-vote-up"><img src="/build/static/rating/UpArrow.svg"/></div></button></div>
    <div class="avg-rating">4</div>
   <div id="tip-449" class="thumbs_down"><button class="btn btn-xs btn-link "><div class="comment-vote-down"><img src="/build/static/rating/DownArrow.svg"/></div></button></div>
   <!--<div class="arrow_down" id="tip-449"></div> -->
</div>
                </div>
            </div>

            
<div class="md-11">
    <div class="the-tip">

                
        <div class="tip-type-heading">Note</div>

            <span id="tip-text">
            <p>ActiveSync now ships as MSI-package (v.4.5+)</p>
            </span>
            <div class="setup-wrap">

                <div class="setup-header">Setup Information:</div>

                <div>Setup Type: <span>unspecified</span></div>
                <div>Deployment Method Used: <span>unspecified</span></div>
                <div>
                    Deployment Difficulty: <span>
                                            unspecified
                                        </span>
                </div>
                <div>Platform(s): <span>Windows </span></div>
            </div>
            <!--end setup-->


        <div class="byline">
            <ul>
                <li>
                    <a href="/user/masken" class="username" rel="nofollow">masken</a>
                </li>
                <li>
                    03/02/2007 &nbsp;
                </li>
                                <li>
                    <span class="commentslabel collapsed-comments">Show Comments </span> &nbsp; ( 0 )
                </li>
                <li>
                                    </li>
                <li>
                                    </li>
            </ul>
            <br class="clear"/>
        </div>

</div>
</div>

            <div class="deployment-tips-comments">

                <ul id="comment-list" class="comments">
    </ul>


                            </div>

        </div>
        </div>

                
            </div>

                    </div>

    </div>
    <!-- end Deployment Tips -->

    <div class="software-section" id="inventory-records">

        <div class="callout-box2">

            <h3><a href="#" class="plus toggle"></a> Inventory Records (9)</h3>
            <p>View inventory records anonymously contributed by opt-in users of the
                <a href="http://software.dell.com/products/kace-k1000-systems-management-appliance">
                K1000 Systems Management Appliance</a>.
            </p>

        </div>

        <div class="inner-content">

            <div class="inner">

                <div id="software-view-version-revision-list">
                    <div class="title">Versions</div>
                    <ul class="no-bullet nav nav-pills">
                                                    <li class="active">
                                <a href="/software/version/revision/4652/9264">
                                    4.2.4855.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9265">
                                    4.0.4358.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9266">
                                    4.5.5059.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9267">
                                    4.2.4876.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9268">
                                    4.2.4875.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9269">
                                    4.1.4807.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9270">
                                    4.1.4841.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9271">
                                    4.5.5096.0
                                </a>
                            </li>
                                                    <li >
                                <a href="/software/version/revision/4652/9272">
                                    4.0.4343.0
                                </a>
                            </li>
                                            </ul>
                </div>
                <div id="software-view-version-revision-details">
                                            <h2>ActiveSync</h2>
            <div><h3>Version</h3><span>4.2.4855.0</span></div>
                                                        <div><h3>Uninstall String</h3>MsiExec.exe /I{B208806F-A231-4FA0-AB3F-5C1B8979223E}</div>                                            
                                    </div>
                <br class="clear"/>
            </div>

        </div>

    </div>
    <!-- end inventory records section -->

    <div class="software-section" id="q-a">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Questions & Answers (3)
                            </h3>
            <p>Questions & Answers related to Microsoft ActiveSync</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">

    <div class="content-left">
        <div class="vote-wrap">

            <div class="vote-num">
                0
            </div>

            <div class="vote-label">
                <!--insert conditional based on answered or not-->
                ANSWERS
            </div>

        </div>
    </div>


    <div class="content-meta">

        <a href="/question/meraki-mdm-and-activesync" class="title">
            Meraki MDM and Activesync
        </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="33803"
     data-enabled="false"
     data-entity-name="question"
     data-rating=0
     data-expanded="false"
     data-entityType="question"
     >
</div></li>

            </div>

            <div class="byline">
                By:
                <a href="/user/danw8" rel="nofollow">danw8</a>
                9 years ago 3.4k views
            </div>
            <div id="question-latest-activity" class="latestActivity">
        </div>

        </div>

    </div>

</div>
<!--end question -->                                    <div class="content-wrap">

    <div class="content-left">
        <div class="vote-wrap">

            <div class="vote-num">
                1
            </div>

            <div class="vote-label">
                <!--insert conditional based on answered or not-->
                ANSWERS
            </div>

        </div>
    </div>


    <div class="content-meta">

        <a href="/question/how-can-i-lock-down-access-to-exchange-mailboxes-to-force-users-to-go-through-the-k3000-appliance-only" class="title">
            How can I lock down access to Exchange mailboxes to force users to go through the K3000 appliance only?
        </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="27704"
     data-enabled="false"
     data-entity-name="question"
     data-rating=0
     data-expanded="false"
     data-entityType="question"
     >
</div></li>

            </div>

            <div class="byline">
                By:
                <a href="/user/mantexau" rel="nofollow">mantexau</a>
                10 years ago 5.5k views
            </div>
            <div id="question-latest-activity" class="latestActivity">
        </div>

        </div>

    </div>

</div>
<!--end question -->                                    <div class="content-wrap">

    <div class="content-left">
        <div class="vote-wrap answered">

            <div class="vote-num">
                2
            </div>

            <div class="vote-label">
                <!--insert conditional based on answered or not-->
                ANSWERED
            </div>

        </div>
    </div>


    <div class="content-meta">

        <a href="/question/k3000-acitvesync-profile" class="title">
            K3000 ActiveSync profile
        </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="24987"
     data-enabled="false"
     data-entity-name="question"
     data-rating=2
     data-expanded="false"
     data-entityType="question"
     >
</div></li>

            </div>

            <div class="byline">
                By:
                <a href="/user/mzdesktop" rel="nofollow">mzdesktop</a>
                11 years ago 3.4k views
            </div>
            <div id="question-latest-activity" class="latestActivity">
        </div>

        </div>

    </div>

</div>
<!--end question -->                
                            </div>

        </div>
    </div>
    <!-- end Q & A section -->

    <div class="software-section" id="blogs">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Blogs (0)
                            </h3>
            <p>Blog posts related to Microsoft ActiveSync</p>

        </div>
        <div class="inner-content">

            <div class="inner">

                
                            </div>

        </div>
    </div>
    <!-- end blog section -->

    <div class="software-section" id="links">

        <div class="callout-box2">

            <h3>
                <a href="#" class="plus toggle"></a> Links (3)
                            </h3>

            <p>Links related to Microsoft ActiveSync</p>

        </div>

        <div class="inner-content">

            <div class="inner">

                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/microsoft-activesync-4-1-hell" class="title">
                MICROSOFT ACTIVESYNC 4.1 HELL
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="2912"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/WiseUser" rel="nofollow">WiseUser</a>
                18 years ago 2.6k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/how-to-use-silent-mode-setup-to-deploy-activesync-3-7" class="title">
                How to use Silent Mode Setup to deploy ActiveSync 3.7
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="1968"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/JoshJThomas" rel="nofollow">JoshJThomas</a>
                21 years ago 2.3k views
            </div>

        </div>

    </div>

</div>                                    <div class="content-wrap">
    <div class="content-left">
        <div class="content-icon link-icon" title="Link">link</div>
    </div>
    <div class="content-meta">

            <a href="/link/here-at-myitforum-com" class="title">
                here at MyItForum.com
            </a>

        <div class="content-lower">

            <div class="content-rating">
                <div name="itninja-star-rating"
     data-entity-id="1923"
     data-enabled="false"
     data-entity-name="link"
     data-rating=0
     data-expanded="false"
     data-entityType="link"
     >
</div></li>
            </div>
            <div class="byline">
                By:
                <a href="/user/bkelly" rel="nofollow">bkelly</a>
                21 years ago 2.2k views
            </div>

        </div>

    </div>

</div>                
                            </div>

        </div>
    </div>
    <!-- end links section -->

    <!-- reviews -->
        <div class="software-section" id="reviews">

           <div class="callout-box2">

               <h3>
                   <a href="#" class="plus toggle"></a> Reviews (0)
                                  </h3>

               <p>Reviews related to Microsoft ActiveSync</p>

           </div>

           <div class="inner-content">

               <div class="inner">


                   
               </div>

           </div>

       </div>


</div>
    <div class="clearfix">&nbsp;</div>
</div>
<div class="ccpa-notification">
    <div class="ccpa-notification-text">
        <div><button class="btn-itn" id="ccpa-accept">ACCEPT</button></div>

        This website uses cookies.
        By continuing to use this site and/or clicking the "Accept" button you are providing consent


        Quest Software and its affiliates do NOT sell the Personal Data you provide to us either when you register on our
        websites or when you do business with us. For more information about our
        <a href="https://www.quest.com/legal/privacy.aspx" target="_blank" rel="noopener noreferrer">Privacy Policy</a> and our data protection
        efforts, please visit
        <a href="https://www.quest.com/legal/gdpr-hq.aspx" target="_blank" rel="noopener noreferrer">GDPR-HQ</a>
        </div>
    </div>
</div>


<footer>
    <div class="container">
                <div id="footer-nav" class="row">
            <div class="md-3">
                <strong>Home Pages</strong>
                <ul>
                    <li><a href="/software-library">Software</a></li>
                    <li><a href="/question">Questions</a></li>
                    <li><a href="/blog">Blog Posts</a></li>
                    <li><a href="/link">Shared Links</a></li>
                </ul>
            </div>
            <div class="md-3">
                <strong>FAQ &amp; Support</strong>
                <ul>
                    <li><a href="/faq">Site FAQ</a></li>
                    <li><a href="https://www.quest.com/community/quest/unified-endpoint-management" target="_blank" rel="noopener noreferrer">Unified Endpoint Management</a></li>
                </ul>
            </div>
            <div class="md-3">
                <strong>About</strong>
                <ul>
                    <li><a href="/about">ITNinja</a></li>
                    <li><a href="/about">Welcome Video</a></li>
                    <li><a href="/tour">Tour</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/sitemap">Sitemap</a></li>
                </ul>
            </div>
            <div class="md-3">
                <strong>Share/Contribute</strong>
                <ul>
                    <li class="pull-left"><a href="http://www.facebook.com/pages/ITNinja/128951133849867"><img src="/build/static/layout/facebook.png" alt="Facebook"></a></li>
                    <li class="pull-left">&nbsp;&nbsp;</li>
                    <li class="pull-left"><a href="http://twitter.com/ITNinjaSite"><img src="/build/static/layout/twitter.png" alt="Twitter"></a></li>
                </ul>
            </div>
        </div>

        <div id="footer-links">
            &copy; 2024 Quest Software Inc. All rights reserved.  &nbsp; <a href="/legal">Legal</a> &nbsp; | &nbsp; <a href="https://kace.uservoice.com/forums/139919-itninja">Feedback</a>
            <a href="https://www.quest.com/kace/" class="footer-logo-kace"><img src="/build/static/layout/KACE_White-grey.png" alt="KACE" /></a>
            <a href="https://www.quest.com/" class="footer-logo"><img src="/build/static/layout/dsg.png" alt="Quest" /></a>
        </div>

        <div id="version">unknown</div>

    </div>

</footer>

<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=es6"></script>

<script src="/build/index.5c9f75e6.js"></script>


    <script src="/build/software.afa0d704.js"></script>

    <script>
        Itninja.Helpful('div.helpful button');
        Itninja.HideContent('a.review-delete-admin','div.version-review');

        $(document).ready( function() {
            tagging.init($('#form_tags'), {'suggest':false});

            // only way to do this
                             var id = '#platform-new #form_platforms_' + 1;
                $(id).click(function() {
                    showNotificationBar('This platform is associated to one or more tips. Please modify the tip prior to removing this platform',1200);
                    // reclick it
                    $(this).attr("checked", true);
                });
            

            $("input#difficulty[data-slider]").bind("slider:changed", function (event, data) {

                difficultyValue = data.value.toFixed(0);

                // set difficulty dropdown to value from slider
                $("select#difficultyRating").val(difficultyValue);

                // get difficulty phrase
                var phrase = $('select#difficultyRating option:selected').html();

                if (phrase) {
                    // set slider phrase span
                    $('#slider-value').html("Difficulty: <span class='diff_" + difficultyValue + "'>" + phrase + "</span>");
                }

                if ( data.value == 0){
                     $('.slider-back').addClass('slider-disabled');
                     $('#slider-value span').removeClass('diff_1');
                 } else {
                    $('.slider-back').removeClass('slider-disabled');
                 }

            })
        });
    </script>


</body>
</html>
